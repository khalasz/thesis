%   DOCUMENT CLASS  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%   Use the `sfuthesis` class to format your thesis. 
%
%   For more information about thesis formatting requirements, go to http://www.lib.sfu.ca/help/publish/thesis or ask a thesis advisor at the SFU Research Commons. 

\documentclass{../sfuthesis-2.3.2/sfuthesis}



%   DOCUMENT METADATA  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%   Fill in the following information for the title page and declaration of committee page. Please review the Declaration of Committee page instructions on the library's thesis website before completing this page: https://www.lib.sfu.ca/help/publish/thesis/format/declaration-committee 

% Choose the \faculty entry below from the following list: 
% Faculty of Applied Sciences
% Faculty of Arts and Social Sciences
% Beedie School of Business
% Faculty of Communication, Art and Technology
% Faculty of Education
% Faculty of Environment
% Faculty of Health Sciences
% Faculty of Science

\title{Among graphs, groups, and latin squares}
\thesistype{Thesis}
\author{Kevin C. Halasz}
\previousdegrees{%
	M.Sc., Simon Fraser University, 2017\\
	B.Sc., University of Puget Sound, 2014}
\degree{Doctor of Philosophy}
\department{Department of Mathematics}
\faculty{Faculty of Science}
\copyrightyear{2021}
\semester{Summer 2021}
\date{August 18, 2021}

%You may include up to six keywords or phrases. Keywords should be separated with semicolons. No punctuation at the end.

\keywords{latin square (05B15); group-labelled graphs (05C25); Hamilton cycles (05C45); $k$-plex; partial transversal; harmonious group}

\committee{%
	\chair{Veselin Jungic}{Teaching Professor, Mathematics}
	\member{Luis Goddyn}{Supervisor\\Professor, Mathematics}
	\member{Matt DeVos}{Committee Member\\Associate Professor, Mathematics}
	\member{Amarpreet Rattan}{Examiner\\Associate Professor, Mathematics}
	\member{Ian M. Wanless}{External Examiner\\Professor, Mathematics\\Monash University}
}







%   PACKAGES %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%   Add any packages you need for your thesis here.
%   You don't need to call the following packages, which are already called in
%   the sfuthesis class file:
%
%   - appendix
%   - etoolbox
%   - fontenc
%   - geometry
%   - lmodern
%   - nowidow
%   - setspace
%   - tocloft
%
%   If you call one of the above packages (or one of their dependencies) with
%   options, you may get a "Option clash" LaTeX error. If you get this error,
%   you can fix it by removing your copy of \usepackage and passing the options
%   you need by adding
%
%       \PassOptionsToPackage{<options>}{<package>}
%
%   before \documentclass{sfuthesis}.
%
%   The following packages are a few suggestions you might find useful.
%
%   (1) amsmath and amssymb are essential if you have math in your thesis;
%       they provide useful commands like ``blackboard bold'' symbols and
%       environments for aligning equations.
%   (2) amsthm includes allows you to easily change the style and numbering of
%       theorems. It also provides an environment for proofs.
%   (3) graphicx allows you to add images with \includegraphics{filename}.
%   (4) hyperref turns your citations and cross-references into clickable
%       links, and adds metadata to the compiled PDF.
%   (5) pdfpages lets you import pages of external PDFs using the command
%       \includepdf{filename}. You will need to do this if your research
%       requires an Ethics Statement.
%

\usepackage{amsmath}                            % (1)
\usepackage{amsthm,amssymb}                            % (2)
\usepackage{graphicx}                           % (3)
\usepackage[pdfborder={0 0 0}]{hyperref}        % (4)
% \usepackage{pdfpages}                         % (5)
\usepackage{cases}   % (6)
\usepackage{multirow}% (7)
\usepackage{adjustbox}% (8)
\usepackage{xcolor}% (9)
\usepackage{tikz}%(10)
\usetikzlibrary{calc}
%\usepackage[utf8]{inputenc}%(11)
\usepackage[nonumberlist,acronym,nopostdot,nogroupskip]{glossaries}%(12)
\usepackage{hyperref}%(13)
\usepackage{caption}
\usepackage[labelformat=parens]{subcaption}%(14)
\usepackage{listings}
\usepackage{glossary-longragged}
\usepackage{csquotes}


% ...
% ... add your own packages here!




%   OTHER CUSTOMIZATIONS %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%   Add any packages you need for your thesis here. We've started you off with
%   a few suggestions.
%
%   (1) Use a single word space between sentences. If you disable this, you
%       will have to manually control spacing around abbreviations.
%   (2) Correct the capitalization of "Chapter" and "Section" if you use the
%       \autoref macro from the `hyperref` package.
%   (3) The LaTeX thesis template defaults to one-and-a-half line spacing. If
%       your supervisor prefers double-spacing, you can redefine the
%       \defaultspacing command.
%

\frenchspacing                                    % (1)
\renewcommand*{\chapterautorefname}{Chapter}      % (2)
\renewcommand*{\sectionautorefname}{Section}      % (2)
\renewcommand*{\subsectionautorefname}{Section}   % (2)
% \renewcommand{\defaultspacing}{\doublespacing}  % (3)
% ...
% ...
% ...
% ... add your own customizations here!
\newcommand{\modulo}[1]{\text{ (mod } #1\text{)}}
\newcommand{\defn}[1]{\emph{#1}}
\newcommand{\fil}[1]{\textcolor{white}{l}#1\textcolor{white}{l}}
\newcommand{\E}{\mathbb{E}}
\DeclareMathOperator{\Kn}{Kn}
\DeclareMathOperator{\Dic}{Dic}
\DeclareMathOperator{\sign}{sign}
\DeclareMathOperator{\Bin}{Bin}
\DeclareMathOperator{\dist}{dist}
\DeclareMathOperator{\Syl}{Syl}
\newcommand{\bx}{{\bf x}}
\newcommand{\by}{{\bf y}}
\newcommand{\dbx}{\text{d}{\bf x}}
\newcommand{\dby}{\text{d}{\bf y}}
\newcommand{\dirK}{\overleftrightarrow{\,K\,\,}}



\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem*{remark}{Remark}
\newtheorem*{observation}{Observation}
\newtheorem{question}[theorem]{Question}
\newtheorem*{claim}{Claim}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
%\newglossarystyle{mystyle}{%
%  \glossarystyle{list}%
%  \renewcommand*{\glossaryentryfield}[5]{%
%    \item[\glsentryitem{##1}\glstarget{##1}{##2}]%
%       \hspace{1cm}##3\glspostdescription\space ##5}%
%}


\makeglossaries
%
\newacronym[sort=mn]{Mn}{$M_n$}{The \gls{Mobius ladder} on 2n vertices}
%
%\newacronym[sort=knnk]{Knnk}{$\Kn(n,k)$}{The Kneser graph whose vertices are $k$-subsets of $[n]$}
%
%\newacronym[sort=rx]{Rx}{$R(X)$}{For a set of cells $X \subseteq L$, the multiset of rows of $L$ covered by $X$ }
%
%\newacronym[sort=rx1]{Rpx}{$R^\prime(X)$}{For a set of cells $X \subseteq L$, the set of rows of $L$ covered by $X$ }
%
%\newacronym[sort=cx]{Cx}{$C(X)$}{For a set of cells $X \subseteq L$, the multiset of columns of $L$ covered by $X$ }
%
%\newacronym[sort=cx1]{Cpx}{$C^\prime(X)$}{For a set of cells $X \subseteq L$, the set of columns of $L$ covered by $X$ }
%
\newacronym[sort=b]{b}{$\langle b \rangle$}{The cyclic subgroup of a group $G$ generated  by the element $b \in G$}
%
\newacronym[sort=d2n]{D2n}{$D_n$}{The dihedral group of order $n$ }
%
\newacronym[sort=distG]{distG}{$\dist_{G}(u,v)$}{The number of edges in the shortest path between $u$ and $v$ in $G$}
%
\newacronym[sort=SL]{SL}{$S(L)$}{The set of symbols appearing in the array (latin square) $L$ }
%
%
\newacronym[sort=RL]{RL}{$R(L)$}{The set of rows in the array (latin square) $L$ }
%
%
\newacronym[sort=CL]{CL}{$C(L)$}{The set of columns in the array (latin square) $L$ }
%
%
\newacronym[sort=gR]{gR}{$[g]_R$}{The vertex of $K_{n,n}(G)$ corresponding to the row of $L_G$ with index $g$}
%
%
\newacronym[sort=gC]{gC}{$[g]_C$}{The vertex of $K_{n,n}(G)$ corresponding to the column of $L_G$ with index $g$}
%
%\newacronym[sort=sx1]{Spx}{$S^\prime(X)$}{For a set of cells $X \subseteq L$, the set of symbols contained in $X$ }
%
\newacronym[sort=pl]{Pl}{$P_\ell$}{The path graph on $\ell$ vertices}
%
\newacronym[sort=LG]{LG}{$L_G$}{The latin square given by the multiplication table of the group $G$}
%
\newacronym[sort=gl]{GL}{$\Gamma(L)$}{The latin square graph of the latin square $L$ }
%
\newacronym[sort=syl]{syl2}{$\Syl_2(G)$}{For a group $G$, the isomorphism class of its \gls{Sylow 2-subgroup}s }
%
\newacronym[sort=n]{nto}{$[n]$}{The set of integers $\{1,2,\ldots,n\}$ }
%
\newacronym[sort=ab]{atob}{$[a,b]$}{For integers $a<b$, the set of integers $\{a,a+1,\ldots,b\}$ }
%
%\newacronym[sort=o1]{bigo}{$O(f)$}{Given a function $f$, the set of functions $g$ for which $\limsup_{n\rightarrow \infty} \frac{g(n)}{f(n)} < \infty$ }
%
%\newacronym[sort=o2]{lilo}{$o(f)$}{Given a function $f$, the set of functions $g$ for which $\lim_{n\rightarrow \infty} \frac{g(n)}{f(n)} = 0$ }
%
\newacronym[sort=1pme]{1pme}{$(1 \pm \varepsilon)n$ }{For $n \in \mathbb{N}$ and $\varepsilon>0$, the interval $\left((1-\varepsilon)n,(1+\varepsilon)n\right)$}
%
%
%\newacronym[sort=kn]{Kn}{$\overrightarrow{K}_n$}{The directed graph with vertex set $[n]$ and arcs $ij$ for all $i,j \in [n]$ such that $i \neq j$}
%
%
\newacronym[sort=guh]{GUH}{$G \cup H$}{For graphs $G$ and $H$, the disjoint union of $G$ and $H$}
%
%
\newacronym[sort=eSAB]{eSAB}{$e_S(A,B)$}{The number of edges with a color in $S$, one end in $A$, and the other end in $B$}
%
\newacronym[sort=l]{orderL}{$|L|$}{The order, or number of rows/columns, in a square array (latin square) $L$}
%
\newacronym[sort=knnl]{KnnL}{$K_{n,n}(L)$}{The edge-coloring of $K_{n,n}$ induced by the $n \times n$ array (latin square) $L$}
%
\newacronym[sort=aidk]{seqdown}{$\left(a_i\right)_{i=k}^{\searrow 1}$}{The sequence $a_k,a_{k-1},a_{k-2},\ldots,a_1$}
%
\newacronym[sort=aik]{sequp}{$\left(a_i,b_i\right)_{i=1}^{k}$}{The sequence $a_1,b_1,a_2,b_2,\ldots,a_k,b_k$}

%\newacronym[sort=oakn]{OAkn}{$OA(k,n)$}{An orthogonal array with $k$ rows and $n^2$ columns}
%
%\newacronym[sort=vg]{VG}{$V(\Gamma)$}{The set of vertices in a graph $\Gamma$}
%
\newacronym[sort=cL]{chiL}{$\chi_L$}{The edge-coloring of $K_{n,n}$ corresponding to the order-$n$ latin square $L$}
%
%
\newacronym[sort=deltaG]{deltaG}{$\delta(G)$}{ The minimum degree of the graph $G$}
%
\newacronym[sort=Ofn]{bigO}{$O(f(n))$}{The class of functions $g$ such that $\limsup_{n\rightarrow \infty} g(n)/f(n) < \infty$}
%
\newacronym[sort=Ofn]{littleo}{$o(f(n))$}{The class of functions $g$ such that $\lim_{n\rightarrow \infty} f(n)/g(n) = \infty$}
%\newacronym[sort=q]{floor}{$\lfloor q \rfloor$}{ The ``floor'' of (i.e.\! largest integer less than or equal to) $q \in \mathbb{R}$}
%


\newglossaryentry{multigraph}
{
    name=multigraph,
    description={A loopless graph in which there may be multiple edges corresponding to the same pair of vertices.}
}

\newglossaryentry{balanced bipartite}
{
    name=balanced bipartite,
    description={A balanced bipartite graph is a bipartite graph with \gls{bipartition} $(R,C)$ satisfying $|R|=|C|$.}
}

\newglossaryentry{$k$-bounded $n$-square}
{
sort=k-bounded n-square,
name=$k$-bounded $n$-square,
description={An $n \times n$ array in which no symbol appears more than $k$ times.}
}

\newglossaryentry{square latin array}
{
name=square latin array,
description={An $n \times n$ array containing symbols from set of size $m \geq n$ such that no symbol appears more than once in any row or column.}
}

\newglossaryentry{cayley table}
{
name=cayley table,
description={Of a group $G$, another name for the group-based latin square $L_G$.}
}


\newglossaryentry{row-latin array}
{
name=row-latin array,
description={A rectangular array in which no symbol appears more than once in any row}
}

\newglossaryentry{2-group}
{
 name=2-group,
 description={A group in which the order of every element is a power of 2.}
}

\newglossaryentry{rainbow}
{
 name=rainbow,
 description={An edge-colored graph with exactly one edge of each color.}
}

\newglossaryentry{equipartition}
{
    name=equipartition,
    description={Of a set $S$, a collection of disjoint subsets $\{S_i\}_{i=1}^k$ such that every element of $S$ appears in exactly one $S_i$ and $\left\vert|S_i|-|S_j|\right\vert \leq 1$ for all $i,j \in [k]$.}
}

\newglossaryentry{equi-$n$ square}
{
    name=equi-$n$ square,
    description={An $n \times n$ array in which each symbol appears exactly $n$ times.}
}

\newglossaryentry{Sylow 2-subgroup}
{
    name=Sylow 2-subgroup,
    description={Of a group $G$, subgroups whose order is the largest power of $2$ dividing $|G|$. They are named after Peter Ludwig Sylow, who showed that such groups exist and that any two Sylow $2$-subgroups of $G$ are isomorphic.}
}

\newglossaryentry{extension}
{
    name=extension,
    description={A group $G$ is an extension of $N$ by $Q$ if $G$ has a normal subgroup $N_0 \triangleleft G$ which is isomorphic to $N$ and the quotient group $G/N_0$ is isomorphic to $Q$.}
}
%
%\newglossaryentry{dihedral group}
%{
%    name=dihedral group,
%    description={Of order $2n$, the group of symmetries of an $n$-gon. It is defined abstractly by the presentation $\langle r,s \,|\, r^n=s^2=1, srs=r^{-1}\rangle$.}
%}
%
%\newglossaryentry{dicyclic group}
%{
%    name=dicyclic group,
%    description={Of order $4n$, the extension with normal subgroup $\mathbb{Z}_{2n}$ and quotient group $\mathbb{Z}_{2}$ given by the presentation $\langle a,x \,|\, a^{2n}=1, a^n=x^2, xax^{-1}=a^{-1}\rangle$.}
%}
%
\newglossaryentry{solvable group}
{
    name=solvable group,
    description={A group for which there exists a subnormal series $G = G_a\triangleright G_{a-1} \triangleright \cdots \triangleright G_1 \triangleright G_0=\{1\}$ such that the quotient groups $G_i/G_{i-1}$ are all abelian.}
}
%
\newglossaryentry{k-plex}
{
sort=k-plex,
    name=$k$-plex,
    description={For a positive integer $k$, a collection of cells in a latin square, or other square array, which intersects each row and column exactly $k$ times and contains at most $k$ copies of each symbol.}
}

\newglossaryentry{partial k-plex}
{
    name=partial $k$-plex,
    description={For a positive integer $k$, a collection of cells in a latin square, or other square array, which intersects each row and column at most $k$ times and contains at most $k$ copies of each symbol.}
}

\newglossaryentry{kl-plex}
{
sort=kl-plex,
    name={$(k,\ell)$-plex},
    description={For positive integers $k$ and $\ell$, a collection of cells in a latin square, or other square array, which intersects each row and column exactly $k$ times and contains at most $\ell$ copies of each symbol.}
}

\newglossaryentry{main diagonal}
{
sort=main diagonal,
    name={main diagonal},
    description={Of a square array, the set of cells whose column index is equal to their row index.}
}

\newglossaryentry{bipartition}
{
name=bipartition,
description={In a bipartite graph $G$, there are disjoint sets $R,C \subseteq V(G)$ such that every edge has one end in $R$ and the other end in $C$. We refer to $(R,C)$ as the (vertex) bipartition of $G$.}
}
%
%%
\newglossaryentry{hypergraph}
{
    name=hypergraph,
    description={A pair $H = (V,E)$ of vertices $V$ and hyperedges $E$, which are subsets of $V$. A hypergraph is \defn{$3$-uniform} if each edge has size 3, it is \defn{tripartite} if the vertex set can be partitioned into three sets such that each edge contains exactly one vertex from each of these sets, and it is \defn{linear} if any pair of vertices is contained in at most one edge. }
}

\newglossaryentry{2-bounded}
{
name={2-bounded},
description={An edge-colored graph containing at most 2 edges of any given color.}
}
%
\newglossaryentry{Hamilton cycle}
{
    name=Hamilton cycle,
    description={A connected 2-regular spanning subgraph.}
}
%
%\newglossaryentry{essentially identical}
%{
%    name=essentially identical latin squares,
%    description={A pair of latin squares which can be obtained from one another by changing the symbols used (but not reordering rows or columns).}
%}
%
%\newglossaryentry{finite projective plane}
%{
%    name=finite projective plane,
%    description={Of \defn{order} $n$, a pair $(P,L)$ containing a set $P$ of $n^2+n+1$  ``points'' and a set $L\subseteq 2^P$ of $n^2+n+1$ ``lines,'' such that every point is incident to $n+1$ lines, every line contains $n+1$ points, any two distinct lines intersect in exactly one point, and any two distinct points are jointly contained in exactly one line.}
%}
%
% \newglossaryentry{latin square}
%{
%    name=latin square,
%    description={Of order $n$, an $n \times n$ array in which each row and each column is a permutation of some set of size $n$.}
%}
%
 \newglossaryentry{transversal}
{
    name=transversal,
    description={In an $m \times n$ array, a collection of  $\min\{m,n\}$ cells that intersects each row and column at most once and contains exactly at most copy of each symbol. }
}
%
\newglossaryentry{Mobius ladder}
{
    name=M\"obius ladder,
    description={The cubic graph formed from a cycle of length $2n$---referred to as the \emph{rim} of $M_n$---by adding $n$ edges, one joining each pair of vertices at distance $n$ in the initial cycle. }
}
%
%\newglossaryentry{semidirect product}
%{
%    name=semidirect product,
%    description={A group $G$ in which every element can be written as the product of an element of a normal subgroup $H \triangleleft G$ and an element of a (not necessarily normal) subgroup $K$ under the condition $K \cap H = \{id_G\}$. We say that $G$ is the \defn{internal} semidirect product in this case. It is also possible to define an external semidirect product, but doing so is beyond the scope of this thesis.}
%}
%
%\newglossaryentry{multiset}
%{
%    name=multiset,
%    description={An unordered collection of objects in which repetition is allowed. The \defn{multiplicity} of an element in a multiset is the number of times it occurs. A multiset is \defn{simple} if every element has multiplicity 1.}
%}
%
% 
\newglossaryentry{main class equivalent}
{
    name=main class equivalent,
    description={Two latin squares $L_1$ and $L_2$ are main class equivalent if their latin square graphs are isomorphic,  i.e. $\Gamma(L_1) \cong \Gamma(L_2)$.}
}
%
\newglossaryentry{isotopy class}
{
    name=isotopy class,
    description={If $L_1$ and $L_2$ are latin squares of order $n$, we say that $L_1$ and $L_2$ are \defn{isotopic} if there is an automorphism of $K_{n,n}$ that maps each color class of $K_{n,n}(L_1)$ to a color class of $K_{n,n}(L_2)$. An isotopy class is a maximal collection of isotopic latin squares.}
}
%
%
% 
%\newglossaryentry{orthogonal latin squares}
%{
%    name=orthogonal latin squares,
%    description={Latin squares $A$ and $B$ of common order such that, when $A$ is superimposed on $B$, each possible ordered pair of symbols occurs exactly once. We refer to $(A,B)$ as an \defn{orthogonal pair}, and say that  $B$ is $A$'s \defn{orthogonal mate.} % If $\mathcal{A} = \{A_0,A_1,\ldots,A_{k-1}\}$ is a collection of Latin squares such that $A_i$ and $A_j$ are orthogonal for every $i,j \in [k]$, we refer to $\mathcal{A}$ as a set of \defn{mutually orthogonal latin squares} or, as is more common in the literature, \defn{MOLS}}
%    }
%}
% 
 \newglossaryentry{partial transversal}
{
    name=partial transversal,
    description={A collection of cells in a latin square, or other rectangular array, that intersects each row and each column at most once and contains at most one copy of each symbol. }
}


%
 \newglossaryentry{near transversal}
{
    name=near transversal,
    description={ A partial transversal of size $n-1$ in an $n \times n$ array.}
}

 \newglossaryentry{harmonious sequence}
{
    name=harmonious sequence,
    description={ A list $g_1,g_2,\ldots,g_n$ of the elements of a group  $G$ for which the consecutive products $g_1g_2,g_2g_3,\ldots,g_{n-1}g_n,g_ng_1$ are all distinct.}
}

 \newglossaryentry{complete mapping}
{
    name=complete mapping,
    description={Of a group $G$, a bijective function $\theta:G \rightarrow G$ such that $g \mapsto g \theta(g)$ is also a bijection. Given $a,b,c \in G$, we say that $\phi:G\setminus\{a\} \rightarrow G \setminus \{b\}$ is a \defn{near complete mapping} if $g \mapsto g\phi(g)$ is a bijection between $G \setminus \{a\}$ and $G \setminus \{c\}$. If $\theta$ is a complete mapping of $G$, then $\{(g,\theta(g),g\theta(g)) \mid g \in G\}$ is a transversal of $L_G$.  Similarly, near complete mappings of $G$ are equivalent to near transversals of $L_G$.}
}
%
% \newglossaryentry{parastrophy}
%{
%    name=parastrophy,
%    description={A map between latin squares which permutes the roles played by rows, columns, and symbols.}
%}
%


%   FRONTMATTER  % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%   Title page, committee page, abstract, dedication, acknowledgements, table of contents, etc.
%
%   If your research requires an Ethics Statement, download one from the SFU library website at https://www.lib.sfu.ca/help/publish/thesis/regulations#ethics-statement, save the relevant pdf to your thesis folder, and then uncomment the appropriate lines below.



\begin{document}

\frontmatter
\maketitle
\makecommittee

%\addtoToC{Ethics Statement}%
%\includepdf[pagecommand={\thispagestyle{plain}}]{ethics_statement_piii.pdf}%
%\clearpage

\begin{abstract}
A latin square of order $n$ is an $n \times n$ array in which each row and each column contains each of the numbers $\{1,2,\ldots,n\}$. A $k$-plex in a latin square is a collection of cells which intersects each row and column $k$ times and contains $k$ copies of each symbol. This thesis studies the existence of $k$-plexes and approximations of $k$-plexes in latin squares, paying particular attention to latin squares which correspond to multiplication tables of groups.

The most commonly studied class of $k$-plex is the $1$-plex, better known as a transversal. Although many latin squares do not have transversals, Brualdi conjectured that every latin square has a near transversal---i.e.\! a collection of cells with distinct symbols which intersects all but one row and all but one column. Our first main result confirms Brualdi's conjecture in the special case of group-based latin squares.

Then, using a well-known equivalence between edge-colorings of complete bipartite graphs and latin squares, we introduce Hamilton 2-plexes. We conjecture that every latin square of order $n \geq 5$ has a Hamilton 2-plex and provide a range of evidence for this conjecture. In particular, we confirm our conjecture computationally for $n \leq 8$ and show that a suitable analogue of Hamilton 2-plexes always occur in $n \times n$ arrays with no symbol appearing more than $n/\sqrt{96}$ times. To study Hamilton 2-plexes in group-based latin squares, we generalize the notion of harmonious groups to what we call H2-harmonious groups. Our second main result classifies all H2-harmonious abelian groups. 

The last part of the thesis formalizes an idea which first appeared in a paper of Cameron and Wanless: a $(k,\ell)$-plex is a collection of cells which intersects each row and column $k$ times and contains at most $\ell$ copies of each symbol. We demonstrate the existence of $(k,4k)$-plexes in all latin squares and $(k,k+1)$-plexes in sufficiently large latin squares. We also find analogues of these theorems for Hamilton 2-plexes, including our third main result: every sufficiently large latin square has a Hamilton (2,3)-plex.
\end{abstract}

\begin{dedication}
\begin{center}
To Mom, Dad, Caitlin and Kenzie. 

\end{center}

\begin{align*}
&\textit{Kindness eases Change.}\\
&\textit{Love quiets fear.}\\
&\textit{And a sweet and powerful}\\
&\textit{Positive obsession}\\
&\textit{Blunts pain,}\\
&\textit{Diverts rage,}\\
&\textit{And engages each of us}\\
&\textit{In the greatest,}\\
&\textit{The most intense}\\
&\textit{Of our chosen struggles}
\end{align*}

\begin{center}

- Octavia E. Butler, from \emph{Parable of the Talents}

\end{center}


\end{dedication}


\begin{acknowledgements}
There are many people responsible for this thesis coming together. Above all, I would not have made it anywhere near this far in my academic career without the support of my parents. I am incredibly privileged to have two parents who have not only walked this path before, but are eager to share advice and support whenever I need it. Thank you both, I love you so much. 

Special mention must also go to my partner Kenzie Parry, whose tender care and loving support has given me the strength I needed to get through this process. We got this!

Thank you to Maureen Callanan, Stefan Hannie, Tara Petrie, and Alexandra Wesolek for reading drafts of various parts of this thesis and offering helpful comments. Thank you to Peter Bradshaw, Jesse Campion Loth, Sebastian Gonzalez Hermosillo de la Maza, Stefan Hannie, Avi Kulkarni, Tabriz Popatia, Stefan Trandafir, and Alexandra Wesolek for discussions of the mathematics behind ideas which appeared here. 

Thank you to Luis Goddyn for supervising this project, and to Matt Devos, Bojan Mohar, and Ladislav Stacho for guidance on mathematical matters. Thank you to Veselin Jungic for a year of mentorship that far exceeded that usual bounds of a TA-instructor relationship, to Rob Beezer for introducing me to group theory and computer algebra, to Douglas Cannon for helping me discover the beauty of pure mathematics, and to Jonathan Jedwab for giving me fantastic advice when I was not yet mature enough to receive it. And an extra special thank you to Marni Mishna for helping me navigate the politics of academia. 

Finally, I'd like to thank all of my dear friends, including extreme gratitude for those of you mentioned mentioned above, as well as Daoud Anthony, Chelsea Cater, Caro Deady, Danielle Rogers, Jarin Schexnider, Isadore Schexnider Hannie, Mark Sutherland, and Sara Yeomans, for the fun hangs, chats,  and emotional support I needed to get through when the work involved in this process felt overwhelming. Similar gratitude must also be extended to family members not yet mentioned:   Catilin, Rob, and Amos; Grandma Marilynn; Grandpa Billy (I miss you so much already) and Aunt Beth; Mary, Dave, Siobhan, Jacob, Max, and Fiadh; Scott and Sue; John, Lisa, Eli, and David---I love you all so much.

\end{acknowledgements}

\addtoToC{Table of Contents}%
\tableofcontents%
\clearpage

%This is an optional page. Remove the following lines if you don't have any tables.
\addtoToC{List of Tables}%
\listoftables
\clearpage

%This is an optional page. Remove the following lines if you don't have any figures.
\addtoToC{List of Figures}%
\listoffigures
\clearpage


\setglossarystyle{longragged}
{
\setlength{\glsdescwidth}{1\textwidth}
\setstretch{10.0}
\glsaddall
  \addtoToC{List of Symbols}%
  \begingroup     
\let\clearpage\relax  
\printglossary[type=\acronymtype, title= List of Symbols]
\endgroup
  }
  \clearpage



 \setglossarystyle{altlist}
   \addtoToC{Glossary}
 \printglossary%
\clearpage
%
%
%%   MAIN MATTER  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%
%%   Start writing your thesis --- or start \include ing chapters --- here.
%%
%
\mainmatter%

\chapter{Introduction}

Currently well-known to the general public in the special case of Sudoku puzzles, latin squares are mathematical objects whose rigorous study goes back over 300 years. While the earliest known appearance in the literature was an early 18th century monograph of Choi Seok-Jeong,  constructions of $4\times 4$ latin squares appear in the 13th century writings of Ahmad al-Buni  \cite[p.~12]{HandbookOfDesigns}. Today, latin squares are used by a wide range of scientists and engineers. They are a well-known and oft-utilized tool in the design of both statistical experiments and digital communications technology  \cite[Sec.~11.4]{DenesKeedwellBook}, and are currently being studied in myriad applied mathematical contexts  (see e.g. \cite{GH12,St20,XX17}).

This thesis studies balanced substructures of latin squares. A \defn{latin square} $L$ of order $n$ is an $n \times n$ array in which each row and column is a permutation of some set $S(L)$ of size $n$ (usually the set of integers $[n]:=\{1,2,\ldots,n\}$). 
Indexing rows and columns with $[n]$, latin squares can be treated as collections of $n^2$  ordered triples $L \subseteq [n]^3$. We refer to each triple $(r,c,s) \in L$ as a \defn{cell}. For positive integers $k \leq n$, a \defn{$k$-plex} of $L$ is a collection of cells which intersects each row and column $k$ times and contains $k$ copies of each symbol. Our main results concern the existence of $k$-plexes in latin squares and their generalizations. The first half of this thesis considers group-based latin squares, resolving the restriction to this setting of a well-known old conjecture due to Brualdi and establishing fundamental results concerning a new form of combinatorial group sequence. The second half poses and explores a graph-theoretic strengthening of a less famous conjecture due to Rodney and proves several existence results for approximations of plexes. 

% given a latin square $L$, we write $R(L)$ for the set of rows, $C(L)$ for the set of columns, $S(L)$ for the set of symbols, and refer to each $(r,c,s) \in R(L) \times C(L) \times S(L)$ as a . %We write $|L|$ to denote the order of $L$, rather than the number of triples in the corresponding set, so that $|L|=n$ even though we consider $L$ to be a set of $n^2$ cells.


The story of latin squares as an object of modern combinatorial mathematics begins with work of Leonard Euler from the late 18th century \cite{Euler} on a notion now known as orthogonality: two latin squares of order $n$ are said to be \defn{orthogonal} if the array one obtains by superimposing them contains each possible pair of symbols exactly once.\footnote{The somewhat peculiar name ``latin square'' was introduced by Euler because he was using latin squares to construct magic squares---squares with integer entries wherein the sum of each row, column, and main diagonal is the same---and following the algebraic convention of using latin letters for algebraic indeterminates.} Then, in the late 19th and early 20th centuries, work of Arthur Cayley \cite{Ca78} and Ruth Moufang \cite{Mo35}, among others, further established latin squares as important objects of pure mathematics by drawing connections between latin squares and several well-known geometric and algebraic structures. As indicated above, we are particularly interested in the connection between groups and latin squares demonstrated by Cayley: every finite group $G$ can be represented by the \defn{group-based} latin square $L_G$, with rows and columns are indexed by the elements of $G$ and the cell in row $g$ and column $h$ containing the symbol $gh$. Perhaps the central motivating conjecture for the study of latin squares in the early-to-mid twentieth century, however, goes all the way back to Euler; Euler's conjecture that there are no orthogonal latin squares of order $4n+2$ inspired a significant amount of work (see \cite[Section 5.1]{DenesKeedwellBook}) up until it was definitively disproven by Bose, Shrikhande, and Parker \cite{BSP60} in 1960. 

\begin{figure}[t]
\centering
\begin{subfigure}{0.4\textwidth}
%{\LARGE$L=$}
\resizebox{4.5cm}{!}{
\begin{tabular}
{|c|c|c|c|}
  \hline
1&2&3&4\\ \hline
2&1&4&3\\ \hline
3&4&1&2\\ \hline
4&3&2&1\\ \hline
\end{tabular}
}
\end{subfigure}
%\hspace{12pt}{\LARGE$\Gamma(L)=$}
\begin{subfigure}{0.3\textwidth}
%{\LARGE$L=$}
\resizebox{4.5cm}{!}{
\begin{tabular}
{|c|c|c|c|}
  \hline
1&2&3&4\\ \hline
3&4&1&2\\ \hline
4&3&2&1\\ \hline
2&1&4&3\\ \hline
\end{tabular}
}
\end{subfigure}
\caption{A pair of orthogonal latin squares of order 4.}\label{fig:orthogonal}
\end{figure}

Although we will not discuss orthogonal latin squares explicitly in what follows, their study is the source of the problems considered by this thesis. In particular, if $L_1$ and $L_2$ are orthogonal latin squares and $s \in S(L_2)$, then the set $T$ of cells in $L_1$ corresponding to the positions of cells with symbol $s$ in $L_2$ is a 1-plex (see Figure \ref{fig:orthogonal}). We will usually refer to 1-plexes by their more common, and much older, name: \defn{transversals}. The key observation to be made here is: for a latin square $L_1$ of order $n$, there is a latin square $L_2$ orthogonal to $L_1$ if and only if we can partition $L_1$ into $n$ disjoint transversals. While it was this connection to orthogonal latin squares that first inspired the study of transversals in latin squares \cite{Wa2011}, we will see shortly that the study of transversals and their various generalizations is a very rich topic in its own right. 

\section{Transversals}\label{sec:introtransversal}

Already present in the work of Euler \cite{Euler} was the implicit observation that, for every even integer $n$, there exists a latin square of order $n$ with no transversal. However, to this day there are no latin squares of odd order known to not have a transversal. It has now been over five decades since the mathematical community began trying to prove that this observed pattern extends to all latin squares of odd order. 

\begin{conjecture}[Ryser \cite{Ry67}]\label{conj:ryser}
Every latin square of odd order has a transversal.
\end{conjecture}

Ryser may have made the stronger conjecture that the number of transversals in every latin square of order $n$ is congruent to $n$ modulo 2 (see \cite{BW18plus} for a discussion of what exactly Ryser may or may not have conjectured). Balasubramanian \cite{Ba90} provided a partial result in the direction of this stronger conjecture by showing that every latin square of even order has an even number of transversals. Unfortunately, it is not true that all latin squares of odd order have an odd number of transversals because, as was noted in e.g.\! \cite{BW18plus,CW05,Wa02}, there exist latin squares of order 7 with an even number of transversals. 

Though there has been some very interesting recent work on the enumeration of transversals in latin squares \cite{DG18,EMM19,EMM20plus,GL16,Ta15}, because we are here interested in questions of existence we will leave an exploration of this topic (via the papers just cited) to the reader. One enumerative result, however, is worth discussing in this context. Although Conjecture \ref{conj:ryser} is concerned only with latin squares of odd order, and it is known that for all even $n$ there are at least $n^{n^{3/2}(1/2-o(1))}$ latin squares of order $n$ with no transversal \cite{CW17},  a landmark paper of Kwan \cite{Kw20} shows that almost every latin square has a transversal. More precisely, it is shown in \cite{Kw20} that the probability of a uniformly random latin square of order $n$ containing $\left((1-o(1))\frac{n}{e^2} \right)^n$ distinct transversals approaches 1 as $n$ approaches infinity. This is one of the most compelling pieces of positive evidence in support of Conjecture \ref{conj:ryser} known to date. 

It is worth noting that some evidence indicating Conjecture \ref{conj:ryser} may not be true was given by Egan and Wanless in \cite{EW12}. In that paper, it was shown that for all odd $m \geq 3$, there exists a latin square  of order $3m$ which contains an $(m-1) \times m$ latin subrectangle all of whose cells are not in any transversal. Moreover, it is shown that, for all $n \geq 4$, there exists a latin square of order $n$ with at least 7 cells which do not appear in any transversal. Nonetheless, a preponderance of the currently available evidence seems to be in support of Conjecture \ref{conj:ryser}. 

\section{Partial transversals}

Much of the work towards Conjecture \ref{conj:ryser} has considered the slightly weaker notion of \defn{partial transversals}, or collections of cells which intersect each row and column at most once and contain at most one copy of each symbol. There is a growing body of literature studying when partial transversals are properly contained in larger partial transversals \cite{BMSW19,CHN09,Ev19,EMW21,Gr03}, and there have been several papers considering decompositions of latin squares into disjoint partial transversals \cite{BGMM16,CK15,GHM19,Na20}. In this thesis, though, we are most interested in partial transversals of maximum size. 

Over the years, a series of papers has provided increasing bounds on the size of partial transversals which must exist in every latin square. Picking up the story partway through, it was shown concurrently and independently by  Brouwer et al. \cite{BVW78} and Woolbright \cite{Wo78} that every latin square of order $n$ has a partial transversal of size at least $n-\sqrt{n}$. After a couple of erroneous claimed improvements,  Hatami and Shor \cite{HS08} were then able to improve the bound to $n-11.053\log^2 n$. The currently best known bound is due to Keevash et al. \cite{KPSY20plus}, who showed that every latin square of order $n$ has a partial transversal of size $n-O\left(\frac{\log n}{\log \log n}\right)$. Given that not all latin squares have a transversal, one may wonder how close to $n$ this bound will get. Referring to a partial transversal of size $n-1$ as a \defn{near transversal}, we now arrive at the first of the three main motivating conjectures for this thesis. 

\begin{conjecture}[Brualdi \cite{BrualdiRyserBook}]\label{conj:brualdi}
Every latin square has a near transversal.
\end{conjecture}

An even stronger conjecture concerning the minimum covering radius (with respect to Hamming distance) of a set of permutations, and the progress towards that conjecture \cite{CW05,WZ13,HW20}, is worth noting. Nonetheless, we will here focus on Brualdi's conjecture as stated. In Chapter \ref{ch:jcd} we will prove that the conjecture holds for all group-based latin squares. Further evidence for this conjecture was recently given by Best et al. \cite{BPW21}, who confirmed that Conjecture \ref{conj:brualdi} holds for all latin squares of order at most 11.  However, there has been recent work indicating that Brualdi's conjecture may not be true.

Conjecture \ref{conj:brualdi} has often been attributed to Stein---and is often stated alongside Conjecture \ref{conj:ryser} as the Ryser-Brualdi-Stein conjecture (see e.g. \cite{GH20, KPSY20plus, MPS19})---but the oft-cited paper of Stein makes only the stronger conjecture that every \defn{equi-$n$ square}, i.e.\! every $n \times n$ array in which each symbol in $[n]$ appears $n$ times, has a near transversal. This distinction is worth noting because Stein's conjecture was recently shown to be false when Pokrovskiy and Sudakov \cite{PS19} constructed equi-$n$ squares with no partial transversal of size greater than $n-\frac{1}{42}\log n$ for all $n \geq e^{120}$. When combined with Aharoni et al.'s \cite{ABKZ17} proof that every equi-$n$ square has a partial transversal of size at least $\frac{2}{3}n$, this work raises the interesting question of whether every equi-$n$ square has a partial transversal of size $n-o(n)$. It is shown in \cite{PS19} that this question has a positive answer under the additional assumption that no symbol appears too many times in any row or column. It is also known \cite{PS13} that almost every equi-$n$ square has a transversal. 

\section{Generalizations of latin squares}

Equi-$n$ squares are just one of many generalizations of latin squares whose partial transversals have been extensively studied. They can be naturally generalized to what we call \defn{$k$-bounded $n$-squares}, which are $n \times n$ arrays in which no symbol appears more than $k$ times. A famous paper of Erd\H{o}s and Spencer \cite{ES91} shows that all $\frac{n-1}{4e}$-bounded $n$-squares have a transversal. This was later improved upon by Biasscot et al. \cite{BFPS11}, who showed that every $\frac{27n}{256}$-bounded $n$-square has a transversal, and Perarnau and Serra \cite{PS13}, who gave an asymptotically precise enumeration of the transversals in $\frac{n}{10.93}$-bounded $n$-squares. We will study $k$-bounded $n$-squares below in Section \ref{sec:LLLL}.

The spirit of latin squares is perhaps better retained by considering arrays with various ``latin'' properties. A rectangular array is referred to as \defn{row-latin} (respectively \defn{column-latin}) if no symbol appears more than once in any row (resp. column). An array which is both row-latin and column-latin is often called a \defn{latin array}. In $m \times n$ arrays with $m \neq n$, the term transversal is used for partial transversals of size $\min\{m,n\}$. Transversals in such latin arrays are well-understood. Drisko \cite{Dr98} showed that, whenever $m \geq 2n-1$, every $m \times n$ row-latin rectangle has a \gls{transversal} and provided examples showing that the given lower bound on $m$ is tight. It is worth noting that Drisko's proof of the lower bound depends upon columns containing many copies of the same symbol. When we restrict to arrays which are also column-latin, H\"{a}ggkvist and Johansson showed that all $(n+o(n)) \times n$ latin arrays can be decomposed into disjoint transversals, and there have subsequently been several further, graph-theoretic strengthenings of these results \cite{ACH15,AKZ17,Po17,Po18}.

There has also been much recent work on transversals in square latin arrays (which are more general than latin squares in that they may contain more than $n$ symbols). Inspired by a conjecture of Akbari and Alipour \cite{AA04} that every $n \times n$ latin array with at least $\frac{n^2}{2}$ distinct symbols contains a transversal, Best et al. \cite{BHWWW18} showed that every \gls{square latin array} containing at least $(2-\sqrt{2})n^2$ symbols has a transversal. Akbari and Alipour's conjecture was subsequently proven for sufficiently large $n$ concurrently and independently by Keevash and Yepremyan \cite{KY20}, who proved the stronger result that $n^{399/200}$ symbols suffice for large $n$, and by Montgomery et al. \cite{MPS19}. 

The proof of the sufficiently large version of this conjecture by Montgomery et al. was only a small portion of  a wide-ranging paper; the main result of \cite{MPS19} is also of significant interest here: every $n \times n$ latin array in which at most $n-o(n)$ symbols occur more than $n-o(n)$ times has $n-o(n)$ disjoint transversals. An alternative proof of this result was given by Ehard et al. \cite{EGJ20}, and a proof of a similar result (where all symbols must occur at most $n-o(n)$ times in the array but rows and columns can contain up to $o(n/\log^2 n)$ copies of a given symbol) was given by Kim et al. in \cite{KKKO20}. These results concerning many disjoint transversals in latin arrays are especially interesting to us because they imply the existence $k$-plexes, a type of generalized transversal defined above which will play an important role throughout this thesis. 



\section{Plexes}

Generalizing the definition given in the second paragraph of this thesis, we define a \defn{$k$-plex} in an $n \times n$ array to be a collection of cells which intersects each row and each column exactly $k$ times and contains at most $k$ copies of each symbol. The term ``$k$-plex''  was introduced fairly recently, by Wanless  \cite{Wa02} in 2002, although it was noted in \cite{Wa02} that $2$, $3$, and $4$-plexes have been discussed in the statistical literature for many decades. The study of $k$-plexes as combinatorial objects has been around since at least the mid-90s when, according to Dougherty \cite{Do96}, our second main motivating conjecture was given---though never published---by the late Peter Rodney.

\begin{conjecture}[Rodney]
Every latin square has a 2-plex. 
\label{conj:rodney}\end{conjecture}

Mirroring the current status of Brualdi's conjecture, Rodney's conjecture was shown to hold for groups by Vaughan-Lee and Wanless \cite{VLW03}, and is known to hold for all latin squares of order at most 9 \cite{EW11}. For general latin squares, a weaker, weighted version of Conjecture \ref{conj:rodney}, as well as Conjecture \ref{conj:ryser}, was proven by Pula \cite{Pu11}. 

While the attribution of Conjecture \ref{conj:rodney} to Rodney is well-established (appearing as such in the fairly authoritative Handbook of Combinatorial Designs \cite[p. 143]{HandbookOfDesigns}), Dougherty actually attributes to Rodney the stronger conjecture \cite[p. 130]{Do96} that every latin square can be partitioned into disjoint 2-plexes with an additional transversal left over for latin squares of odd order. Notice that the union of an $a$-plex and a $b$-plex forms an $a+b$-plex. Combining this observation with the stronger conjecture of Rodney, we obtain the third main motivating conjecture in this thesis. 

\begin{conjecture}
For all even $k \leq n$, every latin square of order $n$ has a $k$-plex.
\label{conj:wanless}\end{conjecture}

  Although Conjecture \ref{conj:wanless} is also due to Rodney, we will use the name ``Rodney's conjecture'' only to refer to Conjecture \ref{conj:rodney}. Wanless showed that Conjecture \ref{conj:wanless} holds for group-based latin squares in \cite{Wa02}. Moreover, the computation in \cite{EW11}, cited above as confirming Rodney's conjecture, was in fact a confirmation that all latin squares of order at most 9 have $\lfloor n/2\rfloor$ disjoint 2-plexes. Thus, it also known that all latin squares of order $n \leq 9$ have a $k$-plex for every even $k \leq n$. 
  
When $k$ is odd and $n$ is even, there does not seem to be any consistent pattern concerning the existence of $k$-plexes in latin squares of order $n$. Indeed, for every positive even integer $n$, Egan and Wanless \cite{EW08} constructed a latin square of order $n$ that has a $k$-plex for every even value of $k$ between$ \lfloor n/4 \rfloor$ and $ \lceil 3n/4 \rceil$ but no $k$-plex for any value of $k$ outside that range. Furthermore, Cavenagh and Wanless \cite{CW17} have shown that, for all even $n > 4$, there is a latin square of order $n$ which contains a 3-plex but no transversal. An interesting question which was raised by both of these papers but remains unanswered is whether there exists a latin square with an $a$-plex and a $c$-plex but no $b$-plex for odd integers $a<b<c$. 

There have also been several papers \cite{BEMW09,Eg11,EW11} studying \defn{indivisible plexes}, or $k$-plexes which do not contain an $\ell$-plex for any positive integer $\ell <k$, and others \cite{BKLOT17, CKW14, DH84, St20, Wa02} treating $k$-plexes as a primary object which may or may not be embeddable in a latin square. We refer the reader to \cite{BCGG19} for an interesting description of plexes in the language of spectral graph theory, and \cite{Li12} for a weaker form of orthogonality stated in terms of $k$-plexes. 

In this thesis we coin the term \defn{$(k,\ell)$-plex} to describe a collection of cells in a square array which intersects each row and column exactly $k$ times and contains at most $\ell$ copies of each symbol. Although this term does not seem to have appeared previously in the literature, there have been at least three papers which considered $(1,2)$-plexes. Cameron and Wanless \cite[Prop.\! 7]{CW05} were the first to show that every latin square has a $(1,2)$-plex. This result has since been extended by Aharoni et al. \cite[Theorem 1.16]{ABKZ18}, who showed that every $n \times n$ \gls{row-latin array} with exactly $n$ symbols has a $(1,2)$-plex, and Best et al. \cite[Lemma 13]{BPW21}, who showed that every entry in every latin square is contained in a $(1,2)$-plex. 

In Chapter \ref{ch:varplex}, we initiate the study of $(k,\ell)$-plexes for $k >1$. In particular, we show that every latin square has a $(k,4k)$-plex for all $k \leq \frac{n}{4}$ and every sufficiently large latin square has a $(k,k+1)$-plex for $k = O(1)$. We also raise several questions concerning $(k,\ell)$-plexes---most of which are weaker versions of Conjecture \ref{conj:wanless}---in Chapter \ref{ch:conc}. 











\section{Graph-theoretic representations of latin squares}\label{sec:intrograph}

A significant portion of the work in this thesis is given in the language of graph theory. Indeed, there are several means of representing latin squares graph-theoretically. One which has proven particularly useful (see e.g. \cite{HW20,Kw20,ABKZ18}), but will not be discussed here, is the equivalence between latin squares and 3-uniform tripartite linear \gls{hypergraph}s (an excellent explanation of this connection is given in \cite{AB09}). There are also several connections between certain special families of latin squares and decompositions of complete graphs into cycles (see \cite[Section 8.3]{DenesKeedwellBook}). We are interested here in two particular representations, though another will be worth introducing to motivate some portions of our work. 

\begin{figure}[h]
\centering
\begin{subfigure}{0.4\textwidth}
\resizebox{5cm}{!}{
\begin{tabular}
{|c|c|c|}
  \hline
\textcolor{red}{ \bf 1}&2&{3}\\ \hline
2&\textcolor{red}{\bf 3}&1\\ \hline
{3}&1&\textcolor{red}{ \bf 2}\\ \hline
\end{tabular}
}
\end{subfigure}
\begin{subfigure}{0.3\textwidth}
\begin{tikzpicture}[scale=1.5,auto=left,every node/.style={circle,draw,thick,fill=white,minimum size=1pt}]

\foreach \i in {1,2}{
\foreach \j in {1,2}{
\draw [thick] (\i,\j)--(\i,\j+1);
\draw [thick] (\i,\j)--(\i+1,\j);
}}

\draw [thick] (3,1)--(3,3);
\draw [thick] (1,3)--(3,3);

\draw [thick] (1,3) to[out=20,in=160] (3,3);
\draw [thick] (1,2) to[out=20,in=160] (3,2);
\draw [thick] (1,1) to[out=20,in=160] (3,1);
\draw [thick] (3,1) to[out=70,in=-70] (3,3);
\draw [thick] (2,1) to[out=70,in=-70] (2,3);
\draw [thick] (1,1) to[out=70,in=-70] (1,3);

\draw [thick] (1,3) to(3,2);
\draw [thick] (2,1) to(3,2);
\draw [thick] (2,1) to (1,3);

\draw [thick] (2,3) to(1,2);
\draw [thick] (1,2) to (3,1);
\draw [thick] (3,1) to(2,3);

\draw [thick] (1,1) to (2,2);
\draw [thick] (2,2) to(3,3);
\draw [thick] (1,1) to[out=60,in=210] (3,3);

\foreach \i in {1,2,3}{
\foreach \j in {1,2,3}{
\node (z) at (\i,\j) {};
}}
\node (z) [fill=red] at (3,1) {};
\node (z) [fill=red] at (2,2) {};
\node (z) [fill=red] at (1,3) {};




\end{tikzpicture} 
\end{subfigure}
\caption[A latin square graph of order 3]{A latin square $L$ and its associated latin square graph $\Gamma(L)$. The cells of a transversal are highlighted, as are the vertices of the corresponding independent set.}\label{fig:lsg}
\end{figure}

Given a latin square $L$, we write $R(L)$ for its set of rows, $C(L)$ for its set of columns, and $L_{r,c}$ for the symbol in row $r$ and column $c$. The \defn{latin square graph} $\Gamma(L)$ is defined on the vertex set $R(L) \times C(L)$ with $(r,c) \sim (s,d)$ if and only if one of $r=s$, $c=d$, or $L_{r,c} = L_{s,d}$ holds. Figure \ref{fig:lsg} contains an example of this construction. Latin square graphs were introduced by  Bose \cite{Bose1963} in the 1960s as an example of nontrivial strongly regular graphs. They have attracted attention from researchers (e.g.\! \cite{BCGG19, CD09, PGSK21,PPT21}) interested in strictly graph-theoretic questions as an interesting family of symmetric graphs. They have also been utilized as a tool in the study of latin squares \cite{BGMM16,FS17,GHM19}. We will use them in Chapter \ref{ch:jcd} to prove that Brualdi's conjecture is true for group-based latin squares, utilizing the crucial observation that partial transversals in $L$ correspond to independent sets, i.e.\! sets of vertices no two of which are adjacent, in $\Gamma(L)$.

A much more common way of graph-theoretically representing latin squares is as edge-colorings of a balanced complete bipartite graph. Given a latin square $L$ of order $n$, we define $K_{n,n}(L)$ to be the proper $n$-edge-colored copy of $K_{n,n}$ such that: the vertex \gls{bipartition} is labeled by \acrshort{RL}$= \{r_1,r_2,\ldots,r_n\}$ and \acrshort{CL}$=\{c_1,c_2,\ldots,c_n\}$, respectively,  and the edge $r_ic_j$ is colored by the symbol $L_{i,j}$. We also write $\chi_L:E(K_{n,n}) \rightarrow S(L)$ to denote the edge-coloring of $K_{n,n}(L)$. See Figure \ref{fig:KnnL} for an example of this construction. This representation of latin squares has been profitably used to study uniquely completable partial latin squares \cite{BurgessKeedwell2001,Keedwell1994,Mahmoodianetal1997}, to study partial transversals in latin squares  \cite{ABKZ18, CP19,MPS19}, and to construct latin squares with nice symmetry properties \cite{Schroeder2019,Wanless1999,WanlessIhrig2005}. Notice that we can similarly construct an edge-coloring of $K_{n,n}$ using any $n \times n$ array; we will consider $K_{n,n}(S)$, where $S$ is a $k$-bounded $n$-square, in Section \ref{sec:LLLL}. 

\begin{figure}[h]
\centering
\begin{subfigure}{0.5\textwidth}
%{\LARGE$L=$}
\resizebox{6cm}{!}{
\begin{tabular}
{|c|c|c|c|}
  \hline
\textcolor{red}{1}&\textcolor{blue}{2}&\textcolor{green}{3}&4\\ \hline
\textcolor{blue}{2}&\textcolor{red}{1}&4&\textcolor{green}{3}\\ \hline
\textcolor{green}{3}&4&\textcolor{red}{1}&\textcolor{blue}{2}\\ \hline
4&\textcolor{green}{3}&\textcolor{blue}{2}&\textcolor{red}{1}\\ \hline
\end{tabular}
}
\end{subfigure}
%\hspace{12pt}{\LARGE$\Gamma(L)=$}
\begin{subfigure}{0.43\textwidth}
\begin{tikzpicture}[scale=2.5,auto=left,every node/.style={circle,draw,thick,fill=white,minimum size=1pt}]


\draw [thick, red] (90:1)--(135:1);
\draw [thick, red] (180:1)--(225:1);
\draw [thick, red] (270:1)--(-45:1);
\draw [thick, red] (0:1)--(45:1);

\draw [thick, blue] (90:1)--(45:1);
\draw [thick, green] (90:1)--(-45:1);
\draw [thick] (90:1)--(225:1);

\draw [thick, blue] (0:1)--(135:1);
\draw [thick, green] (0:1)--(225:1);
\draw [thick] (0:1)--(-45:1);

\draw [thick, blue] (270:1)--(225:1);
\draw [thick, green] (270:1)--(135:1);
\draw [thick] (270:1)--(45:1);

\draw [thick, blue] (180:1)--(-45:1);
\draw [thick, green] (180:1)--(45:1);
\draw [thick] (180:1)--(135:1);


\foreach \i in {1,...,4}{
\node (z) at ({90 * (\i - 1)}:1) {};
\node (z) [fill=black] at  ({90 * (\i - 1)+45}:1) {};
}

\node (z) [fill=none,draw=none] at (90:1.2) {$r_1$};
\node (z) [fill=none,draw=none] at (45:1.2) {$c_2$};
\node (z) [fill=none,draw=none] at (0:1.2) {$r_2$};
\node (z) [fill=none,draw=none] at (-45:1.2) {$c_3$};
\node (z) [fill=none,draw=none] at (-90:1.2) {$r_3$};
\node (z) [fill=none,draw=none] at (-135:1.2) {$c_4$};
\node (z) [fill=none,draw=none] at (180:1.2) {$r_4$};
\node (z) [fill=none,draw=none] at (135:1.2) {$c_1$};



\end{tikzpicture} 
\end{subfigure}
\caption[A latin square and the associated edge-coloring of $K_{n,n}$]{A latin square $L$ of order 4 and the associated edge-colored graph $K_{4,4}(L)$.}\label{fig:KnnL}
\end{figure}


Harary \cite{Ha60} was the first to point out the connection between partial transversals in latin squares and rainbow matchings, i.e.\! matchings containing at most one copy of each color, in proper $n$-edge-colorings of $K_{n,n}$. In Chapters \ref{ch:h2terrace} and \ref{ch:varplex} we will make use of an extension of this observation. We say that an edge-colored graph is \defn{$k$-bounded} if it contains at most $k$ edges of each color (1-bounded graphs are more commonly referred to as \defn{rainbow} graphs).  Following Harary, we observe that $k$-plexes in $L$ are equivalent to $k$-regular $k$-bounded spanning subgraphs of $K_{n,n}(L)$. In a slight abuse of terminology, we will also refer to such subgraphs in edge-colorings of $K_{n,n}$ as $k$-plexes.

We may use the two graph-theoretic representations of latin squares just introduced to define two important types of symmetry. We say that two latin squares $L_1$ and $L_2$ are \defn{main class equivalent} if $\Gamma(L_1) \cong \Gamma(L_2)$. Notice that, if $L_1$ and $L_2$ are main class equivalent, then there is bijective correspondence between the partial transversals in $L_1$ and the partial transversals in $L_2$---namely, they both correspond to the independent sets of $\Gamma(L_1)$. A \defn{main class} of latin squares is a maximal collection of main class equivalent latin squares. When we discuss partial transversals in what follows, we will not distinguish between latin squares in the same main class.

Assuming $|L_1|=|L_2|=n$, we say that $L_1$ and $L_2$ are \defn{isotopic} if there is an automorphism of $K_{n,n}$ that maps each color class of $K_{n,n}(L_1)$ to a color class of $K_{n,n}(L_2)$. Notice that isotopic latin squares are main class equivalent, but one can find two latin squares in the same main class which are not isotopic (see e.g. \cite[Chapter 1]{DenesKeedwellBook}). Moreover, if $L_1$ and $L_2$ are isotopic, then the $k$-plexes of $L_1$ and the $k$-plexes of $L_2$ induce the same collection of edge-colored graphs (up to graph isomorphism). We refer to a maximal collection of isotopic latin squares as an \defn{isotopy class}. When discussing $k$-plexes in what follows, we will not distinguish between isotopic latin squares.

\section{This thesis's novel conjecture}\label{sec:introconj}






%The main result of \cite{MPS19} is that a generalized latin square in which the number of symbols appearing more than $(1-o(1))n$ times is at most $(1-o(1))n$ has a decomposition into $(1-o(1))n$ disjoint transversals. Observe that this result could be considered to confirm Stein's Conjecture in an asymptotic sense. 
%It was conjectured in \cite{AA04} that every generalized latin square with $n^2/2$ symbols has a transversal. The main result of \cite{MPS19} implies that, for any $\varepsilon$, there is an $N$ such that any generalized latin square of order at least $N$ containing $\varepsilon n^2$ symbols has not just one, but in fact $(1-\varepsilon)n$ disjoint, transversals. 

%The main results of \cite{AA04} are (1) for every proper coloring of $K_{n,n}$ the number of 1-factors using exactly $n-1$ colors is even and (2) for any coloring of $K_{2n}$ (for $n \geq 8$) in which each color appears on at most $\frac{n-2}{2e}$ edges has a rainbow perfect matching.


%In \cite{WoolbrightFu1998} it is shown that every proper edge coloring of $K_{2n}$ has a rainbow perfect matching.




We noted above that 2-plexes in the latin square $L$ correspond to 2-regular 2-bounded spanning subgraphs of $K_{n,n}(L)$. Perhaps the most famous type of 2-regular spanning subgraph of a graph $G$ is the \defn{Hamilton cycle}, which is a cycle containing every vertex of $G$. We define a \defn{Hamilton $(2,\ell)$-plex} in a square array $S$ as an $\ell$-bounded Hamilton cycle in $K_{n,n}(S)$; in the case $\ell=2$ we simply use the term \defn{Hamilton 2-plex}. The first main contribution of this thesis is the following novel strengthening of Rodney's conjecture.


\begin{conjecture}\label{conj:main}
Every latin square of order $n \geq 5$ has a Hamilton 2-plex. 
\end{conjecture}

The condition $n \geq 5$ in Conjecture \ref{conj:main} is necessary because there is a latin square of order 4 which does not have a Hamilton 2-plex. Indeed, we have shown this latin square in Figure \ref{fig:KnnL}. It is also straightforward to check that this latin square is main-class equivalent to $L_{\mathbb{Z}_2\times\mathbb{Z}_2}$. We believe that this is the only latin square which does not have a Hamilton 2-plex, and we have confirmed this for all latin squares of order at most 8.

%which may be represented in the block form $\begin{pmatrix} A & B \\B'&A' \end{pmatrix}$. Let $P$ be a 2-plex of $L$. Notice that $P$ must contain exactly two cells from $A$, as otherwise it will not be possible for $P$ to have two copies of symbol 3 and two copies of the symbol 4. If the two cells in $P \cap A$ are in the same row, then the t

\begin{proposition}\label{prop:upto8}
Every latin square of order at most 8, besides $L_{\mathbb{Z}_2\times \mathbb{Z}_2}$, has a Hamilton 2-plex.
\end{proposition}

We do not present a formal proof of this proposition here, but we refer the reader to:
%
\[\text{\url{https://sites.google.com/view/kevinhalasz/combinatorial-data}}\]
%
for the exhaustive data which establish the result. These data comes in the form of three documents: for each $n \in [6,8]$, we give a collection of lists of ordered triples corresponding to the cells of a Hamilton 2-plex in a representative of each \gls{isotopy class} of order $n$ latin squares. We use the \gls{isotopy class} representatives given by McKay in \cite{McKayPage}, and the ordering of the lists in our data corresponds to McKay's ordering. As noted in \cite[Sec. 4.2]{DenesKeedwellBook}, there is exactly one isotopy class of order at most 5 which does not contain a latin square based upon an abelian group. We give a Hamilton 2-plex for that square in Figure \ref{fig:prop5}, and we prove that all latin squares based on abelian groups have Hamilton 2-plexes in Section \ref{sec:h2abel} below.

\begin{figure}[h]
\centering
\newcommand{\overred}[1]{\textcolor{red}{\mathbf{{#1}}}}
\resizebox{5cm}{!}{
\begin{tabular}
{|c|c|c|c|c|}
  \hline
$\overred{0}$ & 1 &$ \overred{2} $& 3 & 4 \\\hline
1 & 3 & $\overred{0}$ &$ \overred{4}$ & 2 \\\hline
2 & $\overred{4}$ & 3 & $\overred{1}$ & 0 \\\hline
$\overred{3}$ & 0 & 4 & 2 & $\overred{1}$ \\\hline
4 & $\overred{2}$ & 1 & 0 & $\overred{3}$\\\hline
\end{tabular}}
\caption[A Hamilton 2-plex in the not-group-based latin square of order 5]{A Hamilton 2-plex in the unique (up to isotopy) latin square of order less than 6 which is not group-based.}\label{fig:prop5}
\end{figure}

The idea of considering Hamilton 2-plexes in latin squares was motivated by the literature on large rainbow paths and cycles in edge-colored complete graphs. There is a vast body of literature concerning rainbow Hamilton cycles in edge-colored graphs (see e.g.\! \cite{ AF19,BBPP17,CF02, CP20,JW07}) of which we will discuss here only a small, especially relevant portion. An order $n$ latin square $L$ is \defn{symmetric} if $L_{i,j} = L_{j,i}$ for all $i,j \in [n]$. One may associate an edge-coloring of $K_n$ with each symmetric latin square by giving the edge $v_iv_j$ the color $L_{i,j}$. This connection was noticed by Andersen \cite{An89}, who adapted Brouwer et al.\!'s \cite{BVW78} proof that every latin square has a partial transversal of size $n-\sqrt{n}$ to show that every proper edge-coloring of $K_n$ has a rainbow path-forest (union of disjoint paths) of size $n-\sqrt{2n}$. In terms of latin arrays, Andersen showed that every symmetric \gls{square latin array} has a partial transversal of size $n - \sqrt{2n}$.

Andersen then conjectured that every proper edge-coloring of $K_n$ has a rainbow path of length $n-2$, noting that Maamoun and Meyniel \cite{MM84} had constructed edge-colorings of $K_n$ with no rainbow path of length $n-1$ whenever $n$ is a power of 2. As described in the introduction of \cite{APS17}, there was a series of papers working towards this conjecture, with various authors proving the existence of rainbow paths of length $\alpha n$ for increasing constants $\alpha <1$. A breakthrough paper of Alon et al. \cite{APS17} showed that every proper edge-coloring of $K_n$ has a rainbow path of length $n-O(n^{3/4})$, and this was quickly improved using similar methods to $n-O(n^{1/2}\log n)$ by Balogh and Molla \cite{BM19}. It has also been shown by Gould et al. \cite{GKKO20plus} that almost every optimal (where the definition of optimal depends on the parity of $n$) proper edge-coloring of $K_n$ has a rainbow Hamilton path, and by Albert et al. \cite{AFR95} that every $\frac{n}{64}$-bounded proper edge-coloring of $K_n$ has a rainbow Hamilton cycle.

The final colored-graph representation of latin squares is worth discussing. One can associate with a latin square $L$ an arc-coloring of the complete directed graph $\overrightarrow{K}_n$ by giving the edge $v_iv_j$ the color $L_{i,j}$. Writing $\overrightarrow{K}_n(L)$ for this coloring, notice that partial transversals in $L$ correspond to rainbow subgraphs of $\overrightarrow{K}_n(L)$ with maximum in-degree and maximum out-degree 1. The original motivation for considering Hamilton 2-plexes was a paper of Gy\'{a}rf\'{a}s and S\'{a}rk\"{o}zy \cite{GS14} on the structure of the subgraphs of $\overrightarrow{K}_n(L)$ corresponding to partial transversals of $L$. In that paper they conjectured that all latin squares have a partial transversal of size $n-2$ which corresponds to a directed path in $\overrightarrow{K}_n(L)$. This conjecture remains open, although Benzing et al.\! \cite{BPS20} showed that there exists such a partial transversal of size $n-O(n^{2/3})$ in every latin square. Moreover, a recent paper of Gould and Kelly \cite{GK21plus} demonstrates that almost every latin square has a transversal corresponding to a rainbow Hamilton cycle in $\overrightarrow{K}_n(L)$. 



\section{Complete mappings and group sequences}\label{sec:introgroup}

It is possible to discuss partial transversals in group-based latin squares using purely group-theoretic language. Indeed, a \defn{complete mapping} of a group $G$ is a bijection $\theta:G \rightarrow G$ such that $g \mapsto g \theta(g)$ is also a bijection.  Observe that, if $\theta$ is a complete mapping of $G$, then $\{\left(g,\theta(g),g\theta(g)\right) \mid g \in G\}$ is a transversal of $L_G$.  
The study of complete mappings in groups goes back to at least the 1940s \cite{Pa47}, though work on similar ideas appeared in the late 19th century (see \cite[Chapter 3]{EvansBook}). Important results from this era include Bruck's proof \cite{Br44} that all groups of odd order have complete mappings, Paige's proof \cite{Pa47} that an abelian group has a complete mapping if and only if it does not have a unique element of order 2, and Bateman's proof \cite{Ba50} that every countably infinite group has a complete mapping. In 1955, Hall and Paige \cite{HP55} proved that groups with nontrivial non-cyclic \gls{Sylow 2-subgroup}s do not have complete mappings and conjectured that the converse to this statement holds. It took over 50 years before the Hall-Paige conjecture was finally resolved in three separate papers by Wilcox, Evans, and Bray.

\begin{theorem}[Hall and Paige \cite{HP55}; Bray \cite{BCCSZ20}; Evans \cite{Ev09}; Wilcox \cite{Wi09}]\label{thm:bigequiv}
A group $G$ has a complete mapping if and only if $\Syl_2(G)$ is trivial or non-cyclic.
\end{theorem}

While Theorem \ref{thm:bigequiv} fully resolved the existence question for transversals in group-based latin squares, the existence of near transversals was not resolved until last year \cite{GH20} with work that will be presented in this thesis. Given a group $G$ and three (not necessarily distinct) elements $a,b,c \in G$, we say that $\phi:G\setminus\{a\} \rightarrow G \setminus \{b\}$ is a \defn{near complete mapping} if $g \mapsto g\phi(g)$ is a bijection between $G \setminus \{a\}$ and $G \setminus \{c\}$. Notice that near complete mappings of $G$ are equivalent to near transversals of $L_G$. Moreover, given any complete mapping $\theta$, one can define a near complete mapping by removing any element from the domain of $\theta$. This means that every group with a complete mapping also has a near complete mapping. For abelian groups, the existence of near complete mappings in groups with no complete mapping follows from a theorem of Hall \cite{Ha52}. We will extend this result to all groups in Chapter \ref{ch:jcd}.

One may also describe Hamilton 2-plexes in group-based latin squares using purely group-theoretic language. Before we introduce this new terminology, it is worth briefly mentioning the notions after which it is modelled.  A \defn{sequencing} of a group $G$ is an ordering of its elements $g_1,g_2,\ldots,g_n$ such that the partial products $g_1,g_1g_2,\ldots,g_1g_2\cdots g_n$ are all distinct.  If $G$ has a sequencing, we refer to it as a \defn{sequenceable} group. Notice that, given a sequencing of $G$, the map $g_1g_2\cdots g_i \mapsto g_{i+1}$ is a near complete mapping. Sequencings were introduced by Gordon \cite{Go61}, who fully classified the sequenceable abelian groups. There has since been a substantial body of work on sequencings of groups and various generalizations of this notion. We will focus on one of these generalizations, as it will be particularly important in what follows, while referring the reader to a comprehensive dynamic survey due to Ollis \cite{OllisSurvey} for more information.

A \defn{harmonious sequence} of a group $G$ is an ordering of its elements $g_1,g_2,\ldots,g_n$ such that the consecutive products $g_1g_2,g_2g_3,\ldots,g_{n-1}g_n,g_ng_1$ are all distinct; if $G$ has a harmonious sequence we call it a \defn{harmonious group}. Notice that, given a harmonious sequence of $G$, the map $g_i \mapsto g_{i+1}$ is a complete mapping. Moreover, this complete mapping corresponds to a rainbow Hamilton cycle in $\overrightarrow{K}_n(L_G)$. Harmonious groups were introduced by Beals et al.\! \cite{BGHJ91},  who completely classified harmonious abelian groups and showed that all groups of odd order are harmonious. Wang and Leonard \cite{WL00} have  shown that dicyclic groups are also harmonious.

Inspired by the fact that harmonious sequences corresponds to the vertex sequences of a rainbow Hamilton cycles in $\overrightarrow{K}_n(L_G)$, we introduce the notion of H2-harmonious sequences to study Hamilton cycles in $K_{n,n}(L_G)$. Notice that  we could define $K_{n,n}(G) :=K_{n,n}(L_G)$ without reference to latin squares: define the bipartition $(R,C)$ of $K_{n,n}$ by $R = \left\{[g]_R \mid g \in G\right\}$ and $C = \{[g]_C \mid g \in G\}$ and label the edge $[g]_C[h]_R$ with the group element $gh$. Saving a formal definition for Chapter \ref{ch:h2terrace}, we can here define a \defn{H2-harmonious sequence} of $G$ as the sequence of group elements given by removing the brackets from the vertex sequence of a Hamilton 2-plex in $K_{n,n}(G)$. Notice that, by the discussion in Section \ref{sec:introconj}, $\mathbb{Z}_2 \times \mathbb{Z}_2$ is not H2-harmonious. Moreover, in light of Conjecture \ref{conj:main}, we believe that all other groups are H2-harmonious. 


The next two chapters of this thesis study group-based latin squares using the language just introduced. In Chapter \ref{ch:jcd}, we prove that every group has a near complete mapping. In Chapter \ref{ch:h2terrace}, we establish the existence of H2-harmonious sequences for many families of groups, including all abelian groups besides $\mathbb{Z}_2 \times \mathbb{Z}_2$ and all groups of odd order. We then turn to purely combinatorial questions in Chapter \ref{ch:varplex}, using tools from extremal and probabilistic combinatorics to establish the existence of $(k,\ell)$-plexes and Hamilton $(2,\ell)$-plexes in various families of combinatorial arrays. 










%\vspace{\topsep}
%\begin{proposition}
%Latin square graphs are strongly regular
%\end{proposition}
































   






\chapter{Every group has a near complete mapping}\label{ch:jcd}

The goal of this chapter is rather transparent: we provide a proof of its titular statement. Our proof is given in the language of graph theory, utilizing relatively elementary structural results for finite groups to show that all group-based latin square graphs have large independent sets. Although our argument depends upon Theorem \ref{thm:bigequiv}, it is independent of---and indeed offers a new proof for---the theorem of Hall \cite{Ha52} that all abelian groups have near complete mappings. The work in this chapter has already been published in \cite{GH20}, where the main result is stated as follows.

\begin{theorem}\label{thm:jcdmain}
Every group-based latin square has a near transversal.
\end{theorem}

It is worth noting that Theorem \ref{thm:jcdmain} can be trivially extended to a slightly wider class of latin squares. The existence of a near transversal is not affected by relabelling the rows, columns, or symbols of $L$, nor is it affected by permuting the roles played by rows, columns, and symbols. Thus, every latin square which is \gls{main class equivalent}  to a group-based latin square has a near transversal by Theorem \ref{thm:jcdmain}. 



 
 
 \section{Reduction to a question about induced subgraphs}\label{sec:nearproof}

%


Recall the definition of latin square graphs from Section \ref{sec:intrograph}.  In particular, in the graph $\Gamma(L)$ we have $(r,c) \sim (s,d)$ if and only if one of $r=s$, $c=d$, or $L_{r,c} = L_{s,d}$ holds. This defines a natural tripartition of $\Gamma(L)$'s edges into, respectively, \defn{row edges}, \defn{column edges}, and \defn{symbol edges}.  
%For the sake of simplicity, we refer to the latin square graph $\Gamma(L(G))$ as \emph{the latin square graph of $G$}, and denote it by $\Gamma(G)$. 
Moreover, recall that there is a bijective correspondence between near transversals of $L$ and independent sets of size $n-1$ in $\Gamma(L)$.

%For any undefined graph-theoretic terms we refer the reader to \cite{BondyMurty}.

Given graphs $\Gamma = (V,E)$ and $\Gamma^\prime=(V^\prime,E^\prime)$, the \defn{disjoint union} of $\Gamma$ and $\Gamma^\prime$ is 
%
$\Gamma+\Gamma^\prime:=(V \sqcup V^\prime, E \sqcup E^\prime).$
%
For a positive integer $k$, we write $k\Gamma$ for the disjoint union of $k$ copies of $\Gamma$. Given
a set $W \subseteq V$, the \defn{induced subgraph} of $\Gamma$ with respect to $W$ is 
%
\[\Gamma[W] := (W,\{e \in E: e \subseteq W\}).\]
%
The \defn{M\"{o}bius ladder} of order $2n$, denoted $M_n$, is the cubic graph formed from a cycle of length $2n$---referred to as the \emph{rim} of $M_n$---by adding $n$ edges, one joining each pair of vertices at distance $n$ in the initial cycle. 
%We refer to the initial cycle as the \emph{rim} of $M_n$, and refer to the edges between opposite vertices in the rim as \emph{rungs}. 
The \defn{prism graph} of order $2n$, denoted $Y_n$, is the Cartesian product of a cycle of length $n$ and an edge; in other words, $Y_n$ is obtained from two copies of the $n$-cycle by adding edges between corresponding vertices.


\begin{figure}[t]
\centering
\includegraphics{lambda18}
\caption[The graph used to prove Theorem \ref{thm:jcdmain}]{The graph $\Lambda_{18,3} $ }
\label{fig:graph}
\end{figure}

\begin{lemma}\label{lemma:JCD}
Let $L$ be a group-based latin square of even order $n$, let $k$ be the greatest power of 2 dividing $n$, and let $l:=n/k$. 
%
%Let $k$ be a power of 2 satisfying $k \geq 2$, let $l$ be a positive odd integer, let $G$ be a group of order $kl$, and let $\Gamma := \Gamma(G)$.
If $L$ does not have a transversal, then there is a positive integer $m$ dividing $l$ such that $\Gamma(L)$ has an induced subgraph isomorphic to 
%
\[\Lambda_{n,m} := M_{km} + \left(\frac{l-m}{2}\right)Y_{2k} .\]
\end{lemma}
%

See Figure \ref{fig:graph} for an example of the graph $\Lambda_{n,m}$. Though an induced copy of  $\Lambda_{n,m}$ in $\Gamma(L_G)$ does not necessarily correspond to a 2-plex of $L$, the proof of Lemma \ref{lemma:JCD} finds a 2-plex inducing $\Lambda_{n,m}$. We now show that the challenge of proving Theorem \ref{thm:jcdmain} can be passed on to Lemma \ref{lemma:JCD}.

\begin{proof}[Proof of Theorem \ref{thm:jcdmain}]
Let $L$ be a group-based latin square of order $n$. We may assume $L$ does not have a transversal. As first shown in \cite{Br44}, this implies $n$ is even. We may therefore apply Lemma \ref{lemma:JCD} to find an induced copy of $\Lambda_{n,m}$ in $\Gamma(L)$. 
%
Because the $\left(2k(l-m)\right)$-vertex graph $\left(\frac{l-m}{2}\right)Y_{2k}$ is bipartite, it contains an independent set of size at least $k(l-m)$. Moreover, one can find an independent set of size $km-1$ in $M_{km}$ by greedily selecting vertices in cyclic order around its rim. Thus $\Lambda_{n,m}$ contains an independent set of size $(l-m)k + km -1 = n-1$ which corresponds to a near transversal of $L$.
%
\end{proof}


%
%
%
%
%
%
%
%
%
%
%
%\section{Latin square graphs}



%
%
%
%
%
%
%
%
%
%

\section{Proof of Lemma \ref{lemma:JCD}}\label{mostwork}


Let $G$ be a group of order $n$ with identity element $1$ and let $\Syl_2(G)$ denote the isomorphism class of $G$'s Sylow 2-subgroups.
%
%
It is a nice algebraic exercise to check that, if $H$ is a group of odd order, then the identity map is a complete mapping. Combining this with Beals, Gallian, Headley, and Jungreis's theorem that all groups of odd order are harmonious, we obtain the following theorem.
%
\begin{theorem}[\cite{BGHJ91}]\label{thm:harmonious}
For every group $H$ of odd order $m$, there exists an ordering $H = \{h_1,h_2,\ldots,h_{m}\}$ such that, taking indices modulo $m$, both $h_i \mapsto h_{i+1}$ and $h_i \mapsto h_i$ are complete mappings.
\end{theorem}

Given two subsets $X_1,X_2 \subseteq G$ the \defn{product set} of $X_1$ by $X_2$ is
%
\[X_1X_2 := \{x_1x_2\,:\, x_1 \in X_1, \, x_2 \in X_2\}.\]
%
%Note that it is possible that $|X_1X_2| \neq |X_1||X_2|$; some elements may have multiple representations in the underlying set of products. 
We write $Xy$ for the product set $X\{y\}$. Let $K$ be a subgroup of $G$ and let $H$ be a normal subgroup of $G$. We say that $G$ is \defn{the semidirect product} of $K$ and $H$, written $G =  K \ltimes H$,  if $K \cap H = \{1\}$, $KH = G$, and $|G| = |K||H|$.
%
The following was noted in \cite{HP55} as following from a result of Burnside.
%
\begin{lemma}[Burnside, \cite{HP55}]\label{lemma:burnside}
Let $G$ be a finite group and let $K$ be a Sylow 2-subgroup of $G$. If $K$ is cyclic and nontrivial, then there is a normal subgroup of odd order $H \triangleleft G$ such that 
%
\[G=  K \ltimes H.\]
\end{lemma}
%
%

These are all the group-theoretic preliminaries we need to prove that, for every group $G$ with no complete mapping, $\Gamma(L_G)$ contains an induced subgraph which is the disjoint union of one M\"{o}bius ladder and several bipartite prisms.



\begin{proof}[Proof of Lemma \ref{lemma:JCD}]
Let $L$ be a latin square based on a group $G$ of order $n=kl$, where $k\geq 2$ is a power of 2 and $l$ is odd. Moreover, suppose $G$ does not have a complete mapping. Theorem \ref{thm:bigequiv} tells us that $\Syl_2(G) = \mathbb{Z}_k$. It then follows from Lemma \ref{lemma:burnside} that $G$ contains a normal subgroup $H$ of order $l$ and an element $b$ of order $k$ such that 
%
\[G = \text{\acrshort{b}} \ltimes H.\]

 Let $a:= b^{k/2}$. As $H \triangleleft G$ and $a$ has order 2, $H$ has an automorphism 
 %
 \[\alpha: h \mapsto aha.\]
 %
  %
 Let
 %
 \[H^\ast := \{ h \in H \,:\, \alpha(h) = h\}\]
 %
  and observe that $H^\ast$ is a subgroup of $H$. Let $m:=|H^\ast|$. As $m$ divides $l$ and $l$ is odd, $m$ is odd. By Theorem \ref{thm:harmonious}, there is an ordering $H^\ast=\{h_1,h_2,\ldots,h_{m}\}$ for which the map $h_i \mapsto h_{i+1}$  is a complete mapping. Here and throughout the rest of this proof, indices are taken modulo $m$.  


 
Let $\Gamma:= \Gamma(L)$. Toward defining a set $W \subseteq V(\Gamma)$ which induces $\Lambda_{n,m}$, let
%
\begin{align*} 
T_1 &:= \left\{ \left(b^ih_i,h_ib^i\right) \,:\, i \in [km] \right\}, \\
 T_2 &:=  \left\{ \left(b^ih_i,h_{i+1}b^{i+1}\right) \,:\, i \in [km] \right\},  \text{ and } \\
 T \,&:=T_1 \cup T_2. 
\end{align*}
%
Furthermore, let $F := H \setminus H^\ast$ and let
%
\begin{align*}
U_1 &:= \left\{ \left(b^if,fb^i\right) \,:\, f \in F,\, i \in [k]\right\},\\
U_2 &:= \left\{ \left(b^if,fb^{i+1}\right) \,:\, f \in F,\, i \in [k]\right\}, \text{ and }  \\
U\,  &:= U_1 \cup U_2.
\end{align*}
%
Finally, let
%
\[ W:=T \cup U.\]
%
We show the induced subgraph $\Gamma[W] \cong \Lambda_{n,m}$ via the following  three claims. 

\begin{figure}[t]
\centering
\newcommand{\overred}[1]{\textcolor{red}{\mathbf{\underline{#1}}}}
\newcommand{\underblue}[1]{\textcolor{blue}{{\mathbf{#1}}}}
\newcommand{\blank}[1]{\textcolor{white}{#1}}
\def\arraystretch{1.2}
\adjustbox{scale=0.77}{
\begin{tabular}
{|@{\hspace{2pt}}c@{\hspace{2pt}}|@{\hspace{2pt}}c@{\hspace{2pt}}|@{\hspace{2pt}}c@{\hspace{2pt}}|@{\hspace{2pt}}c@{\hspace{2pt}}|@{\hspace{2pt}}c@{\hspace{2pt}}|@{\hspace{2pt}}c@{\hspace{2pt}}||@{\hspace{2pt}}c@{\hspace{2pt}}|@{\hspace{2pt}}c@{\hspace{2pt}}|@{\hspace{2pt}}c@{\hspace{2pt}}|@{\hspace{2pt}}c@{\hspace{2pt}}|@{\hspace{2pt}}c@{\hspace{2pt}}|@{\hspace{2pt}}c@{\hspace{2pt}}||@{\hspace{2pt}}c@{\hspace{2pt}}|@{\hspace{2pt}}c@{\hspace{2pt}}|@{\hspace{2pt}}c@{\hspace{2pt}}|@{\hspace{2pt}}c@{\hspace{2pt}}|@{\hspace{2pt}}c@{\hspace{2pt}}|@{\hspace{2pt}}c@{\hspace{2pt}}|}
  \hline
$\overred{1}$&$\overred{bc}$&$c^2$&$b$&$c$&$bc^2$&$d$&$d^2$&$cd$&$cd^2$&$c^2d$&$c^2d^2$&$bd^2$&$bd$&$bcd^2$&$bcd$&$bc^2d^2$&$bc^2d$\\\hline
$bc$&$\overred{c^2}$&$\overred{b}$&$c$&$bc^2$&1&$bcd$&$bcd^2$&$bc^2d$&$bc^2d^2$&$bd$&$bd^2$&$cd^2$&$cd$&$c^2d^2$&$c^2d$&$d^2$&$d$\\\hline
$c^2$&$b$&$\overred{c}$&$\overred{bc^2}$&1&$bc$&$c^2d$&$c^2d^2$&$d$&$d^2$&$cd$&$cd^2$&$bc^2d^2$&$bc^2d$&$bd^2$&$bd$&$bcd^2$&$bcd$\\\hline
$b$&$c$&$bc^2$&$\overred{1}$&$\overred{bc}$&$c^2$&$bd$&$bd^2$&$bcd$&$bcd^2$&$bc^2d$&$bc^2d^2$&$d^2$&$d$&$cd^2$&$cd$&$c^2d^2$&$c^2d$\\\hline
$c$&$bc^2$&1&$bc$&$\overred{c^2}$&$\overred{b}$&$cd$&$cd^2$&$c^2d$&$c^2d^2$&$d$&$d^2$&$bcd^2$&$bcd$&$bc^2d^2$&$bc^2d$&$bd^2$&$bd$\\\hline
$\overred{bc^2}$&1&$bc$&$c^2$&$b$&$\overred{c}$&$bc^2d$&$bc^2d^2$&$bd$&$bd^2$&$bcd$&$bcd^2$&$c^2d^2$&$c^2d$&$d^2$&$d$&$cd^2$&$cd$\\\hline\hline
$d$&$bcd^2$&$c^2d$&$bd^2$&$cd$&$bc^2d^2$&$\underblue{d^2}$&1&$cd^2$&$c$&$c^2d^2$&$c^2$&$\underblue{bd}$&$b$&$bcd$&$bc$&$bc^2d$&$bc^2$\\\hline
$d^2$&$bcd$&$c^2d^2$&$bd$&$cd^2$&$bc^2d$&1&$\underblue{d}$&$c$&$cd$&$c^2$&$c^2d$&$b$&$\underblue{bd^2}$&$bc$&$bcd^2$&$bc^2$&$bc^2d^2$\\\hline
$cd$&$bc^2d^2$&$d$&$bcd^2$&$c^2d$&$bd^2$&$cd^2$&$c$&$\underblue{c^2d^2}$&$c^2$&$d^2$&1&$bcd$&$bc$&$\underblue{bc^2d}$&$bc^2$&$bd$&$b$\\\hline
$cd^2$&$bc^2d$&$d^2$&$bcd$&$c^2d^2$&$bd$&$c$&$cd$&$c^2$&$\underblue{c^2d}$&1&$d$&$bc$&$bcd^2$&$bc^2$&$\underblue{bc^2d^2}$&$b$&$bd^2$\\\hline
$c^2d$&$bd^2$&$cd$&$bc^2d^2$&$d$&$bcd^2$&$c^2d^2$&$c^2$&$d^2$&1&$\underblue{cd^2}$&$c$&$bc^2d$&$bc^2$&$bd$&$b$&$\underblue{bcd}$&$bc$\\\hline
$c^2d^2$&$bd$&$cd^2$&$bc^2d$&$d^2$&$bcd$&$c^2$&$c^2d$&1&$d$&$c$&$\underblue{cd}$&$bc^2$&$bc^2d^2$&$b$&$bd^2$&$bc$&$\underblue{bcd^2}$\\\hline\hline
$bd$&$cd^2$&$bc^2d$&$d^2$&$bcd$&$c^2d^2$&$\underblue{bd^2}$&$b$&$bcd^2$&$bc$&$bc^2d^2$&$bc^2$&$\underblue{d}$&1&$cd$&$c$&$c^2d$&$c^2$\\\hline
$bd^2$&$cd$&$bc^2d^2$&$d$&$bcd^2$&$c^2d$&$b$&$\underblue{bd}$&$bc$&$bcd$&$bc^2$&$bc^2d$&1&$\underblue{d^2}$&$c$&$cd^2$&$c^2$&$c^2d^2$\\\hline
$bcd$&$c^2d^2$&$bd$&$cd^2$&$bc^2d$&$d^2$&$bcd^2$&$bc$&$\underblue{bc^2d^2}$&$bc^2$&$bd^2$&$b$&$cd$&$c$&$\underblue{c^2d}$&$c^2$&$d$&1\\\hline
$bcd^2$&$c^2d$&$bd^2$&$cd$&$bc^2d^2$&$d$&$bc$&$bcd$&$bc^2$&$\underblue{bc^2d}$&$b$&$bd$&$c$&$cd^2$&$c^2$&$\underblue{c^2d^2}$&1&$d^2$\\\hline
$bc^2d$&$d^2$&$bcd$&$c^2d^2$&$bd$&$cd^2$&$bc^2d^2$&$bc^2$&$bd^2$&$b$&$\underblue{bcd^2}$&$bc$&$c^2d$&$c^2$&$d$&1&$\underblue{cd}$&$c$\\\hline
$bc^2d^2$&$d$&$bcd^2$&$c^2d$&$bd^2$&$cd$&$bc^2$&$bc^2d$&$b$&$bd$&$bc$&$\underblue{bcd}$&$c^2$&$c^2d^2$&1&$d^2$&$c$&$\underblue{cd^2}$\\\hline
\end{tabular}
}%
\caption[The construction of Lemma \ref{lemma:JCD} for the group $S_3 \times \mathbb{Z}_3$]{The \gls{cayley table} of $S_3 \times \mathbb{Z}_3= \langle b,c,d \,|\, b^2=c^3=d^3 = 1, bc = cb, bd = d^2b\rangle$ with $\overred{T}$ and $\underblue{U}$ highlighted. Here $k=2$, $H=\langle c,d\rangle$, and $H^\ast = \langle c \rangle$, with $H^\ast$ ordered by $h_i = c^i$. The first six rows and columns are indexed by $\langle b \rangle H^\ast$ and the main diagonal is $T_1 \cup U_1$.}\label{figure}
\end{figure}


\begin{claim}\label{TandU}
$T \cap U =  \emptyset$ and there is no edge between $T$ and $U$.
\end{claim}

As $G = \langle b \rangle \ltimes H$, every element of $G$ has a unique representation of the form $g = b^ih$ for $i \in [k]$ and $h \in H$. Therefore, the definition of $F$ implies
%
\begin{equation} \label{Hpartition} \langle b \rangle H^\ast \cap \langle b \rangle F = \emptyset.\end{equation}
%
But for every $(t,s) \in T$ and every $(u,v) \in U$ we have $t \in \langle b \rangle H^\ast$ and $ u \in \langle b \rangle F$. Thus $T \cap U = \emptyset$ and there are no row edges between $T$ and $U$.


As $H \triangleleft G$ we have $b Hb^{-1} = H$. 
%
Moreover, as $a = b^{k/2}$, for every $h \in H^\ast$ we have $\alpha(bhb^{-1}) = bhb^{-1}$, so $bhb^{-1} \in H^\ast$. Thus
 %
 \begin{equation}\label{normalizer}
b H^\ast b^{-1} = H^\ast.
 \end{equation}
 %
It then follows from the definition of $F$ that
%
\begin{equation}\label{sgcommute}
bF b^{-1}= F
 \end{equation}
 %
and, as the identity map is a complete mapping of both $H$ and $H^\ast$,
  %
  \begin{equation}\label{sqcomp}
  f \mapsto f^2 \text{ is a permutation of  }F.
  \end{equation}
  %
  Thus for every $(u,v) \in U$, both $v$ and $uv$ are in $\langle b \rangle F$. But \eqref{normalizer} tells us that for every $(t,s) \in T$, both $s$ and $ts$ are in $\langle b \rangle H^\ast$. It then follows from \eqref{Hpartition} that there are no column edges and no symbol edges between $T$ and $U$.




\begin{claim}\label{prisms}
$\Gamma[U]$ consists of $\frac{l-m}{2}$ disjoint copies of $Y_{2k}$. 
\end{claim}

Observe that, when enumerating the vertices in $U$, every element of $\langle b\rangle F$ occurs exactly twice as a first coordinate and, by \eqref{sgcommute}, exactly twice as a second coordinate. Thus, each vertex in the induced subgraph $\Gamma[U]$ is incident to exactly one row edge and exactly one column edge, so that the row and column edges in $\Gamma[U]$ form a 2-factor (of $\Gamma[U]$). Specifically, they form $l-m$ disjoint $2k$-cycles $\{C_f\,:\, f \in F\}$, with each $C_f$ defined by the vertex-sequence
%
\begin{equation*}
(f,f), (f,fb), (bf,fb), \left(bf,fb^2\right), \ldots, \left(b^{k-1}f,fb^{k-1}\right), \left(b^{k-1}f,f\right).
\end{equation*}
%
%
%

It follows from the definitions of $H^\ast$ and $F$ that $\alpha|_F$ is a fixed-point free involution. Thus, to establish Claim \ref{prisms} it suffices to show that for every $i,j \in [k]$, every $f,h \in F$, and every $\varepsilon,\delta \in \{0,1\}$, the vertices $(b^if,fb^{i+\varepsilon})$ and $(b^jh,h b^{j+\delta})$ are joined by a symbol edge if and only if  $j \equiv i + k/2 \pmod{k}$, $h = \alpha(f)$, and $\varepsilon = \delta$.

The ``if" direction of this equivalence follows directly from the definition of $\alpha$. For the converse direction we assume %
\[ b^if^2b^{i+\varepsilon} = b^jh^2b^{j+\delta}\]
%
and, as latin square graphs are loopless, $(b^if,fb^{i+\varepsilon}) \neq (b^jh,h b^{j+\delta})$.
It follows from \eqref{sgcommute} and \eqref{sqcomp} that
%
%
\[ b^if^2b^{i+\varepsilon} \in b^{2i+\varepsilon}F \text{ and } b^jh^2b^{j+\delta} \in b^{2j+\delta}F.\]
 %
 Thus $\varepsilon = \delta$ and $|i-j| \in \{0,k/2\}$. 
 
Now if $i=j$, then $b^if^2b^{i+\varepsilon} = b^ih^2 b^{i+\varepsilon}$ and \eqref{sqcomp} implies $f=h$, contradicting the fact that $(b^if,fb^{i+\varepsilon})\neq(b^jh,h b^{j+\delta}) $. It follows that $j$ is the unique element of $[k]$ satisfying $j \equiv i+k/2 \pmod{k}$. Thus
%
\[b^ih^2b^{i+\varepsilon} = b^{i+k/2} f^2 b^{i+\varepsilon+k/2} = b^i \alpha(f^2) b^{i+\varepsilon},\]
%
so $h^2 = \alpha(f^2) = (\alpha(f))^2$ and \eqref{sqcomp} implies $h = \alpha(f)$.  




\begin{claim}\label{mobius}
$\Gamma[T]$ is isomorphic to $M_{km}$
\end{claim}

Observe that, when enumerating the vertices in $T$, every element of $\langle b\rangle H^\ast$ occurs exactly twice as a first coordinate and, as $\langle b \rangle$ and $H^\ast$ commute by \eqref{normalizer}, exactly twice as a second coordinate. Thus, as is the case for $\Gamma[U]$, each vertex in $\Gamma[T]$ is incident to exactly one row edge and exactly one column edge. Unlike in $\Gamma[U]$, the row and column edges of $\Gamma[T]$ form a single cycle of length $2mk$. Indeed, as $m$ is odd and $|b|$ is a power of 2,
%
\[ (h_1,h_1), (h_1,h_2b),(bh_2,h_2b),\ldots, (b^{k-1}h_{m},b^{k-1}h_{m}), (b^{k-1}h_{m},h_0)  \]
%
is a \gls{Hamilton cycle} in $\Gamma[T]$ which contains all of $\Gamma[T]$'s row and column edges. 

To establish Claim \ref{mobius} it suffices to show that for every $i,j \in [km]$ and every $\varepsilon,\delta\in\{0,1\}$, the vertices $ (b^ih_i,h_{i+\varepsilon}b^{i+\varepsilon})$ and $(b^jh_j,h_{j+\delta}b^{j+\delta})$ are joined by a symbol edge  in $\Gamma[T]$  if and only if $i \equiv j + \frac{k}{2}m \pmod{km}$ and $\varepsilon = \delta$. 

Indeed if $i \equiv  j + \frac{k}{2}m\pmod{km}$, then $i \equiv j \pmod{m}$ and, as $m$ is odd, $i \equiv j + k/2 \pmod{k}$. Together with $\varepsilon  = \delta$,  as well as Theorem \ref{thm:harmonious} and the definition of $H^\ast$, this implies
%
\[ b^ih_ih_{i+\varepsilon}b^{i+\varepsilon} = b^jah_jh_{j+\delta}ab^{j+\delta} = b^jh_jh_{j+\delta}b^{j+\delta},\]
%
which establishes the ``if" direction of the desired equivalence. 

For the converse direction consider $ (b^ih_i,h_{i+\varepsilon}b^{i+\varepsilon}), (b^jh_j,h_{j+\delta}b^{j+\delta}) \in T$  and assume that the group elements defining this pair of distinct vertices satisfy
%
\[ b^ih_ih_{i+\varepsilon}b^{i+\varepsilon} = b^jh_jh_{j+\delta}b^{j+\delta}.\]
%
From \eqref{normalizer} we see that
%
\[b^ih_ih_{i+\varepsilon}b^{i+\varepsilon} \in b^{2i+\varepsilon}H^\ast \text{ and } b^jh_jh_{j+\delta}b^{j+\delta} \in b^{2j+\delta}H^\ast.\]
%
Thus $\varepsilon = \delta$ and $i \equiv j \pmod{k/2}$. Now $b^j \in \{b^i,b^{i+k/2}\}$ and as $H^\ast$ is pointwise fixed by the automorphism $\alpha: h \mapsto b^{k/2} h b^{k/2}$,  both possible values of $b^j$ yield $h_ih_{i+\varepsilon} = h_jh_{j+\varepsilon}$. Theorem \ref{thm:harmonious} then implies $h_i = h_j$, so $i \equiv j \pmod{m}$. 

Suppose $b^j = b^i$, which is equivalent to $i \equiv j \pmod{k}$. As $\gcd(k,m) = 1$ and $i,j \in [km]$, this implies $i=j$, contradicting the fact that $(b^ih_i,h_{i+\varepsilon}b^{i+\varepsilon})$ and $(b^jh_j,h_{j+\delta}b^{j+\delta})$ are distinct vertices. Therefore $j \equiv i+k/2 \pmod{k}$ and, as $k/2$ and $m$ are coprime, we conclude that $i \equiv j + \frac{k}{2}m \pmod{km}$. 
%
\end{proof}

\section{Toward a sturdier theory of near complete mappings}\label{sec:nextsteps}


The proof of Theorem \ref{thm:bigequiv} relies upon the classification of finite simple groups, a theorem whose sprawling proof covers hundreds of articles. There is a distinct possiblity that this proof contains a mistake. Indeed, Peter Cameron \cite{CameronBlog} has stated that  ``the discovery of a serious mistake in the proof [of the classification of finite simple groups] is on the cards.'' Because we rely upon Theorem \ref{thm:bigequiv} to prove Theorem \ref{thm:jcdmain}, there is reason to worry that our theorem may one day be reduced to the statement: every group with nontrivial cyclic Sylow 2-subgroups has a near complete mapping.

One way out of this problem would be a study of near complete mappings in groups which have complete mappings. An interesting question in this direction was raised by Evans in \cite{EvansBook}. A partial transversal is \defn{non-extendable} if it is not contained in any larger partial transversal. It is straightforward to check that the near transversals induced  by sequencings of groups are non-extendible. The following conjecture was noted by Evans \cite[p.\! 470]{EvansBook} as a weak version of Keedwell's conjecture \cite{Ke83} that every nonabelian group of order at least 10 is sequenceable.
%
\begin{conjecture}[\cite{EvansBook}]\label{keedwell}
For every finite non-abelian group $G$, the latin square $L_G$ has a non-extendable near transversal.
\end{conjecture}
%
If true, Conjecture \ref{keedwell} cannot be extended to any abelian groups: an old result of Paige \cite{Pa47} implies that, if $G$ is abelian, then $L_G$ has either a transversal or a non-extendable near transversal, but it cannot have both. On the other hand, it is known that, for every integer $k \geq 1$, the \gls{cayley table} of the dihedral group $D_{4k+2}$ has both a transversal and a non-extendable near transversal \cite{Is90}. 

We have just shown that Conjecture \ref{keedwell} holds for those non-abelian groups which do not have complete mappings. Perhaps our techniques can be used to find maximal independent sets of size $n-1$ in other latin square graphs based upon non-abelian groups, but additional insight would be needed for such a result. As far as we know, Conjecture \ref{keedwell} has not been attacked directly. However, many partial results are known due to its connection to sequenceable groups. 

There is also hope that another way out of our dependance on the classification of finite simple groups is possible. A recent paper of Eberhard, Manners, and Mrazovi\'{c} \cite{EMM20plus} uses Fourier analytic techniques to prove that Theorem \ref{thm:bigequiv} holds for all groups of order at least $10^5$.  This may be enough for Theorem \ref{thm:bigequiv} to survive any problems with the proof of the classification of finite simple groups. 

The main result of \cite{EMM20plus} is an asymptotically exact enumeration of the complete mappings of any group $G$ with trivial or non-cyclic Sylow 2-subgroups. This raises the question of whether one could prove a similar result concerning near complete mappings. As near complete mappings are obtained from complete mappings by ignoring an element of the domain, the main result of \cite{EMM20plus} gives a lower bound for the number of near complete mappings in sufficiently large groups with trivial or non-cyclic Sylow 2-subgroups. Perhaps the techniques we used to prove Theorem \ref{thm:jcdmain} could be extended to find a lower bound for the number of near complete mappings in groups with nontrivial cyclic Sylow 2-subgroups. 














































\chapter{H2-harmonious groups}\label{ch:h2terrace}

Continuing our study of group-based latin squares, we turn now to the question of Hamilton 2-plexes. As noted in Section \ref{sec:introgroup}, this question can be restated in terms of a novel type of group sequencing for which we now give a full, formal definition. Throughout this chapter, we will use indices which ``wrap-around,'' so that if $g_{m+1}$ is undefined, then $g_{m+1}=g_1$.

\begin{definition}\label{def:h2seq}
Let $G$ be a group of order $n$. An \defn{H2-harmonious sequence} of $G$ is a sequence $S~=~g_1,g_2,\ldots,g_{2n} \in G^{2n}$  such that every element of $G$ appears
 \renewcommand{\labelenumi}{(\alph{enumi})}
 \begin{enumerate}
\item  once in the subsequence $e(S) := \left(g_{2i}\right)_{i=1}^{n}$,
\item  once in the subsequence $o(S) := \left(g_{2i-1}\right)_{i=1}^n$, and
\item twice in the sequence $\pi(S) := \left(g_{2i}\,g_{2i-1} , g_{2i}\, g_{2i+1} \right)_{i=1}^n$.
\end{enumerate}
A group which has an H2-harmonious sequence is called \defn{H2-harmonious}.
\end{definition}

An H2-harmonious sequence $S$ of $G$ corresponds to the vertex-sequence of a Hamilton 2-plex in $K_{n,n}(G)$ by letting $e(S)$ and $o(S)$ denote, respectively, to the row vertices and the column vertices. Because $L_{\mathbb{Z}_2 \times \mathbb{Z}_2}$ is the only latin square of order less than 5 which does not have a Hamilton 2-plex, we have the following special case of Conjecture \ref{conj:main}.

\begin{conjecture}
Every finite group except $\mathbb{Z}_2 \times \mathbb{Z}_2$ is H2-harmonious.
\label{conj:groupmain}\end{conjecture}

The goal of this chapter is to offer evidence in support of Conjecture \ref{conj:groupmain}. Using ideas similar to those presented in the previous chapter, it will be straightforward to show that all groups of odd order and all groups with no \gls{complete mapping} are H2-harmonious. It will take a bit more work to show that all dihedral groups---besides the (debatably) dihedral group of order 4---are H2-harmonious. Our most significant result, though, is a resolution of the special case of Conjecture \ref{conj:groupmain} for abelian groups.
%
\begin{theorem}\label{thm:h2abel}
Every finite abelian group except $\mathbb{Z}_2 \times \mathbb{Z}_2$ is H2-harmonious.
\end{theorem}
%
We begin this chapter with a  few basic results which apply to general (not necessarily abelian) groups. We then proceed with the proof of Theorem \ref{thm:h2abel}. We end with a list of computer-generated sequencings for all groups of order less than 32 which were not covered by previously proven theorems.  






\section{Basic results for general groups}

When first encountering a claim like Conjecture \ref{conj:groupmain}, a natural first step would be to search for an H2-harmonious sequence for $\mathbb{Z}_n$. This turns out to be a rather simple exercise, but we will enshrine it as a proposition to use as the base case of future proofs by induction.

\begin{proposition}
Every finite cyclic group is H2-harmonious.
\label{prop:h2cyc}\end{proposition}

\begin{proof}
Letting $a$ denote the generator of a cyclic group $G$ of order $n$. To see that
%
\[S := 1,1,a,a,a^2,a^2,\ldots,a^{n-1},a^{n-1}, \]
%
is an H2-harmonious sequence, observe that $\pi(S) = (a^i)_{i=0}^{2n-2}$, $a^{n-1}$.
\end{proof}

That a similar construction works for all groups of odd order is far from obvious. Indeed, our short proof of this fact uses a nontrivial result of Beals et al.\! \cite{BGHJ91}. Having already stated that result in Theorem \ref{thm:harmonious}, the following is essentially a corollary. 


\begin{theorem}
Every group of odd order is H2-harmonious.
\label{thm:h2odd}
\end{theorem}

\begin{proof}
Given a group $G$ of odd order, let $ g_1,g_2,\ldots,g_{n}$ be the \gls{harmonious sequence} of $G$ guaranteed to exist by Theorem \ref{thm:harmonious}.  This means that $g_i \mapsto g_i$ and $g_i \mapsto g_{i+1}$ are both \gls{complete mapping}s. That
%
$S :=  g_1,g_1,g_2,g_2,\ldots,g_{n},g_{n}$
%
is an H2-harmonious sequence then follows from the fact that $\pi(S)$ is obtained by interleaving $\left(g_i^2\right)_{i=1}^n$ and $\left(g_ig_{i+1}\right)_{i=1}^n$.
\end{proof}

Another result concerning H2-harmonious sequences which we obtain by leaning heavily upon the extensive literature concerning \gls{complete mapping}s is the following.

\begin{theorem}\label{thm:h2nonHP}
Every finite group with no complete mapping is H2-harmonious.
\end{theorem}

The proof of Theorem \ref{thm:h2nonHP} hides an even greater mass of deep group-theoretic work than the proof of Theorem \ref{thm:h2odd}; as stated, Theorem \ref{thm:h2nonHP} depends upon the monumental Theorem \ref{thm:bigequiv}, and therefore upon the classification of finite simple groups. Of course, we could avoid this burdensome dependence by stating Theorem \ref{thm:h2nonHP} as: every group with nontrivial cyclic \gls{Sylow 2-subgroup}s is H2-harmonious. However, the strongest possible statement pairs nicely with the following account of the relevant combinatorial machinery. Though fairly elementary, this result will prove to be a powerful tool in the construction of H2-harmonious sequences. A group $G$ is an \defn{extension} of  $N$ by $Q$ if $G$ has a normal subgroup $N_0 \triangleleft G$ which is isomorphic to $N$ and the quotient $G/N_0$ is isomorphic to $Q$. Moreover, throughout this chapter we will use the term \defn{permutation of $G$} to refer to a sequence $\left( g_i \right)_{i=1}^{|G|}$ in which every element of $G$ appears.

\begin{lemma}\label{lemma:h2util}
If a finite group $G$ is an \gls{extension} of an H2-harmonious group by a group of odd order, then $G$ is H2-harmonious.
\end{lemma}

\begin{proof}
Let $N \triangleleft G$ denote the given normal subgroup of odd order. By hypothesis, there are ordered sets of coset representatives  for $N$ in $G$, say $r_1,r_2,\ldots,r_\ell$ and $c_1,c_2,\ldots,c_\ell$, such that 
%
$ c_1N,r_1N\ldots,c_\ell N,r_\ell N$
%
is an H2-harmonious sequence for $G/N$. Moreover, via the assumption that $|N|$ is odd and Theorem \ref{thm:harmonious}, let $a_1,a_2,\ldots,a_m$ be a harmonious sequence of $N$. We claim that
%
\[ S := \left(\left(a_jc_i,r_ia_j\right)_{i=1}^{\ell}\right)_{j=1}^m\]
%
is an H2-harmonious sequence of $G$. Indeed, it is straightforward to check that $o(S)=\left(\left( a_jc_i\right)_{i=1}^\ell\right)_{j=1}^m$ and $e(S)=\left(\left( r_ia_j\right)_{i=1}^\ell\right)_{j=1}^m$  are both permutations of $G$.

To see that $\pi(S)$ has two copies of every element of $G$, we begin by observing that every element of $N$ has a unique representation of the form $a_j^2$ and a unique representation of the form $a_ja_{j+1}$ for $j \in [m]$. Therefore, for all $i \in [m]$, every element of the coset $r_ic_iN$ has a unique representation of the form $r_ia_j^2c_i$ and every element of the coset $r_ic_{i+1}N$ has a unique representation of the form $r_ia_j^2c_{i+1}$. Moreover, every element of the coset $r_\ell c_1 N$ has a unique representation of the form $r_\ell a_ja_{j+1} c_1$. It then follows that the sequence
%
%\begin{align*}
%\pi(S) =  &(r_iq_1^2c_i,r_iq_1^2c_{i+1})_{i=1}^{\ell-1}, r_\ell q_1^2c_\ell,r_\ell q_1q_2c_1, \\
%&(r_iq_2^2c_i,r_iq_2^2c_{i+1})_{i=1}^{\ell-1}, r_\ell q_2^2c_\ell,r_\ell q_2q_3c_1,\\
%&\ldots, \hspace{72pt} \ldots, \hspace{24pt} \ldots,\\
%& (r_iq_m^2c_i,r_iq_m^2c_{i+1})_{i=1}^{\ell-1}, r_\ell q_m^2c_\ell,r_\ell q_mq_1c_1.
%\end{align*}
%
\[ \pi(S) =  \left(\left(r_ia_j^2c_i,r_ia_j^2c_{i+1}\right)_{i=1}^{\ell-1}, r_\ell a_j^2c_\ell,r_\ell a_ja_{j+1}c_1\right)_{j=1}^m\]
%
contains two copies of each element of $G$.
%
\end{proof}

The rest of the proof of Theorem \ref{thm:h2nonHP} is an application of group-theoretic ideas which have already appeared in Section \ref{sec:nearproof}.


\begin{proof}[Proof of Theorem \ref{thm:h2nonHP}]
Letting $G$ be a group with no complete mapping, Theorem \ref{thm:bigequiv} tells us that $\Syl_2(G) = \mathbb{Z}_{2^t}$ for some integer $t\geq 1$. Lemma \ref{lemma:burnside} then tells us that there is a normal subgroup of odd order $N \triangleleft G$ for which $G/N \cong \mathbb{Z}_{2^t}$. Therefore, $G/N$ is H2-harmonious by Proposition \ref{prop:h2cyc} and the result follows from Lemma \ref{lemma:h2util}.
\end{proof}

So far we have shown that many groups are H2-harmonious without expending too much effort. Unfortunately, for most Hall-Paige groups of even order it does not seem to be possible to find H2-harmonious sequences via straightforward extensions of results concerning complete mappings. However, when the group in question is relatively uncomplicated,  constructive proofs often arise quite naturally. We will see this when we address H2-harmonious sequences in abelian groups, but first we provide such a result for an infinite family of not necessarily abelian groups. 

\begin{theorem}\label{thm:h22xk}
If a finite group $G$ of order at least 6 has a cyclic subgroup of index 2, then $G$ is H2-harmonious. 
\end{theorem}

\begin{figure}[t]
\centering
\begin{tikzpicture}[scale=2.5,auto=left,every node/.style={circle,draw,thick,fill=black}]
\usetikzlibrary{calc}
\def\centerarc[#1](#2)(#3:#4:#5)% Syntax: [draw options] (center) (initial angle:final angle:radius)
    { \draw[#1] ($(#2)+({#5*cos(#3)},{#5*sin(#3)})$) arc (#3:#4:#5); }

%\draw [black,thick,domain=-60:-30] plot ({cos(\x)}, {sin(\x)});
\centerarc[black,thick](-1.5,0)(0:-75:1);
\centerarc[black,thick](-1.5,0)(-135:-255:1);
\centerarc[black,thick](-1.5,0)(0:45:1);

\draw[blue,thick,densely dashed] ($(-1.5,0)+(-30:1)$)--($(1.5,0)+(150:1)$);
\draw[blue,thick,densely dashed] ($(-1.5,0)+(0:1)$)--($(-1.5,0)+(150:1)$);
\draw[blue,thick,densely dashed] ($(1.5,0)+(180:1)$)--($(-1.5,0)+(120:1)$);

\filldraw [black]  (-1.5,0) + (-85:1) circle (0.4pt);
\filldraw [black]  (-1.5,0) + (-105:1) circle (0.4pt);
\filldraw [black]  (-1.5,0) + (-125:1) circle (0.4pt);
\filldraw [black]  (-1.5,0) + (95:1) circle (0.4pt);
\filldraw [black]  (-1.5,0) + (75:1) circle (0.4pt);
\filldraw [black]  (-1.5,0) + (55:1) circle (0.4pt);

%\draw[blue] (0:1)--(150:1);
\centerarc[red,ultra thick](-1.5,0)(120:150:1);
\centerarc[red,ultra thick](-1.5,0)(0:-30:1);
%\draw [red,thick,domain=0:-30] plot ({cos(\x)}, {sin(\x)});


\node (z) at ($(-1.5,0) +(30:1)$) {};
\node (z) at ($(-1.5,0)+(30:1.25)$) [fill=none,draw=none] {$b^{k-1}$};
\node (z) at ($(-1.5,0) +(0:1)$) [fill=white]  {};
\node (z) at ($(-1.5,0)+(0:1.2)$) [fill=none,draw=none] {$a$};
\node (z) at ($(-1.5,0)+(-30:1)$)  {};
\node (z) at ($(-1.5,0)+(-30:1.2)$) [fill=none,draw=none]  {$b^k$};
\node(z) at ($(-1.5,0)+(-60:1)$) [fill=white] {};
\node (z) at ($(-1.5,0)+(-60:1.2)$)[fill=none,draw=none]  {$ab$};
%\node (z) at ($(-1.5,0)+(-90:1)$) [fill=white] {};
%\node (z) at ($(-1.5,0)+(-90:1.2)$) [fill=none,draw=none]  {$b$};
\node(z) at ($(-1.5,0)+(-150:1)$) {};
\node(z) at ($(-1.5,0)+(-150:1.21)$)  [fill=none,draw=none] {$b^{-1}$};
%\node (z) at (-120:1.3) [fill=white] {$\gamma^{-2}\beta^2$};
\node (z) at ($(-1.5,0)+(-180:1)$) [fill=white] {};
\node (z) at ($(-1.5,0)+(-180:1.21)$) [fill=none,draw=none]  {$b^{-1}$};
\node(z) at ($(-1.5,0)+(-210:1)$)  {};
\node(z) at ($(-1.5,0)+(-210:1.2)$)  [fill=none,draw=none] {$1$};
\node(z) at ($(-1.5,0)+(-240:1)$)  [fill=white]{};
\node(z) at ($(-1.5,0)+(-240:1.2)$)  [fill=none,draw=none] {$1$};

\node (z) at ($(-1.5,0)+(0:0)$) [fill=none,draw=none]  {\LARGE$X_1$};
\node (z) at ($(1.5,0)+(0:0)$) [fill=none,draw=none]  {\LARGE$X_2$};

\centerarc[black,thick](1.5,0)(75:255:1);

\filldraw [black]  (1.5,0) + (30:1) circle (0.4pt);
\filldraw [black]  (1.5,0) + (45:1) circle (0.4pt);
\filldraw [black]  (1.5,0) + (60:1) circle (0.4pt);
\filldraw [black]  (1.5,0) + (0:1) circle (0.4pt);
\filldraw [black]  (1.5,0) + (-30:1) circle (0.4pt);
\filldraw [black]  (1.5,0) + (-15:1) circle (0.4pt);
\filldraw [black]  (1.5,0) + (-60:1) circle (0.4pt);
\filldraw [black]  (1.5,0) + (-75:1) circle (0.4pt);
\filldraw [black]  (1.5,0) + (-90:1) circle (0.4pt);

%\draw[blue] (0:1)--(150:1);
\centerarc[red,ultra thick](1.5,0)(180:150:1);

%\draw [red,thick,domain=0:-30] plot ({cos(\x)}, {sin(\x)});





%\node (z) at ($(1.5,0)+(-90:1)$) [fill=white] {};
%\node (z) at ($(1.5,0)+(-90:1.2)$) [fill=none,draw=none]  {$b$};
\node(z) at ($(1.5,0)+(210:1)$) [fill=white]{};
\node(z) at ($(1.5,0)+(210:1.22)$)  [fill=none,draw=none] {$b^{k-1}$};
%\node (z) at (-120:1.3) [fill=white] {$\gamma^{-2}\beta^2$};
\node (z) at ($(1.5,0)+(180:1)$)  {};
\node (z) at ($(1.5,0)+(180:1.21)$) [fill=none,draw=none]  {$b^{k}a$};
\node(z) at ($(1.5,0)+(150:1)$)  [fill=white]{};
\node(z) at ($(1.5,0)+(150:1.2)$)  [fill=none,draw=none] {$b^k$};
\node(z) at ($(1.5,0)+(120:1)$)  {};
\node(z) at ($(1.5,0)+(120:1.2)$)  [fill=none,draw=none] {$b^{k+1}a$};
\node(z) at ($(1.5,0)+(90:1)$) [fill=white] {};
\node(z) at ($(1.5,0)+(90:1.2)$)  [fill=none,draw=none] {$b^{k+1}$};
\node(z) at ($(1.5,0)+(240:1)$) {};
\node(z) at ($(1.5,0)+(240:1.2)$)  [fill=none,draw=none] {$b^{k-1}a$};





\end{tikzpicture} 

\caption[Tying together two \gls{rainbow} cycles in the proof of Theorem \ref{thm:h22xk}]{An illustration of how $X_1$ and $X_2$ are tied together into a Hamilton 2-plex. Here, $X_1$ and $X_2$ are the cycles formed by black and thick-red edges and $Y$ is formed by the thick-red and dashed-blue edges. Here, and in all subsequent figures, we draw vertices of $C$ in black and vertices of $R$ in white.}
\label{fig:h2z2zm}
\end{figure}


\begin{proof}
Let $b$ generate the cyclic subgroup of index 2 in $G$, let $a$ denote an element of $G \setminus \langle b\rangle$, and observe that $\langle b \rangle \triangleleft G$. We may assume that the order of $b$ is $m=2k$ for some $k \geq 2$, as otherwise Lemma \ref{lemma:h2util} tells us that $G$ is H2-harmonious.
We will show that $K_{n,n}(G)$ has a Hamilton 2-plex. Toward this end, we claim that both of the following $2m$-cycles are \gls{rainbow}:
%
\[ X_1 :=  \left([b^{i-1}]_C,[b^{i-1}]_R\right)_{i=0}^{k-1},[b^{k-1}]_C,\left([ab^i]_R,[b^{k+i}]_C\right)_{i=0}^{k-2},[ab^{k-1}]_R,[b^{-1}]_C,\]
%
and 
%
\[ X_2 := \left([b^{k+i-1}a]_C,[b^{k+i-1}]_R\right)_{i=0}^{k-1},[b^{-1}a]_C,\left([ab^{k+i}]_R,[b^ia]_C\right)_{i=0}^{k-2}[ab^{-1}]_R,[b^{k-1}a]_C.\]
%
Notice that the condition $k \geq 2$ is necessary for these two cycles to be well-defined. 

Recall that $G$ is not necessarily abelian, and the label on the edge $[x]_C[y]_R$ is the group element corresponding to the product $yx$. The sequence of edge labels in $X_1$, starting with $[b^{-1}]_C[b^{-1}]_R$, is 
%
\[\left(b^{i-2}_{\textcolor{white}{K}}\right)_{i=0}^{2k-1}, \left(ab^{k-1+i}\right)_{i=0}^{2k-1},\]
%
while the sequence of edge labels in $X_2$, starting with $[b^{k-1}a]_C[b^{k-1}]_R$, is 
%
\[\left(b_{\textcolor{white}{K}}^{i-2}a\right)_{i=0}^{2k-1}, \left(ab^{k-1+i}a\right)_{i=0}^{2k-1}.\]
%
To see that these two sequences are permutations of $G$, we use the fact that $\langle b \rangle$ has index 2 to conclude that there is a nonnegative integer $t$ such that $a^2 = b^t$. This implies that every element of $G$ has a unique representation of the form $a^\delta b^i$ and a unique representation of the form $b^ia^\delta$ for $\delta \in \{0,1\}$ and $i \in [m]$. Moreover, because normal subgroups are closed under inner automorphisms, there is a positive integer $\ell$ such that $(m,\ell)=1$ and $a^{-1}ba = b^\ell$. It follows that $ab^ia = a^2b^{\ell i}=b^{\ell i + t}$ for all $i \in [m]$ and, because $\ell$ is coprime to $m$, 
every element of $\langle b \rangle$ has a unique representation of the form $ab^ia$ for $i \in [m]$. 

So $X_1 \cup X_2$ is a 2-plex. To find a Hamilton 2-plex we will tie these two cycles together using the $(X_1 \cup X_2)$-alternating cycle
%
\[Y :=  [1]_C,[1]_R,[b^ka]_C,[b^k]_R,[b^k]_C,[a]_R,[1]_C.\]
%
See Figure \ref{fig:h2z2zm} for a picture of the subgraph induced by $E(X_1 \cup X_2)$ and $E(Y)$. It follows from $(\ell,2k)=1$ that $\ell$ is odd, so that
%
$ab^k = b^{\ell k}a = b^ka$. 
Therefore, the set of edge labels in $E(Y) \cap E(X_1 \cup X_2)$ is the same as the set of edge labels in $E(Y) \setminus E(X_1 \cup X_2)$, namely $\{1,a,b^ka\}$. This tells us that the graph induced by $E(Y) \triangle E(X_1 \cup X_2)$ is a 2-plex. The result then follows from the observation that the cycle in the graph induced by $E(Y) \triangle E(X_1 \cup X_2)$ containing the edge $[1]_C[a]_R$ has length $4m$. 
%
\end{proof}

The original motivation for the argument in the proof of Theorem \ref{thm:h22xk} was to show that dihedral groups are H2-harmonious. The more general result we have obtained allows us to conclude that several well-known infinite families of groups are H2-harmonious. Towards showing that Conjecture \ref{conj:groupmain} holds for small groups, we are particularly interested in the \defn{dicyclic groups}, which can be defined by $\Dic_{4n} := \langle a,b \,| \, a^n=b^2, a^{2n} = abab^{-1} = 1\rangle$, and the \defn{semidihedral groups}, which can be defined by $SD_{2^{n}} := \langle a,b \,|\, a^{2^{n-1}}=b^2=1, abab=a^{2^{n-2}}\rangle$ (see e.g.\! the documentation for the named constructions of both of these groups in Sage \cite{sagemath}). We end this section with a corollary which will be useful in Section \ref{sec:smallgrps} below.

\begin{corollary}\label{cor:h2dih}
All dihedral groups, dicyclic groups, and semidihedral groups of order at least 6 are H2-harmonious.
\end{corollary}


\section{Proof of Theorem \ref{thm:h2abel}}\label{sec:h2abel}

We now restrict our attention to abelian groups. Roughly speaking, we will prove Theorem \ref{thm:h2abel} in two steps: First, we will prove by induction that all abelian \gls{2-group}s except $\mathbb{Z}_2 \times \mathbb{Z}_2$ are H2-harmonious. Second, we will break an arbitrary abelian group $G$ into the direct product of a group of odd order and a \gls{2-group}, then apply Lemma \ref{lemma:h2util} to show that $G$ is H2-harmonious.
%
For the first step of this process, we will need to consider several possible base cases beyond the cyclic groups taken care of by Proposition \ref{prop:h2cyc}. Two of these additional base cases are the groups $\mathbb{Z}_2^3$ and $\mathbb{Z}_2^4$. 
%
Although it would be sufficient for the proof of Theorem \ref{thm:h2abel} to simply give the H2-harmonious sequences of these groups and move on, we have an interesting algebraic construction which applies to all elementary abelian \gls{2-group}s of order at least 8. 

It is worth noting that this construction, now in some sense superfluous, was in fact crucial to the formulation of Conjecture \ref{conj:groupmain}. Because $\mathbb{Z}_2\times\mathbb{Z}_2$ is not H2-harmonious, it was important to ensure that this example does not generalize to an infinite family of counterexamples. As such, the following result was an important proof of concept which motivated much of the work in this chapter. 

\begin{theorem}
For $k \geq 3$, the group $\mathbb{Z}_2^k$ is H2-harmonious.
\label{thm:h2gf2k}
\end{theorem}

\begin{figure}[t]
\centering
\begin{tikzpicture}[scale=2.5,auto=left,every node/.style={circle,draw,thick,fill=black}]

%\draw [black,thick,domain=-60:-30] plot ({cos(\x)}, {sin(\x)});
\draw [black,thick,domain=0:-105] plot ({cos(\x)}, {sin(\x)});
\draw [black,thick,domain=-165:-255] plot ({cos(\x)}, {sin(\x)});
\draw [black,thick,domain=0:45] plot ({cos(\x)}, {sin(\x)});

\draw[blue,thick,densely dashed] (-30:1)--(-1:2.25);
\draw[blue,thick,densely dashed] (0:1)--(150:1);
\draw[blue,thick,densely dashed] (13:2.25)--(120:1);
\draw [red,ultra thick,domain=120:150] plot ({cos(\x)}, {sin(\x)});
\draw [red,ultra thick,domain=0:-30] plot ({cos(\x)}, {sin(\x)});



\node (z) at (0:1) {};
\node (z) at (0:1.2) [fill=none,draw=none] {$1$};
\node (z) at (-30:1) [fill=white] {};
\node (z) at (-32:1.2) [fill=none,draw=none]  {$\beta$};
\node(z) at (-60:1){};
\node (z) at (-60:1.2)[fill=none,draw=none]  {$\gamma\beta$};
\node (z) at (-90:1) [fill=white] {};
\node (z) at (-90:1.2) [fill=none,draw=none]  {$\gamma\beta^2$};
%\node(z) at (-120:1){};
%\node (z) at (-120:1.3) [fill=white] {$\gamma^{-2}\beta^2$};
\filldraw [black]  (-115:1) circle (0.4pt);
\filldraw [black]  (-135:1) circle (0.4pt);
\filldraw [black]  (-155:1) circle (0.4pt);
\node(z) at (180:1){};
\node (z) at (180:1.2) [fill=none,draw=none]  {$\beta^{-1}$};
\node (z) at (150:1) [fill=white] {};
\node (z) at (150:1.2) [fill=none,draw=none]  {$1$};
\node(z) at (120:1){};
\node (z) at (120:1.2) [fill=none,draw=none]  {$\gamma$};
\filldraw [black]  (95:1) circle (0.4pt);
\filldraw [black]  (75:1) circle (0.4pt);
\filldraw [black]  (55:1) circle (0.4pt);
\node (z) at (30:1) [fill=white] {};
\node (z) at (30:1.15) [fill=none,draw=none] {$\gamma$};





\draw[black,thick] (13:2.25)--(-1:2.25);
\node (z) at (13:2.25)[fill=white] {};
\node (z) at (13:2.4) [fill=none,draw=none]  {$0$};
\node (z) at (-1:2.25) {};
\node (z) at (-1:2.4) [fill=none,draw=none]  {$0$};



\end{tikzpicture} 
\caption[Extending a \gls{2-bounded} $(2^k-2)$-cycle in $K_{n,n}(\mathbb{Z}_2^k)$]{An illustration of the Hamilton 2-plex $X \triangle Y$. Here, $X \cup \{[0]_R[0]_C\}$ is the graph formed by black and thick-red edges and $Y \setminus \{[0]_R[0]_C\}$ is the path formed by thick-red and dashed-blue edges.}
\label{fig:symdiff}
\end{figure}

\begin{proof}
Consider $\mathbb{Z}_2^k$ as the additive group of the finite field $\mathbb{F}_{2^k}$. It is known (see e.g. \cite{Co90}) that $k \geq 3$ implies $\mathbb{F}_{2^k}$ has a primitive element, say $\alpha$, whose trace is 0 (i.e. $\alpha+\alpha^2+\alpha^4+\cdots+\alpha^{2^{k-1}} = 0$). We claim that the polynomial $p(x) := x^2+x+\alpha \in \mathbb{F}_{2^k}[x]$ has a root in $\mathbb{F}_{2^k}$. Indeed, we know that $p(x)$ has a root $\beta$ in some extension of $\mathbb{F}_{2^k}$, say $K \supseteq \mathbb{F}_{2^k}$, so we only need to show that, in fact, $ \beta \in \mathbb{F}_{2^k}$. Working now over $K$, which has characteristic 2, it follows from $\alpha = \beta^2 + \beta$ and  $\alpha+\alpha^2+\cdots+\alpha^{2^{k-1}} = 0$  that $\beta^{2^k}+\beta=0$. This means $\beta$ is a root of $x^{2^k}+x$, whose splitting field over $\mathbb{F}_2$ is $\mathbb{F}_{2^k}$. We may therefore conclude that
%
 \[\beta,\alpha \in \mathbb{F}_{2^k} \text{ and } \alpha = \beta(\beta+1).\]
 
We will show that $K_{n,n}(\mathbb{Z}_2^k)$ has a Hamilton 2-plex. For the sake of simplifying notation, let $\gamma:=\beta+1$ and let $m = 2^k-1$. Consider the $2m$-cycle
%
 \[X := [1]_C,[\beta]_R,\left(  [\gamma^{i}\beta^i]_C, [\gamma^{i}\beta^{i+1}]_R \right)_{i=1}^{m-1}, [1]_C.\]
 %
The sequence of edge-labels in $X$ can be obtained by interleaving $\left( (\beta\gamma)^i(\beta+1) \right)_{i=0}^{m-1}$ and $\left( (\beta\gamma)^i(1+\gamma)\right)_{i=1}^{m}$. But $\beta\gamma = \beta^2+\beta = \alpha$, and because $\alpha$ is a primitive element of $\mathbb{F}_{2^k}$, every nonzero element of $\mathbb{F}_{2^k}$ has a unique representation of the form $(\beta\gamma)^i$ for some $i \in [m]$. Moreover, right-multiplication by a fixed nonzero element is a permutation of $\mathbb{F}_{2^k} \setminus \{0\}$. It follows that
%both $\left( (\beta\gamma^{-1})^i(\beta+1) \right)_{i=1}^{m}$ and $\left( (\beta\gamma^{-1})^i(\beta+\beta\gamma^{-1})\right))_{i=1}^{m}$ are permutations of $\mathbb{F}_{2^k} \setminus \{0\}$, and 
$X$ has 2 edges of color $g$ for every $g \in \mathbb{F}_{2^k} \setminus \{0\}$. 

%Because fields are groups under multiplication, the set $T_g = \{(x,xg,x(1+g))\,:\, x \in \mathbb{F}_{2^k}\}$ is a transversal of $\Gamma$ for every $g \in \mathbb{F}_{2^k} \setminus \{0,1\}$. Moreover, given $g,h \in \mathbb{F}_{2^k} \setminus \{0,1\}$ such that $g \neq h$, we have $T_g \cap T_h = \{(0,0,0)\}$. Thus, the set $T_\beta \cup T_\gamma$ consists of several cyclic components and the isolated edge $(0,0,0)$, with each nonzero edge label appears exactly twice. In fact, we can see that $T_\beta \cup T_\gamma$ contains of a single cycle of length $2m$ by considering the cycle containing the edge $(1,\beta,1+\beta)$. The sequence of vertices in this cycle will have the form
 %

 %
%Notice that both the subsequence of $X$-vertices and the subsequence of $Y$-vertices increment by $\gamma^{-1}\beta$ at each step. As $\gamma^{-1}\beta = \alpha$ is a primitive element, and therefore has multiplicative order $m$, this both of the sequences must have length $m$, so that the entire vertex sequence has length $2m$. We will denote this sequence by $C_0$. 





As we did in the proof of Theorem \ref{thm:h22xk}, we find a Hamiltonian 2-plex by augmenting $X$ with a cycle of length 6. In particular, consider the cycle
%
\[Y := [0]_C,[\beta]_R,[1]_C,[1]_R,[\gamma]_C,[0]_R,[0]_C.\]
%
We claim that the symmetric difference of $E(X)$ and $E(Y)$ corresponds to a Hamilton 2-plex (see Figure \ref{fig:symdiff}). Indeed, notice that $E(X) \cap E(Y) = \{ [\beta]_R[1]_C,[1]_R[\gamma]_C\}$, so that in passing from $E(X)$ to $E(X) \triangle E(Y)$ we lose an edge of color $\beta$ and an edge of color $\beta+1$. However, we also pick up the edges $[\beta]_R[0]_C$, $[1]_R[1]_C$, $[0]_R[\gamma]_C$, and $[0]_R[0]_C$, which have edge labels $\beta$, $0$, $\beta+1$, and 0, respectively. This shows that $E(X) \triangle E(Y)$ corresponds to a 2-plex. The result then follows from the observation that the cycle in the graph induced by $E(X) \triangle E(Y)$ containing the edge $[0]_R[0]_C$ has length $2^{k+1}$.
%To see that it is a Hamilton 2-plex, notice that we encounter every vertex in $K_{n,n}(\mathbb{Z}_2^k)$ when we walk along the cycle containing $[0]_R[0]_C$, going first to $[\beta]_R$ before walking along the edges of $X$ in the direction of $[\gamma^{-1}\beta]_C$ until we reach $[1]_R$, taking the edge $[1]_R[1]_C$ before walking along $X$ in the direction of $[\gamma]_R$ until we reach $[\gamma^{-1}]_C$, and finally returning to where we started with the edge $[\gamma^{-1}]_C[0]_R$.
%
\end{proof}

It would have been interesting to extend the field-theoretic construction in the proof of Theorem \ref{thm:h2gf2k} to all elementary abelian groups, but unfortunately this is not possible: the construction relies on the identities  $1+\gamma^{-1} = \beta$ and $1+\beta = \gamma^{-1}$ being concurrently true, which implies $\beta = \beta+2$. Of course, this does not affect the list of groups we can identify as H2-harmonious given the fact that Theorem \ref{thm:h2odd} takes care of all (elementary abelian) groups of odd order. 

The final base case we will need for the proof of Theorem \ref{thm:h2abel} was obtained using the backtracking algorithm presented in Appendix \ref{app:backtrack}.


%\begin{figure}[t]
%\begin{center}
%\newcommand{\overred}[1]{\textcolor{red}{\mathbf{\underline{#1}}}}
%${\setlength{\arraycolsep}{0.45ex}
%\begin{array}{|*{4}{c|}|*{4}{c|}|*{4}{c|}|*{4}{c|}}
%\hline
%\overred{1}&b&\overred{b^2}&b^3&a&ab&ab^2&ab^3&a^2&a^2b&a^2b^2&a^2b^3&a^3&a^3b&a^3b^2&a^3b^3\\\hline
%b&b^2&b^3&\overred{1}&ab&ab^2&ab^3&\overred{a}&a^2b&a^2b^2&a^2b^3&a^2&a^3b&a^3b^2&a^3b^3&a^3\\\hline
%b^2&b^3&1&b&ab^2&ab^3&a&ab&a^2b^2&\overred{a^2b^3}&a^2&\overred{a^2b}&a^3b^2&a^3b^3&a^3&a^3b\\\hline
%b^3&1&b&b^2&ab^3&a&\overred{ab}&ab^2&a^2b^3&a^2&a^2b&a^2b^2&a^3b^3&a^3&a^3b&\overred{a^3b^2}\\\hline\hline
%a&ab&ab^2&ab^3&a^2&a^2b&a^2b^2&a^2b^3&a^3&a^3b&\overred{a^3b^2}&a^3b^3&1&b&\overred{b^2}&b^3\\\hline
%ab&ab^2&ab^3&a&a^2b&a^2b^2&a^2b^3&\overred{a^2}&a^3b&a^3b^2&a^3b^3&\overred{a^3}&b&b^2&b^3&1\\\hline
%ab^2&\overred{ab^3}&a&ab&a^2b^2&a^2b^3&a^2&a^2b&a^3b^2&a^3b^3&\overred{a^3}&a^3b&b^2&b^3&1&b\\\hline
%ab^3&a&ab&ab^2&a^2b^3&\overred{a^2}&a^2b&a^2b^2&a^3b^3&a^3&a^3b&a^3b^2&\overred{b^3}&1&b&b^2\\\hline\hline
%a^2&a^2b&a^2b^2&a^2b^3&a^3&a^3b&a^3b^2&a^3b^3&1&b&b^2&b^3&a&\overred{ab}&\overred{ab^2}&ab^3\\\hline
%a^2b&a^2b^2&a^2b^3&a^2&\overred{a^3b}&a^3b^2&\overred{a^3b^3}&a^3&b&b^2&b^3&1&ab&ab^2&ab^3&a\\\hline
%a^2b^2&a^2b^3&a^2&\overred{a^2b}&a^3b^2&a^3b^3&a^3&a^3b&b^2&b^3&1&b&\overred{ab^2}&ab^3&a&ab\\\hline
%\overred{a^2b^3}&a^2&a^2b&a^2b^2&a^3b^3&a^3&a^3b&a^3b^2&\overred{b^3}&1&b&b^2&ab^3&a&ab&ab^2\\\hline\hline
%a^3&a^3b&a^3b^2&a^3b^3&1&\overred{b}&b^2&b^3&\overred{a}&ab&ab^2&ab^3&a^2&a^2b&a^2b^2&a^2b^3\\\hline
%a^3b&a^3b^2&a^3b^3&a^3&\overred{b}&b^2&b^3&1&ab&ab^2&ab^3&a&a^2b&\overred{a^2b^2}&a^2b^3&a^2\\\hline
%a^3b^2&\overred{a^3b^3}&a^3&a^3b&b^2&b^3&1&b&ab^2&\overred{ab^3}&a&ab&a^2b^2&a^2b^3&a^2&a^2b\\\hline
%a^3b^3&a^3&\overred{a^3b}&a^3b^2&b^3&1&b&b^2&ab^3&a&ab&ab^2&a^2b^3&a^2&a^2b&\overred{a^2b^2}\\\hline
%\end{array}}$
%\caption{The cayley table of $\mathbb{Z}_4 \times \mathbb{Z}_4 = \langle a,b \, | \, a^4=b^4 = aba^{-1}b^{-1}=1\rangle$ with a Hamilton 2-plex in red}\label{fig:z4z4}
%\end{center}
%\end{figure}

\begin{proposition}
The group $\mathbb{Z}_4 \times \mathbb{Z}_4$ is H2-harmonious.
\label{prop:h2z4z4}\end{proposition}

\begin{proof}
Let $a$ and $b$ generate $\mathbb{Z}_4 \times \mathbb{Z}_4$. Checking that
%
\begin{align*} S:= \,& 1,1,b^2,a^3b^3,a^3b^3,b^3,ab^2,a^2b,a,a^3b,a^3b,a^2,a^3b^2,a,a^2b^2,ab^2,\\
&b,a^3b^2,a^2b,b^2,a^2b^3,ab,ab^3,b,b^3,a^2b^2,a^3,ab^3,ab,a^3,a^2,a^2b^3
\end{align*}
%
is an H2-harmonious sequence of $\mathbb{Z}_4\times\mathbb{Z}_4$ is straightforward given
%
\begin{align*}
 \pi(S) = \,& 1,b^2,a^3b,a^2b^2,a^3b^2,ab,a^3b^3,a^3b,  b,a^2b^2,ab,ab^2,b^2,a^3b^2,a^3,ab^3,\\
 & a^3b^3,ab^3,a^2b^3,a^2b,a^3,a^2,a,1,a^2b,ab^2,b^3,a^2,b,a,b^3,a^2b^3.\qedhere
\end{align*}
\end{proof}

We now turn to the key lemma in our inductive proof that all sufficiently large abelian \gls{2-group}s are H2-harmonious. 
Although we use group-theoretic language in the proof of this lemma, it worth giving a brief graph-theoretic description of the underlying ideas. Inspired by the proof of a similar lemma concerning harmonious groups in Section 6 of \cite{BGHJ91}, our H2-harmonious sequences consist of two pairs of long periodic subsequences connected by two short, ad-hoc subsequences. These pairs of long sequences correspond to long \gls{2-bounded} paths in $K_{n,n}(G)$, and the challenge of establishing the following result was to find short paths which use the outstanding edge labels while tying these two long paths together into a \gls{Hamilton cycle}.



\begin{lemma}
If a finite abelian group $G$ is an extension of a nontrivial H2-harmonious group by $\mathbb{Z}_2\times\mathbb{Z}_2$, then $G$ is H2-harmonious.
\label{lemma:h2z2z2}\end{lemma}


\begin{proof}
Letting $m := |G|/4$, we may assume that $m \geq 4$ by Proposition \ref{prop:h2cyc} and Theorem \ref{thm:h22xk}. Let $a$ and $b$ generate the given subgroup $N \triangleleft G$ isomorphic to $\mathbb{Z}_2 \times \mathbb{Z}_2$ and let 
$c_1,\ldots,c_m$ and $r_1,\ldots,r_m$ be ordered sets of coset representatives for $N$ in $G$ such that 
%
$c_1N,r_1N,\ldots,c_mN,r_mN$
%
 is an H2-harmonious sequence of $G/N$. %Letting 
%
%\[P = \{(r_i,c_i),(r_i,c_{i+1}) \,:\, i \in [m]\},\]
%
% where indices are taken modulo $m$, notice that every element of $G$ has exactly two representations of the form $a^ib^jxy$ for $i,j \in [2]$ and $(x,y) \in P$.
% Notice that each element of $G$ has a unique representation of the form $a^ib^jr_k$, a unique representation of the form $a^ib^jc_\ell$, and exactly two representations of the form $a^ib^jr_pc_{q+\varepsilon}$, where we consider $i,j \in [2]$, $k,\ell,p,q \in [m]$, and $\varepsilon\in \{0,1\}$. 
In the case $m \equiv 1 \pmod{3}$, we let $k = \frac{m-1}{3}$ and claim that
%
\begin{align}
&\left( c_i,r_i \right)_{i=1}^m \label{eq:2g1}\\ %c_1,r_1,c_2,r_2,\ldots,c_m,r_m, 
& \left( bc_{3i+1},ar_{3i},abc_{3i}, br_{3i-1},ac_{3i-1} ,abr_{3i-2}\right)_{i=k}^{\searrow 2}, bc_4,ar_3,abc_3,br_2,ac_2, \label{eq:2g2}\\%,bc_{3\ell+1},ar_{3\ell},abc_{3\ell},\ldots,ac_2,
& \,\,\,br_1,abc_1,ar_m,ac_1,abr_1,\label{eq:2g3}\\
& \,\,\,bc_2,abr_2,ac_3,br_3,abc_4,\left(ar_{3i-2},bc_{3i-1},abr_{3i-1},ac_{3i},br_{3i},abc_{3i+1}\right)_{i=2}^{k} , \label{eq:2g4}\\%br_{m-1},abc_m,bc_{m-2},abr_{m-2},ac_{m-1},br_{m-1},abc_m,
& \left(br_{3i+1},ac_{3i+1},abr_{3i}, bc_{3i},ar_{3i-1},abc_{3i-1}\right)_{i=k}^{\searrow 1} \label{eq:2g5}\\%bc_3,ar_2,abc_2,,br_{3\ell-2},ac_{3\ell-2},abr_{3\ell-3},\ldots,abc_2,br_m,ac_m,abr_{m-1},\ldots,  
& \,\,\,ar_1,bc_1,abr_m \label{eq:2g6}
\end{align}
%d
is an H2-harmonious sequence of $G$ (when $k=1$ the periodic portions of \eqref{eq:2g2} and \eqref{eq:2g4} have length zero). Towards establishing the claim, notice that every element of $G$ has exactly two representations of the form 
%
\begin{equation} a^ib^jr_kc_{k+\delta} \text{ for }i,j,\delta \in \{0,1\} \text{ and }k \in [m]. \label{eq:type}\end{equation}
%
Therefore, it suffices to show that every expression of the form \eqref{eq:type} appears exactly once as a product of consecutive elements of the given sequence. Notice that we may take consecutive products, rather than following Definition \ref{def:h2seq} precisely, due to the fact that $G$ is abelian. And indeed, taking consecutive products in \eqref{eq:2g1} gives us a copy of every expression of the form $r_kc_{k + \delta}$ with $k \in [m]$ except $r_mc_1$. Similarly, \eqref{eq:2g2}, \eqref{eq:2g4}, and \eqref{eq:2g5} together give all expressions of the form $ar_kc_{k + \delta}$, $br_kc_{k + \delta}$, and $abr_kc_{k + \delta}$ with $k \in [2,m-1]$. 
%
Moreover, the product of the first two terms in \eqref{eq:2g5} gives us the expression $abr_mc_m$, we obtain $br_mc_m$ in the step from \eqref{eq:2g1} to \eqref{eq:2g2}, and we obtain $ar_mc_m$ in the step from \eqref{eq:2g4} to \eqref{eq:2g5}. Finally, we see that the sequence of consecutive products from the final term of \eqref{eq:2g2}, through \eqref{eq:2g3}, to the first term of \eqref{eq:2g4} gives us
%
\[ abr_1c_2,ar_1c_1,br_mc_1,r_mc_1,br_1c_1,ar_1c_2,\]
%
while taking consecutive products from the final term of \eqref{eq:2g5}, through \eqref{eq:2g6}, to the first term of \eqref{eq:2g1} gives $br_1c_2,abr_1c_1,ar_mc_1,abr_mc_1$. Thus, taking cyclically consecutive products in the sequence given by \eqref{eq:2g1}-\eqref{eq:2g6}, we obtain exactly one copy of each expression of the form \eqref{eq:type}.



\begin{figure}[t]
\centering
\begin{tikzpicture}[scale=0.37,auto=left]
\foreach \i in {1,...,8}{
\foreach \j in {0,...,3}{
   \node[draw=none,fill=none] (z) at (\i-0.5+8*\j,32.75)  {\small $c_\i$};
   \node[draw=none,fill=none] (z) at (-0.75,-\i+8.5+8*\j)  {\small $r_\i$};
   }
   }
   
   \node[draw=none,fill=none] (z) at (4,34)  {\Large $1$};
      \node[draw=none,fill=none] (z) at (12,34)  {\Large $a$};
 \node[draw=none,fill=none] (z) at (20,34)  {\Large $b$};
\node[draw=none,fill=none] (z) at (28,34)  {\Large $ab$};

   \node[draw=none,fill=none] (z) at (-2.5,28)  {\Large $1$};
      \node[draw=none,fill=none] (z) at (-2.5,20)  {\Large $a$};
 \node[draw=none,fill=none] (z) at (-2.5,12)  {\Large $b$};
\node[draw=none,fill=none] (z) at (-2.5,4)  {\Large $ab$};


\filldraw[color=green!5] (16,16) rectangle (24,24);
\filldraw[color=green!5] (8,8) rectangle (16,16);
\filldraw[color=green!5] (0,0) rectangle (8,8);
\filldraw[color=green!5] (24,24) rectangle (32,32);

\filldraw[color=yellow!5] (8,24) rectangle (16,32);
\filldraw[color=yellow!5] (0,16) rectangle (8,24);
\filldraw[color=yellow!5] (24,8) rectangle (32,16);
\filldraw[color=yellow!5] (16,0) rectangle (24,8);

\filldraw[color=red!5] (0,24) rectangle (8,32);
\filldraw[color=red!5] (8,16) rectangle (16,24);
\filldraw[color=red!5] (16,8) rectangle (24,16);
\filldraw[color=red!5] (24,0) rectangle (32,8);

\filldraw[color=blue!5] (16,24) rectangle (24,32);
\filldraw[color=blue!5] (24,16) rectangle (32,24);
\filldraw[color=blue!5] (0,8) rectangle (8,16);
\filldraw[color=blue!5] (8,0) rectangle (16,8);


\foreach \i in {0,...,32} {
        \draw [black, thin]  (\i,0) -- (\i,32);
       \draw [black, thin]  (0,\i) -- (32,\i);
}
\foreach \i in {0,...,4} {
    \draw [black, ultra thick] (8*\i,0)--(8*\i,32);
    \draw [black, ultra thick]  (0,8*\i)--(32,8*\i);
}

\foreach \i in {0,...,6}{
\filldraw [red]  (\i+0.5,31.5-\i) circle (6pt);
\filldraw [red]  (\i+1.5,31.5-\i) circle (6pt);
}
\filldraw [red]  (7.5,24.5) circle (6pt);
\filldraw [blue]  (23.5,24.5) circle (6pt);

\filldraw [magenta] (16+7.5,16+1.5) circle (6pt);
\filldraw [magenta] (24+6.5,16+1.5) circle (6pt);
\filldraw [magenta] (24+6.5,8+2.5) circle (6pt);
\filldraw [magenta] (8+5.5,8+2.5) circle (6pt);
\filldraw [magenta] (8+5.5,0+3.5) circle (6pt);
\filldraw [magenta] (16+4.5,0+3.5) circle (6pt);
\filldraw [magenta] (16+4.5,16+4.5) circle (6pt);
\filldraw [magenta] (24+3.5,16+4.5) circle (6pt);
\filldraw [magenta] (24+3.5,8+5.5) circle (6pt);
\filldraw [magenta] (8+2.5,8+5.5) circle (6pt);
\filldraw [magenta] (8+2.5,0+6.5) circle (6pt);
\filldraw [magenta] (16+1.5,0+6.5) circle (6pt);

\filldraw [blue]  (16+1.5,0+7.5) circle (6pt);

\filldraw [orange]  (8+0.5,0+7.5) circle (6pt);
\filldraw [orange]  (8+0.5,0+0.5) circle (6pt);
\filldraw [orange]  (24+0.5,0+0.5) circle (6pt);
\filldraw [orange]  (24+0.5,8+7.5) circle (6pt);

\filldraw [blue]  (8+1.5,8+7.5) circle (6pt);

\filldraw [cyan] (8+1.5,8+6.5) circle (6pt);
\filldraw [cyan] (24+2.5,8+6.5) circle (6pt);
\filldraw [cyan] (24+2.5,16+5.5) circle (6pt);
\filldraw [cyan] (16+3.5,16+5.5) circle (6pt);
\filldraw [cyan] (16+3.5,0+4.5) circle (6pt);
\filldraw [cyan] (8+4.5,0+4.5) circle (6pt);
\filldraw [cyan] (8+4.5,8+3.5) circle (6pt);
\filldraw [cyan] (24+5.5,8+3.5) circle (6pt);
\filldraw [cyan] (24+5.5,16+2.5) circle (6pt);
\filldraw [cyan] (16+6.5,16+2.5) circle (6pt);
\filldraw [cyan] (16+6.5,0+1.5) circle (6pt);
\filldraw [cyan] (8+7.5,0+1.5) circle (6pt);
\filldraw [cyan] (8+7.5,8+0.5) circle (6pt);

\filldraw [blue]  (24+7.5,8+0.5) circle (6pt);

\filldraw [green!60!black!90] (24+7.5,8+1.5) circle (6pt);
\filldraw [green!60!black!90] (8+6.5,8+1.5) circle (6pt);
\filldraw [green!60!black!90] (8+6.5,0+2.5) circle (6pt);
\filldraw [green!60!black!90] (16+5.5,0+2.5) circle (6pt);
\filldraw [green!60!black!90] (16+5.5,16+3.5) circle (6pt);
\filldraw [green!60!black!90] (24+4.5,16+3.5) circle (6pt);
\filldraw [green!60!black!90] (24+4.5,8+4.5) circle (6pt);
\filldraw [green!60!black!90] (8+3.5,8+4.5) circle (6pt);
\filldraw [green!60!black!90] (8+3.5,0+5.5) circle (6pt);
\filldraw [green!60!black!90] (16+2.5,0+5.5) circle (6pt);
\filldraw [green!60!black!90] (16+2.5,16+6.5) circle (6pt);
\filldraw [green!60!black!90] (24+1.5,16+6.5) circle (6pt);

\filldraw [blue]  (24+1.5,16+7.5) circle (6pt);

\filldraw [brown] (16+0.5,16+7.5) circle (6pt);
\filldraw [brown] (16+0.5,16+0.5) circle (6pt);

\filldraw [blue]  (0.5,16+0.5) circle (6pt);



\end{tikzpicture} 
\caption[A Hamilton 2-plex in the \gls{cayley table} of an extension of $\mathbb{Z}_2 \times \mathbb{Z}_2$]{The Hamilton 2-plex in $L_G$ corresponding to the H2-harmonious sequence of $G$ given in the $m \equiv 2 \pmod{3}$ case of Lemma \ref{lemma:h2z2z2}. Consecutive products within the various lines are color-coded as follows:  \textcolor{red}{\eqref{eq:2g7}}, \textcolor{magenta}{\eqref{eq:2g8}}, \textcolor{orange}{\eqref{eq:2g9}}, \textcolor{cyan}{\eqref{eq:2g10}}, \textcolor{green!60!black!90}{\eqref{eq:2g11}}, \textcolor{brown}{\eqref{eq:2g12}}. \textcolor{blue}{Blue} circles, moreover, correspond to products taken between the last term in one line and the first term in the next.}\label{fig:2mod3}
\end{figure}



In the case $m \equiv 2 \pmod{3}$ let $k := \frac{m-2}{3}$. A similar argument establishes that 
%
\begin{align}
& \left(c_i,r_i\right)_{i=1}^m,\label{eq:2g7}\\%c_2,r_2,\ldots,c_m,r_m,
& \,\,\,bc_m,\left( ar_{3i+1},abc_{3i+1}, br_{3i},ac_{3i} ,abr_{3i-1},bc_{3i-1}\right)_{i=k}^{\searrow 1},\label{eq:2g8}\\%abc_{3\ell-2},\ldots,bc_2,ar_{3\ell-2}
& \,\,\,abr_1,ac_1,abr_m,abc_1,br_1,\label{eq:2g9}\\
& \,\,\,ac_2,br_2,  \left(abc_{3i},ar_{3i},bc_{3i+1},abr_{3i+1},ac_{3i+2},br_{3i+2}\right)_{i=1}^k,\label{eq:2g10}\\ %ac_m,br_mabc_{3\ell+3}, \ldots,br_m,
& \,\,\,abc_m,\left(br_{3i+1},ac_{3i+1},abr_{3i},bc_{3i},ar_{3i-1},abc_{3i-1}\right)_{i=k}^{\searrow 1},\label{eq:2g11}\\%br_{3\ell-2},ac_{3\ell-2},\ldots,abc_2
& \,\,\,ar_1,bc_1,ar_m \label{eq:2g12}
\end{align}
%
%
is an H2-harmonious sequence of $G$ (see Figure \ref{fig:2mod3} for an illustration of this case). Finally, a similar argument also establishes that, in the case $m \equiv 0 \pmod{3}$, if we let $k:=\frac{m}{3}$, then
%
\begin{align*}
&\left( c_i,r_i \right)_{i=1}^m,\\
& \left(bc_{3i},ar_{3i-1},abc_{3i-1},br_{3i-2},ac_{3i-2} ,abr_{3i-3}\right)_{i=k}^{\searrow 2} ,bc_{3},ar_{2},abc_{2},\\%,br_1,ac_1,
& br_1,ac_1,ar_m,abc_1,ar_1,\\
& bc_2,abr_{2},ac_{3},br_{3},\left(abc_{3i-2},ar_{3i-2},bc_{3i-1},abr_{3i-1},ac_{3i},br_{3i}\right)_{i=2}^k, \\%abr_{m-1},ac_m,br_m,
& abc_m,br_{m-1},ac_{m-1},\left(abr_{3i+1},bc_{3i+1},ar_{3i},abc_{3i},br_{3i-1},ac_{3i-1}\right)_{i=k-1}^{\searrow 1},\\%abr_1,bc_1,
& abr_1,bc_1,abr_m 
\end{align*}
is an H2-harmonious sequence of $G$.
\end{proof}

The astute reader may notice that the lemma just proven is not restricted to \gls{2-group}s, with the proof explicitly considering groups whose order is divisible by 3. Indeed, Lemma \ref{lemma:h2z2z2} will also play an important role in the second step of our proof (as sketched at the beginning of this section): we cannot apply Lemma \ref{lemma:h2util} to groups whose Sylow 2-subgroup is $\mathbb{Z}_2 \times \mathbb{Z}_2$.

We now have all the machinery in place to carry out the two step process outlined at the start of this section. First, a proof by induction that the conclusion of Theorem \ref{thm:h2abel} holds for abelian \gls{2-group}s.







\begin{theorem}
All finite abelian \gls{2-group}s besides $\mathbb{Z}_2\times \mathbb{Z}_2$ are H2-harmonious.
\label{thm:h22grp}\end{theorem}


\begin{proof}
We proceed by induction on $|G|$, with Proposition \ref{prop:h2cyc}, Theorem \ref{thm:h2gf2k}, and Theorem \ref{thm:h22xk} establishing the result in the case $|G| \leq 8$. For the induction step, let $G$ be an abelian \gls{2-group} of order at least 16. We may assume $G$ is not cyclic by Proposition \ref{prop:h2cyc}, so the fundamental theorem of finite abelian groups tells us that $G \cong \mathbb{Z}_{2^{k}} \times \mathbb{Z}_{2^{\ell}} \times A$ for some integers $k \geq \ell \geq 1$ and some (possibly trivial) abelian \gls{2-group} $A$ in which every element has order at most $2^\ell$. Letting $a$ denote the unique element of order 2 in the $\mathbb{Z}_{2^{k}}$ factor of $G$ and $b$ the unique element of order 2 in the $\mathbb{Z}_{2^{\ell}}$ factor, the normal subgroup $N = \langle a,b\rangle$ is isomorphic to $\mathbb{Z}_2 \times \mathbb{Z}_2$ and the factor group $Q = G/N$ is an abelian \gls{2-group} satisfying $|Q|<|G|$. If $Q \not\cong \mathbb{Z}_2 \times \mathbb{Z}_2$, then we know by induction that $Q$ is H2-harmonious and Lemma \ref{lemma:h2z2z2} tells us that $G$ is also H2-harmonious. If $Q \cong \mathbb{Z}_2 \times \mathbb{Z}_2$, then we have either $G \cong \mathbb{Z}_4 \times \mathbb{Z}_4$, in which case we may apply Proposition \ref{prop:h2z4z4} to see that $G$ is H2-harmonious, or $G \cong \mathbb{Z}_2^4$, in which case we may apply Theorem \ref{thm:h2gf2k} to obtain the desired result.
\end{proof}

Finally, the hard work is done and we can enjoy the fruits of our labor with a very short proof of this chapter's main theorem.

\begin{proof}[Proof of Theorem \ref{thm:h2abel}]
Let $G$ be a finite abelian group and let $S$ be a Sylow 2-subgroup of $G$. By the fundamental theorem of finite abelian groups, there is a subgroup $N$ of odd order such that $G \cong S \times N$. We may assume both $S$ and $N$ are nontrivial by Theorems \ref{thm:h2odd} and \ref{thm:h22grp}. If $S \not\cong \mathbb{Z}_2 \times \mathbb{Z}_2$, then we may apply Theorem \ref{thm:h22grp} and Lemma \ref{lemma:h2util} to see that $G$ is H2-harmonious. If $S \cong \mathbb{Z}_2 \times \mathbb{Z}_2$, the result follows from Theorem \ref{thm:h2odd} and Lemma \ref{lemma:h2z2z2}.
%
\end{proof}



\section{Small H2-harmonious groups}\label{sec:smallgrps}

We end this chapter with additional evidence for Conjecture \ref{conj:groupmain}. By combining the above work with several computational searches, we obtained the following exhaustive result.

\begin{proposition}\label{prop:smallgrps}
Every group of order less than 32 except $\mathbb{Z}_2 \times \mathbb{Z}_2$ is H2-harmonious.
\end{proposition}

A complete proof of Proposition \ref{prop:smallgrps} is given in Appendix \ref{app:smallgrps}. This proof comes in the form of a list containing every group of order less than 32 not already shown to be H2-harmonious by Theorems \ref{thm:h2abel} and \ref{thm:h2odd} or Corollary \ref{cor:h2dih}. In other words, we give either an H2-harmonious sequence or a theoretical explanation for every nonabelian group of even order less than 32 which is not dihedral, semidihedral, or dicyclic. We determined these groups using The Gap Small Groups Library \cite{GAPSmGrp}, and refer the reader to \cite{GAPSmGrp} for confirmation that we have indeed considered all groups of order less than 32. The H2-harmonious sequences were generated by running the algorithm given in Appendix \ref{app:backtrack} with the computer algebra system Sage \cite{sagemath}.

The choice to stop at groups of order 31 was not quite a matter of computational feasibility---it took just under 3 minutes to find an H2-harmonious sequence for the group with GAP ID [32,43] on a laptop with a 2.3 GHz Intel i7 processor and 16 GB of RAM---but rather a qualitative cost-benefit analysis. Indeed, there are more nonabelian groups of order 32 than there are nonabelian groups of all smaller orders combined. Moreover, similar to the case of abelian groups, it is particularly difficult to show that small groups whose order is a power of 2 are H2-harmonious. This is largely because we cannot  apply Lemma \ref{lemma:h2util} to groups whose order has no odd divisors. Table \ref{tab:smallgrps} gives, for each even $n$ between 6 and 30, the number of nonabelian groups of order $n$ that can be shown to be H2-harmonious by various available tools. We see from this figure that 24 of the 31 considered groups whose order is not a power of 2 satisfy the hypotheses of Lemma \ref{lemma:h2util}, while more than half of the nonabelian groups of order 16 required a computer search to determine the existence of an H2-harmonious sequence. 

\begin{table}[h]
$\begin{array}{c||*{14}{c|}}
&6&8&10&12&14&16&18&20&22&24&26&28&30\\\hline\hline
\text{number of nonabelian groups} &   1&2&1&3&1&9&3&3&1&12&1&2&3 \\\hline\hline
\text{Lemma \ref{lemma:h2util}}&1&0&1&1&1&0&3&2&1&9&1&1&3\\\hline
\text{Theorem \ref{thm:h22xk} }&1&2&1&2&1&4&1&2&1&6&1&2&3\\\hline
\text{Computer Search}&0&0&0&1 &0&5&0&0&0&3&0&0&0\\\hline
\end{array}$
\caption[A rough description of how to show small groups are H2-harmonious]{For every even order less than 32 (such that there exists at least one nonabelian group), the number of nonabelian groups which are known to be H2-harmonious by various methods. The sum of values in several columns is larger than the total number of nonabelian groups because some groups satisfy the hypotheses of both Lemma \ref{lemma:h2util} and Theorem \ref{thm:h22xk}.}
\label{tab:smallgrps}
\end{table}


The most significant reason to doubt Conjecture \ref{conj:groupmain} is that none of the results above apply to non-\gls{solvable group}s. It is for this reason that we also ran the algorithm in Appendix \ref{app:backtrack} on the alternating group $A_5$, well-known to be the only non-\gls{solvable group} of order less than 100. After several days, the computer found an H2-harmonious sequence for $A_5$, and we include this sequence in Appendix \ref{app:smallgrps}. Nonetheless, resolving the following special case of Conjecture \ref{conj:groupmain} would be significant, as it would give an infinite family of H2-harmonious non-solvable groups.

\begin{conjecture}
All symmetric and alternating groups are H2-harmonious.
\end{conjecture}

Perhaps the most obvious next step towards Conjecture \ref{conj:groupmain}, though, is to demonstrate that it holds for \gls{solvable group}s. Inductive techniques similar to those used above are likely capable of establishing such a result. 









\chapter{Variations on plexes in latin squares}\label{ch:varplex}

In this chapter we offer further evidence in support of Conjecture \ref{conj:main}---every latin square of order at least 5 has a Hamilton 2-plex---while mapping out a basic theory of $(k, \ell)$-plexes. Moving on from the group-theoretic tools of the two previous chapters, most of the proofs below will use ideas from extremal and probabilistic combinatorics. The general strategy of finding an approximation of the target structure before finishing with local changes, however, will again be heavily utilized.  
%
%For ease of exposition, we follow \cite{Al20plus} in assigning to each $k$-edge-colored graph $G$ a vector $x(G) = (x_1,x_2,\ldots,x_k)$ such that $x_i$ is the number of edges in $G$ with color $i$; we refer to $x(G)$ as the \defn{color-support vector} of $G$.
Most of the work in this chapter was initially motivated by the question(s): when can we guarantee that, for a generalized latin square $L$, there is a \gls{Hamilton cycle} in $K_{n,n}(L)$ whose color distribution has certain desirable properties? Notice that Conjecture \ref{conj:main} can be stated in this manner: for every latin square $L$, there is Hamilton cycle in $K_{n,n}(L)$ with two edges of every color. 

We will begin by showing that, for every latin square $L$, there is a Hamilton cycle in $K_{n,n}(L)$ containing at least one edge of each color. This is in some sense a warm-up for our first main result, which uses similar techniques to find Hamilton 2-plexes in arrays which do not contain too many copies of any symbol. Recall that a $k$-bounded $n$-square is an $n\times n$ array in which no symbol appears more than $k$ times. In Section \ref{sec:LLLL}, we use the lopsided Lov\'asz Local Lemma to prove the following. 

\begin{theorem}
Every $\frac{n}{\sqrt{96}}$-bounded $n$-square has a Hamilton 2-plex. 
\label{thm:LLLLmain}\end{theorem}

It seems likely that this result is not tight, though it is not clear how much it could be improved. One may ask: what is the largest $c$ such that every $cn$-bounded $n$-square has a Hamilton 2-plex? The existence of $n$-bounded $n$-squares, i.e.\! \gls{equi-$n$ square}s, with no near transversals  \cite{PS19} indicates that perhaps some equi-$n$-squares do not have Hamilton 2-plexes. However, we were unable modify the construction from \cite{PS19} to find equi-$n$-squares with no Hamilton 2-plex despite spending a significant amount of time attempting to do so. This inspires an interesting question about which we cannot yet confidently form a conjecture.

\begin{question}
 Does every equi-$n$ square have a Hamilton 2-plex? 
\end{question}

The second half of this chapter is concerned mostly with $(k,\ell)$-plexes in latin squares, or collections of cells which intersect each row and each column $k$ times and contain at most $\ell$ copies of each symbol. We also consider \defn{partial $k$-plexes}, or collections of cells which intersect each row and column at most $k$ times and contain at most $k$ copies of each symbol. Conjecture \ref{conj:wanless} asserts that, when $k$ is an even integer, there is a $k$-plex in every latin square of order at least $k$. Therefore, when $k$ is even, it should be possible to find both large partial $k$-plexes and $(k,\ell)$-plexes for all $\ell \geq k$. But  Egan and Wanless showed that, when $k$ is any odd integer, there exist infinitely many latin squares which do not have a $k$-plex \cite{EW08}. This means it is not clear whether $(k,k+1)$-plexes or large partial $k$-plexes should always exist. The second main result of this chapter shows that one can find both of these structures so long as $n$ is sufficiently large with respect to $k$.

\begin{theorem}\label{thm:partplex}
For all $k \geq 1$, there exists $n_0 \in \mathbb{N}$ such that, for all $n \geq n_0$,
%
\begin{enumerate}\renewcommand{\labelenumi}{(\alph{enumi})}
\item every latin square of  order $n$ has a partial $k$-plex of size $kn-o(n)$, and
\item  every latin square of order $n$ has a $(k,k+1)$-plex.
\end{enumerate}
\end{theorem}

We will also prove that, in the $k=2$ cases of Theorem \ref{thm:partplex}, we can always find Hamilton plexes. We then end the chapter with two $(k,\ell)$-plex existence results which hold for all latin squares, rather than just latin squares which are sufficiently large. In particular, we show that every latin square has a Hamilton $(2,5)$-plex and, for all $k \leq \frac{n}{4}$, every latin square of order $n$ has a $(k,4k)$-plex.  Throughout this chapter, we will often identify paths and cycles with the set of edges comprising them.

%In fact, we 
%\begin{theorem}
%If $k=O(1)$, then every latin square of sufficiently large order $n$ has a partial $k$-plex of size $kn-o(n)$. 
%\end{theorem}



 

\section{Local switching and Hamilton covers}

Throughout this section we let $(R,C)$ denote the \gls{bipartition} of $K_{n,n}$, where $R = \{r_1,\ldots,r_n\}$ and $C = \{c_1,\ldots,c_n\}$. Moreover, unless noted otherwise, we use $H$ to denote a \gls{Hamilton cycle} of $K_{n,n}$.  In order to define our local switching procedure we must first define a notion of congruence on $H$. 

\begin{definition}
We say that two edges $r_ic_j,r_kc_\ell \in H$ are \defn{congruent modulo $H$}, denoted $r_ic_j \equiv r_kc_\ell \pmod{H}$, if when cyclically orienting $H$ in the direction from $r_i$ to $c_j$ and walking along $H$ from $c_j$ according to this orientation, we reach $r_k$ before $c_\ell$.
\end{definition}
%
See Figure \ref{fig:switch} for an example of two edges which are not congruent. As every Hamilton cycle in $K_{n,n}$ has even length, this notion of congruence is an equivalence relation with two equivalence classes of size $n$.  

\begin{figure}[h]
\centering
\begin{tikzpicture}[scale=2.5,auto=left,every node/.style={circle,draw,thick,fill=black,minimum size=1pt}]
\draw [thick] (0,0) circle (1cm);
\draw [red,ultra thick,domain=90:68.5] plot ({cos(\x)}, {sin(\x)});
\draw [red,ultra thick,domain=-90:-68.5] plot ({cos(\x)}, {sin(\x)});
\draw[blue,thick,densely dashed] (90:1)--(-68.5:1);
\draw[blue,thick,densely dashed] (-90:1)--(68.5:1);
\foreach \i in {1,...,8}{ 
\node (z) at (45*\i:1) [fill=white,minimum size=1pt] {};
\node (z) at (45*\i+22.5:1) {};
}
\node (z) at (90:1.15) [fill=none,draw=none]  {$r_i$};
\node (z) at (68.5:1.15) [fill=none,draw=none]  {$c_j$};
\node (z) at (-90:1.15) [fill=none,draw=none]  {$r_k$};
\node (z) at (-68.5:1.15) [fill=none,draw=none]  {$c_\ell$};
\end{tikzpicture} 
\caption[The local edge switch given in Definition \ref{def:switch}]{A Hamilton cycle $H$ containing the edges $r_ic_j$ and $r_kc_\ell$. These edges are not congruent modulo $H$, i.e. $r_ic_j \not\equiv r_kc_\ell \pmod{H}$. We obtain the switch $\sigma(H;r_ic_j,r_kc_\ell)$ from $H$ by removing the thick-red edges and replacing them with the dashed-blue edges.}\label{fig:switch}
\end{figure}

\begin{definition}\label{def:switch}
Suppose $e,f \in H$ and $e\not\equiv f \pmod{H}$, where $e = r_ic_j$ and $f=r_kc_\ell$. The \defn{$\sigma$-switch} of $H$  with respect to $e$ and $f$ is the Hamtilon cycle 
%
\[\sigma(H;e,f):= (H\setminus\{e,f\} )\cup \{r_ic_\ell,r_kc_j\}.\]
\end{definition}
%
 Notice that the condition $e\not\equiv f \pmod{H}$ is necessary, as if $e\equiv f \pmod{H}$ then the corresponding operation would break $H$ into two disjoint cycles. Moreover, $\sigma$-switches are not well-defined for adjacent edges. Figure \ref{fig:switch} contains illustration of the procedure.
 
 
As a first, relatively straightforward application of our switching procedure we consider \defn{Hamilton covers} of latin squares, i.e. \gls{Hamilton cycle}s of the corresponding coloring of $K_{n,n}$ which contain at least one edge of each color. 
%Recall from Section \ref{sec:introplex} that (1) 
More generally, a \defn{cover} of a latin square---introduced by Best et al.\! in \cite{BMSW19}---is a collection of cells which intersects every row and column and contains every symbol. It was shown in \cite{BMSW19} shows that Brualdi's conjecture is equivalent to the conjecture that every latin square of order $n$ has a cover of size at most $n+1$. So, the existence of a Hamilton cover (which has size $2n$) should not be particularly surprising. Nonetheless, it is a nontrivial generalization of Hamilton 2-plexes which offers a chance to ease into use of our local switching procedure.



\begin{theorem}\label{colorfulham}
Every latin square has a Hamilton cover.
\end{theorem}

\begin{proof}
Suppose for the sake of contradiction that there were some latin square $L$ of order $n$ with no Hamilton cover and consider the corresponding proper $n$-edge coloring  $\chi_L:E(K_{n,n})\rightarrow[n]$. Define the weight of a subgraph $G \subseteq K_{n,n}$ as the number of distinct colors it contains; symbolically $w(G) := |\{\chi_L(e) \mid e \in G\}|$. Let $H$ be a Hamilton cycle with maximum weight, say $w(H) = w_0 \leq n-1$. Without loss of generality we may assume $H$ misses color $n$. By relabelling vertices we may assume $H = \{r_1c_1,r_2c_1,r_2c_2,\ldots,r_1c_n\}$, so that the two congruence classes  modulo $H$ are $F_0 := \{r_ic_i  \, : \, i \in [n]\}$ and $F_1 := \{ r_{i+1}c_i \, : \, i \in [n]\}$. We want to find an edge $r_ic_j$ with color $n$ such that $w(H \setminus \{r_ic_i,r_{j+1}c_{j}\}) = w_0$, as the existence of such an edge implies $\sigma(H;r_ic_i,r_{j+1}c_{j})$ has weight $w_0+1$, contradicting the maximality of $w(H)$. 


%\begin{figure}
%\begin{center}4
%\includegraphics[scale=1.2]{ColorfulHamExtend}
%\caption{Removing the red edges and adding the green edges to the given Hamilton cycle yields a new Hamilton cycle.}\label{colorfulhamextend}
%\end{center}
%\end{figure}



For $i \in \{1,2\}$, let $A_i \subseteq [n-1]$ denote the set of colors used exactly $i$ times in $H$. Moreover, let $B \subseteq E(H)$ denote the set of edges whose color is not in $A_1$ (i.e.\! edges whose color is used at least twice $H$). Notice that, as $|E(H)| = 2n$ and $w(H) \leq n-1$, there is some $k \in [2,n]$ such that $|A_1| = n-k$ and $|B| = n+k$. Moreover, because $|A_1|+|A_2| \leq w(H)$, we have $|A_2| \leq k-1$. Given vertex sets $S \subseteq R$ and $T \subseteq C$, we write $E_n(S,T)$ for the set of edges $st \in E(K_{n,n})$ such that $s \in S$, $t \in T$, and $\chi_L(st) = n$.  In particular, we are interested in the sets $U_0:= \{r_i : r_ic_i \in F_0 \cap B\}$ and $U_1 := \{c_j :r_{j+1}c_{j} \in F_1 \cap B\}$. 
%
Because $\chi_L$ is derived from a latin square, both $E_n(U_0,C)$ and $E_n(R,U_1)$ are matchings which perfectly cover $U_i$ (for $i \in \{0,1\}$). In particular, we have $|E_n(U_0,C)| = |U_0|$ and $|E_n(R,U_1)| = |U_1|$. We also know $|U_i| = |F_i \cap B|$ and $B = (F_0 \cap B) \cup (F_1 \cap B)$, so $|U_0|+|U_1| = |B| = n+k$. We can therefore use the principle of inclusion-exclusion to conclude that
%
\begin{align*}
|E_n(U_0,U_1)| &= |E_n(U_0,C) \cap E_n(R,U_1)|\\
&= |E_n(U_0,C)| + |E_n(R,U_1)| - |E_n(U_0,C) \cup E_n(R,U_1)|\\
&\geq |E_n(U_0,C)| + |E_n(R,U_1)| - |E_n(R,C)|\\
& = |U_0|+|U_1|-n\\
&= |B| -n\\
&= k.
\end{align*}
%

It is left to show that, for some $r_ic_j\in E_n(U_0,U_1)$, we have  $w(H \setminus \{r_ic_i,r_{j+1}c_{j}\}) = w_0$. Because $U_0$ and $U_1$ were defined so that $\chi_L(r_ic_i),\chi_L(r_{j+1}c_j) \not\in A_1$, this will be the case unless $\chi_L(r_ic_i) = \chi_L(r_{j+1}c_{j}) \in A_2$. However, as $|A_2| \leq k-1$, we can run into this issue with at most $k-1$ of the (at least) $k$ edges in $E_n(U_0,U_1)$. 
%
\end{proof}

 \section{Hamilton 2-plexes in color-bounded arrays}\label{sec:LLLL}
 
The idea of combining local switching techniques with the Lopsided Lov\'asz Local Lemma (LLLL) to show the existence of \gls{rainbow} perfect matchings and \gls{Hamilton cycle}s in bounded edge-colorings of graphs was introduced by Erd\H{o}s and Spencer \cite{ES91}. The proof of Theorem \ref{thm:LLLLmain} which we provide in this section gives another application of the LLLL in the study of plexes in generalizations of latin squares.

We will use graph-theoretic language throughout this section. To state the version of the LLLL which we will use, we first need to define the type of negative-dependancy graph we will be using. Our definition, as well as our statement of the lemma, follows \cite{CP20}. Given a graph $G$ and vertex $v \in V(G)$, we denote by $N_G[v]$ the closed neighborhood of $v$ (i.e.\! the set containing $v$ and all vertices adjacent to $v$ in $G$). 

%\begin{definition}
%Given a vector ${\bf p} = (p_1,p_2,\ldots,p_k) \in (0,1)^k$ and a set $\mathcal{A} = \{A_1,A_2,\ldots,A_k\}$ of events in some probability space, a graph $D = (V,E)$ is a \defn{${\bf p}$-dependency graph} for $\mathcal{A}$ if $V = [k]$ and for each $i \in [n]$ and each $S \subseteq V \setminus N_D[i]$ satisfying  $\Pr(\cap_{j \in S} \overline{A_j}) >0$ we have
%%
%\[ \Pr( A_i \, | \, \cap_{j \in S} \overline{A_j}) \leq p_i.\]
%\end{definition}

\begin{definition}
Given $p  \in (0,1)$ and a set $\mathcal{A} = \{A_1,A_2,\ldots,A_k\}$ of events in some probability space, a graph $D = (V,E)$ is a \defn{$p$-dependency graph} for $\mathcal{A}$ if $V = [k]$ and, for each $i \in [k]$ and each $S \subseteq V \setminus N_D[i]$ satisfying  $\Pr(\cap_{j \in S} \overline{A_j}) >0$, we have
%
\[ \Pr( A_i \, | \, \cap_{j \in S} \overline{A_j}) \leq p.\]
\end{definition}
%

It is possible to state the LLLL in more generality than we will below. We state only the ``symmetric'' version because it is sufficient to prove Theorem \ref{thm:LLLLmain}. For a proof, as well as the more general statement, see \cite[Ch.\! 5]{ASBook}.

\begin{lemma}[$p$-Lopsided Lov\'asz Local Lemma] \label{pLLLL}
Given $p \in (0,1)$, let $D$ be a $p$-dependency graph for the collection $\mathcal{A} = \{A_1,A_2,\ldots,A_k\}$. If $D$ has maximum degree $\Delta$ and $4p\Delta \leq 1$, then 
%
\[ \Pr\left(\cap_{j \in [k]} \overline{A_j}\right) >0.\]
\end{lemma}

%As is common in applications of the local lemma, our proof will utilize a local switching procedure between globally similar Hamtilon cycles. We identify a Hamilton cycle with the set of edges comprising it. Let $(X,Y)$ denote the bipartition of $K_{n,n}$, where $X = \{x_1,\ldots,x_n\}$ and $Y = \{c_1,\ldots,c_n\}$. We define a notion of congruence on $H$ as follows: for $x_ic_j,x_kc_\ell \in H$, we say that $x_ic_j \equiv x_kc_\ell \pmod{H}$ if, cyclically orienting $H$ in the direction from $x_i$ to $c_j$, we reach $x_k$ before $c_\ell$. As every Hamilton cycle $H$ in $K_{n,n}$ has an even number of vertices, this notion is well-defined and it divides $H$ into two equivalence classes of size $n$.  
%
%Suppose $e,f \in H$ but $e\not\equiv f \pmod{H}$, where $e = x_ic_j$ and $f=x_kc_\ell$. The \defn{switch} of $H$  with respect to $e$ and $f$ is the Hamtilon cycle $\sigma(H;e,f):= (H\setminus\{e,f\} )\cup \{x_ic_\ell,x_kc_j\}$. Notice that the condition $e\not\equiv f \pmod{H}$ is necessary, as if $e\equiv f \pmod{H}$ then the corresponding operation would yield two disjoint cycles. Moreover, it is not possible to switch adjacent edges. See Figure \ref{fig:switch} for an illustration of the procedure.

%\begin{figure}
%\begin{center}
%\includegraphics[scale=0.8]{switch}
%\caption{We obtain the switch $\sigma(H;x_ic_j,x_kc_\ell)$ from $H$ by removing the red edges and replacing them with the green edges.}\label{fig:switch}
%\end{center}
%\end{figure}


Although the following proof was initially inspired by a paper of Albert, Frieze, and Reed \cite{AFR95} concerning \gls{rainbow} Hamilton cycles, the current presentation---in particular the use of an auxilliary bipartite graph to establish that our claimed $p$-dependency graph is indeed a $p$-dependency graph---follows \cite[Section 3]{CP20}. Although the statement of Theorem \ref{thm:LLLLmain} above concerns \gls{$k$-bounded $n$-square}s, we prove the equivalent statement that there exists a \gls{2-bounded} Hamilton cycle in every $\frac{n}{\sqrt{96}}$-bounded edge-coloring of $K_{n,n}$. 


\begin{proof}[Proof of Theorem \ref{thm:LLLLmain}]
Let $c = \sqrt{96}$, fix a $\frac{n}{c}$-bounded proper edge-coloring of $K_{n,n}$, and let $\mathcal{T}$ denote the set of all monochromatic (unordered) edge triples in this coloring. The set $\mathcal{T}$ has a natural tripartition into three sets according to the structure of the corresponding induced subgraphs: let $\mathcal{T}_0$ denote the set of monochromatic matchings of size 3, $\mathcal{T}_1$ the set of monochromatic copies of $K_2 \cup P_3$, and $\mathcal{T}_2$ denote the monochromatic paths of length 3. Now, select a Hamilton cycle $H$ uniformly at random from among the $\frac{n!(n-1)!}{2}$ Hamilton cycles in $K_{n,n}$. For each triple $\{e,f,g\} \in \mathcal{T}$, let $A_{efg}$ denote the event that $e$, $f$, and $g$ all belong to $H$ and let $\mathcal{A} = \{A_{efg} \,:\, \{e,f,g\} \in \mathcal{T}\}$. Observe that $H$ is \gls{2-bounded} if and only if the event $\bigcup_{A \in \mathcal{A}} \overline{A}$ holds. Thus,  $\Pr(\bigcup_{A \in \mathcal{A}} \overline{A})>0$ implies the existence of a 2-bounded Hamilton cycle. 

%\begin{figure}
%\centering
%\begin{tikzpicture}
%\foreach \i in {-1,...,1}
%\draw (-5.5,\i)--(-3.5,\i);
%
%\draw (-1.5,1)--(0.5,1);
%\draw (-1.5,0)--(0.5,1);
%\draw (-1.5,-1)--(0.5,-1);
%
%
%\end{tikzpicture}
%\end{figure}

Arbitrarily order $\mathcal{T} = \{T_1,T_2,\ldots,T_k\}$ and $\mathcal{A} = \{A_1,A_2,\ldots,A_k\}$ so that the event $A_i$ corresponds to the triple $T_i$. Let $D$ be the graph with $V(D) = [k]$ and edges defined by $ij \in E(D)$ if and only if some vertex is incident to both an edge in $T_i$ and an edge in $T_j$. To see that
%
\begin{equation} \Delta = \Delta(D) \leq  \frac{3n(2n-1)(n-c)}{2c^2},\label{eq:LLLLDelta}\end{equation}
%
observe that each edge in $K_{n,n}$ is adjacent to $2n-1$ other edges and, given $T \in \mathcal{T}$ and any edge $e \in E(K_{n,n})$ which is adjacent to at least one of the edges in $T$, there are at most $\binom{n/c}{2}$ monochromatic triples containing $e$. 

Let $p = \frac{8}{(n-4)^3+6(n-3)^2}$. To establish the desired result it suffices to show that $D$ is a $p$-dependency graph for $\mathcal{A}$. Indeed, if $D$ is a $p$-dependency graph, then $\Pr(\bigcup_{A \in \mathcal{A}} \overline{A})>0$ follows from Lemma \ref{pLLLL} and the fact that
%
\[ 4p\Delta \leq \frac{96}{2c^2}\frac{n(2n-1)(n-c)}{(n-4)^3+6(n-3)^2} =   \frac{2n^3-(2c+1)n^2+cn}{2n^3-12n^2+24n-20} \leq 1,\]
%
where the last inequality holds for all $n \geq 1$ because $c=\sqrt{96}\approx 9.798$. Towards showing that $D$ is a $p$-dependancy graph, fix an arbitrary $x \in [k]$, let $T_x = \{e,f,g\}$, and fix a set $S \subseteq V(D) \setminus N_D[x]$ satisfying  $\Pr(\cap_{j \in S} \overline{A_j}) >0$. We will call a Hamilton cycle \defn{$S$-good} if it satisfies $\cap_{j \in S} \overline{A_j}$; equivalently, $H$ is an $S$-good Hamilton cycle if $T_j \not \subseteq H$ for all $j \in S$. Notice that, because $S$ is comprised of non-neighbors of $x$, any graph obtained from an $S$-good graph via a series of $\sigma$-switches introducing edges adjacent to one of $e$, $f$, or $g$ must also be $S$-good. %because $S \subseteq V(D) \setminus N_D[r]$ and $ij \in E(D)$ if and only if some edge in $T_i$ intersects some edge in $T_j$. 

Let $\mathcal{H}$ denote the collection of $S$-good Hamilton cycles and, for each $i \in [0,3]$, let $\mathcal{H}_i$ denote those $S$-good Hamilton cycles $H$ satisfying $| H \cap T_x| = i$. In particular, $\mathcal{H}_3$ denotes the set of $S$-good Hamilton cycles for which $A_x$ holds, so that
%
$\Pr( A_x \, | \, \cap_{j \in S} \overline{A_j}) = \frac{|\mathcal{H}_3|}{|\mathcal{H}|}$. We would like to show that
%
\begin{equation} \frac{|\mathcal{H}|}{|\mathcal{H}_3|} \geq \frac{|\mathcal{H}_0|}{|\mathcal{H}_3|} + \frac{|\mathcal{H}_1|}{|\mathcal{H}_3|} \geq \frac{(n-4)^3}{8} + \frac{3(n-3)^2}{4}  = \frac{1}{p} .
\label{eq:recipP}\end{equation}

\begin{figure}[t]
\centering
\begin{subfigure}[b]{0.45\textwidth}
\begin{tikzpicture}[scale=2.5,auto=left,every node/.style={circle,draw,thick,fill=black,minimum size=1pt}]
\draw [thick] (0,0) circle (1cm);
\draw [red,thick,domain=90:68.5] plot ({cos(\x)}, {sin(\x)});
\draw [red,thick,domain=-112.5:-68.5] plot ({cos(\x)}, {sin(\x)});
\draw [red,thick,domain=180:202.5] plot ({cos(\x)}, {sin(\x)});
\draw [red,thick,domain=135:157.5] plot ({cos(\x)}, {sin(\x)});
\draw [red,thick,domain=22.5:45] plot ({cos(\x)}, {sin(\x)});
\draw[blue,thick,densely dashed] (90:1)--(202.5:1);
\draw[blue,thick,densely dashed] (180:1)--(68.5:1);
\draw[blue,thick,densely dashed] (-68.5:1)--(135:1);
\draw[blue,thick,densely dashed] (-90:1)--(157.5:1);
\draw[blue,thick,densely dashed] (45:1)--(-112.5:1);
\draw[blue,thick,densely dashed] (-90:1)--(22.5:1);
\foreach \i in {1,...,8}{ 
\node (z) at (45*\i:1) [fill=white,minimum size=1pt] {};
\node (z) at (45*\i+22.5:1) {};
}
\node (z) at (79.75:1.15) [fill=none,draw=none]  {$e$};
\node (z) at (191.25:1.15) [fill=none,draw=none]  {$e'$};
\node (z) at (-79.75:1.15) [fill=none,draw=none]  {$f$};
\node (z) at (146.25:1.15) [fill=none,draw=none]  {$f'$};
\node (z) at (-100.75:1.15) [fill=none,draw=none]  {$g$};
\node (z) at (33.75:1.15) [fill=none,draw=none]  {$g'$};
\end{tikzpicture} 
\caption{A choice of edges $e'$, $f'$, and $g'$ such that, if $H$ is the cycle on black and thick-red edges, then the cycle $\sigma(\sigma(\sigma(H;e,e');f,f');g,g')$ on dashed-blue and black edges is $S$-good.}\label{fig:switchforward}
\end{subfigure}
%
%
%
\hfill
%
%
%
\begin{subfigure}[b]{0.45\textwidth}
\begin{tikzpicture}[scale=2.5,auto=left,every node/.style={circle,draw,thick,fill=black,minimum size=1pt}]
\draw [thick] (0,0) circle (1cm);
\draw[thick,blue, densely dashed] (90:1)--(-68.5:1);
\draw[thick,orange,densely dotted] (-90:1)--(68.5:1);
\draw[thick,green, densely dashdotted] (112.5:1)--(-45:1);

\foreach \i in {1,...,8}{ 
\node (z) at (45*\i:1) [fill=white,minimum size=1pt] {};
\node (z) at (45*\i+22.5:1) {};
}
\node (z) at (90:0.7) [fill=none,draw=none]  {\textcolor{blue}{$g$}};
\node (z) at (-100.75:1.15) [fill=none,draw=none]  {\textcolor{white}{$g$}};
\node (z) at (-79.75:1.15) [fill=none,draw=none]  {\textcolor{white}{$f$}};
\end{tikzpicture} 
\caption{If $\sigma(\sigma(\sigma(H;e,e');f,f');g,g')$ is the cycle on black edges and $g$ is the dashed-blue edge, then $g'$ could have been either the dotted-orange edge or the dash-dotted-green edge.}\label{fig:switchbackward}
\end{subfigure}


\caption[The iterated edge switches used in the proof of Theorem \ref{thm:LLLLmain}]{An illustration of the switches used to prove  $\delta_0(\mathcal{H}_3) \geq (n-4)^3$ and $\Delta_0(\mathcal{H}_0) \leq 8$.}
\label{fig:bigswitch}
\end{figure}

To establish \eqref{eq:recipP} we construct two auxiliary bipartite \gls{multigraph}s, $G_0$ and $G_1$, with vertices corresponding to Hamilton cycles of $K_{n,n}$. Specifically, for $i \in \{0,1\}$, the \gls{bipartition} defining $V(G_i)$ is $(\mathcal{H}_3,\mathcal{H}_i)$. Adjacency in $G_0$ is defined by adding an edge between $H \in \mathcal{H}_3$ and $H' \in \mathcal{H}_0$ for each ordered triple $(e',f',g')$ such that  $e',f',g' \in H$ and $H' = \sigma(\sigma(\sigma(H;e,e');f,f');g,g')$.  See Figure \ref{fig:bigswitch}(\subref{fig:switchforward}) for an example of such an iterated switch. Similarly, in $G_1$ we add an edge between $H \in \mathcal{H}_3$ and $H' \in \mathcal{H}_1$ if one of the following three conditions holds: (1) there exist $e',f'\in H$ such that $H' = \sigma(\sigma(H;e,e');f,f')$, (2) there exist $e',g'\in H$ such that $H' = \sigma(\sigma(H;e,e');g,g')$, or (3) there exist $f'g'\in H$ such that $H' = \sigma(\sigma(H;f,f');g,g')$. We write $\delta_i(\mathcal{H}_3)$ for the minimum degree of a vertex in the part of $G_i$ corresponding to $\mathcal{H}_3$ and $\Delta_i(\mathcal{H}_i)$ for the maximum degree of a vertex in the part corresponding to $\mathcal{H}_i$.

 
 By double counting the edges in $G_i$, for $i \in \{0,1\}$, we see that $\delta_i(\mathcal{H}_3)|\mathcal{H}_3| \leq \Delta_i(\mathcal{H}_i)|\mathcal{H}_i|$, so $\frac{|\mathcal{H}_i|}{|\mathcal{H}_3|} \geq \frac{\delta_i(\mathcal{H}_3)}{\Delta_i(\mathcal{H}_i)}$. To determine $\delta_0(\mathcal{H}_3)$, consider an arbitrary $H \in \mathcal{H}_3$. In choosing $e'$ we may not select either of the edges adjacent to $e$, nor may we select $f$ or $g$. This forbids at most 4 possible choices of $e'$; any other edge in $H$ which is not congruent to $e$ modulo $H$ is a valid choice. Therefore, we have at least $n-4$ choices for $e'$. 
 
 As we are only looking for a lower bound for $\delta_0(\mathcal{H}_3)$, we may choose to avoid selecting for $f'$ either of the edges in $\sigma(H;e,e')$ adjacent to both $e$ and $e'$, say $e''$ and $e'''$. We do this ensure that we do not reintroduce $e$ when switching on $f$ and $f'$. Observe that exactly one of $e''$ and $e'''$ is not congruent to $f$ modulo $\sigma(H;e,e')$, so that our choice eliminates exactly one option. Furthermore, as above, we may not select as $f'$ either of the edges adjacent to $f$ in $\sigma(H;e,e')$ and, if $g \not\equiv f \pmod{\sigma(H;e,e')}$, we may not select $g$ for $f'$. These are again the only possible obstructions, giving us at least $n-4$ valid choices for $f'$. 
 
 Finally, in choosing $g'$, we will not select $e''$ or $e'''$, nor may we select the analogously defined $f''$ and $f'''$. This eliminates exactly two of the $n$ edges not congruent to $g$ modulo $\sigma(\sigma(H;e,e');f.f')$. As the only other edges we may not select are those adjacent to $g$ in $\sigma(\sigma(H;e,e');f.f')$, we have at least $n-4$ choices for $g'$. This shows that $\delta_0(\mathcal{H}_3) \geq (n-4)^3$. The proof that $\delta_1(\mathcal{H}_3) \geq 3(n-3)^2$ is essentially identical, with the factor of 3 coming from the fact that we have 3 choices for which of $e$, $f$, and $g$ will not be involved in a $\sigma$-switch.
 
 To determine $\Delta_0(\mathcal{H}_0)$, consider an arbitrary $H' \in \mathcal{H}_0$. Let $g=r_0c_0 \not\in H$ and notice that  $H'\setminus\{r_0,c_0\}$ has two connected components. Moreover, there are two edges incident to $r_0$ in $H'$, say $r_0c_1$ and $r_0c_2$, and two edges incident to $c_0$, say $r_1c_0$ and $r_2c_0$, where $r_1$ and $c_1$ are in one component of $H'\setminus\{r_0,c_0\}$ and $r_2$ and $c_2$ are in the other. If there is some $H \in \mathcal{H}_3$ for which $H' = \sigma(\sigma(\sigma(H;e,e');f,f');g,g')$, then we may obtain $\sigma(\sigma(H;e,e');f,f')$ from $H'$ by switching on either $r_1c_0$ and $r_0c_2$ or on $r_2c_0$ and $r_1c_2$ (see Figure \ref{fig:bigswitch}(\subref{fig:switchbackward})). Thus, there are two possible choices for $\sigma(\sigma(H;e,e');f,f')$.  Similarly, for each choice of  $\sigma(\sigma(H;e,e');f,f')$, there are two possibilities for  $\sigma(H;e,e')$, obtained by selecting one of the two edges crossing $f$ in $\sigma(\sigma(H;e,e');f,f')$ to be $f'$. Finally, for each choice of $\sigma(H;e,e')$ we get two choices for $H$ in a similar manner. In total, this gives us at most $8$ options for $H \in N_{G_0}(H')$, and a similar argument tells us that $\Delta_1(\mathcal{H}_1) \leq 4$, completing the proof.
 %
\end{proof}







\section{Proof of Theorem \ref{thm:partplex}}\label{sec:egjstuff}

Over the next two sections we will prove Theorem \ref{thm:partplex} and its analogues for Hamilton plexes. 
These proofs all utilize the rainbow blow-up lemma of Ehard, Glock, and Joos \cite{EGJ20}. To state this fairly technical lemma, we first need to introduce some terminology. Throughout the rest of this chapter, given $n \in \mathbb{N}$ and $\varepsilon>0$ we write $(1 \pm \varepsilon)n$ for the interval $\left((1-\varepsilon)n,(1+\varepsilon)n\right)$. Following \cite{EGJ20}, we say that a bipartite graph $G$ with \gls{bipartition} $(V_1,V_2)$ is \defn{$(\gamma,d)$-super-regular} if
%
\begin{itemize}
\item for all $S \subseteq V_1$ and $T \subseteq V_2$ with $|S| \geq \gamma|V_1|$, $|T| \geq \gamma|V_2|$, we have $e(S,T) \in (d \pm \gamma)|S||T|$,
\item and for all $i \in [2]$ and $x \in V_i$, we have $\deg(x) \in (d \pm \gamma)|V_{3-i}|$.
\end{itemize}
%
Moreover, we refer to $(H,G,(X_i)_{i=1}^\ell,(V_i)_{i=1}^\ell)$ as a \defn{$(\gamma,d)$-super-regular blow-up instance} if
%
\begin{itemize}
\item $G$ and $H$ are graphs, $(X_i)_{i=1}^\ell$ and $(V_i)_{i=1}^\ell$ are partitions of $V(H)$ and $V(G)$, respectively, such that $|X_i| = |V_i|$ for all $i \in [\ell]$, and 
\item for all $ij \in \binom{[\ell]}{2}$, the subgraph of $G$ induced by $E(V_i,V_j)$ is $(\gamma,d)$-super-regular.
\end{itemize}
%
We call an edge-coloring \defn{locally $\Lambda$-bounded} if each vertex is incident to at most $\Lambda$ edges of each color. Finally, if $\chi$ is an edge-coloring of $G$, we say that $\phi: V(H) \rightarrow V(G)$ is a \defn{rainbow embedding} of $H$ into $G$ if $\phi$ is injective, $\phi(x)\phi(y) \in E(G)$ for all $xy \in E(H)$, and the multiset $\{\chi(\phi(x)\phi(y)) \, | \, xy \in E(H)\}$ has no repeated elements. When there is a chance of confusion, we will write $e_G^a(S,T)$ to denote the number of edges in $G$ with color $a$, one end in $S$, and the other end and $T$, and $e_H(S,T)$ to denote the number of edges in $H$ with one end in $S$ and the other end in $T$. We may now state the rainbow blow-up lemma.

\begin{lemma}[Ehard et al. \cite{EGJ20}]
For all $d,\varepsilon \in (0,1]$ and $\Delta,\Lambda,\ell \in \mathbb{N}$, there exist $\gamma>0$ and $n_0 \in \mathbb{N}$ such that the following holds for all $n \geq n_0$. Suppose $(H,G,(X_i)_{i=1}^\ell,(V_i)_{i=1}^\ell)$ is a $(\gamma,d)$-super-regular blow-up instance. Assume further that
 \renewcommand{\labelenumi}{(\roman{enumi})} 
\begin{enumerate}
\item $\Delta(H) \leq \Delta$;
\item $|V_i| \in (1 \pm \gamma)n$ for all $i \in [\ell]$;
\item $\chi: E(G) \rightarrow [q]$ is a locally $\Lambda$-bounded edge-coloring such that the following holds for all $a \in [q]$:
%
\begin{equation} \sum_{ij \in \binom{[\ell]}{2}} e_G^a(V_i,V_j) e_H(X_i,X_j) \leq (1-\varepsilon)dn^2.\label{eq:EGJ}\end{equation}
%
\end{enumerate}
Then there exists a rainbow embedding $\phi$ of $H$ into $G$ such that $\phi(x) \in V_i$ for all $i \in [\ell]$ and all $x \in X_i$.
\label{thm:EGJ} \end{lemma}

Rather than using the full power of the rainbow blow-up lemma repeatedly below, we will use the following more concise corollary which applies to the proper colorings of dense \gls{balanced bipartite} graphs we will be considering.


\begin{corollary}\label{cor:EGJ}
For all $\varepsilon \in (0,1]$ and all $\Delta \in \mathbb{N}$, there exists $n_0 \in \mathbb{N}$ such that for all $n \geq n_0$ the following holds. If $G$ and $H$ are \gls{balanced bipartite} graphs of order $2n$ satisfying $\Delta(H) \leq \Delta$ and $\delta(G) \geq n-n^{3/4}$, then every $(1-\varepsilon)n^2/e(H)$-bounded proper edge-coloring of $G$ contains a rainbow copy of $H$. 
\end{corollary}

\begin{proof}
Let $d=\Lambda=1$, let $\ell=2$, and let $\varepsilon$ and $\Delta$ be as in the hypotheses of this theorem. Plugging these values into Lemma \ref{thm:EGJ}, we obtain $n_0 \in \mathbb{N}$ and $\gamma>0$. Then, fix $n \geq \max\{n_0,\gamma^{-4}\}$ and let $(R,C)$ and $(X,Y)$ denote, respectively, the \gls{bipartition}s of $G$ and $H$. We claim that $(H,G,(X,Y),(R,C))$ is a $(\gamma,1)$-super-regular blow-up instance. By definition, we have $|R|=|C|=|X|=|Y|=n$, so it suffices to show that $G$ is $(\gamma,1)$-super-regular. Indeed, because  $n \geq \gamma^{-4}$, for all $v \in V(G)$ we have $\deg (v) \in [n-n^{3/4},n] \subseteq (1 \pm \gamma)n$. Moreover, for any $S \subseteq R$ and $T \subseteq C$ satisfying $|S|,|T| \geq \gamma n$, we have
%
\[ \frac{e(S,T)}{|S||T|} \geq \frac{|S||T|-|S|n^{3/4}}{|S||T|} \geq 1- n^{-1/4} \geq 1-\gamma. \]
%
This proves the claim. To complete the proof, notice that proper colorings are locally 1-bounded and, for our particular blow up instance, \eqref{eq:EGJ} is equivalent to the statement that $G$ is $(1-\varepsilon)n^2/e(H)$-bounded. Therefore, we may apply Lemma \ref{thm:EGJ} to find a rainbow copy of $H$ in $G$.
%
\end{proof}




Now, because we are looking for $k$-bounded subgraphs in $K_{n,n}(L)$, rather than rainbow ones, we need to decompose $K_{n,n}(L)$ into balanced subgraphs before applying Corollary \ref{cor:EGJ}. We find such a decomposition exists for all sufficiently large latin squares using the following form of the Chernoff bound (for a proof, see \cite{MiUpBook}). Recall that a random variable $X$ has a binomial distribution $\Bin(n,p)$ for $n \in \mathbb{N}$ and $p \in (0,1)$ if $\Pr(X = k) = \binom{n}{k} p^k(1-p)^{n-k}$ for all $k \in [0,n]$. 

\begin{theorem}[The Chernoff bound]
Let $X$ be a random variable with distribution $\Bin(n,p)$ and write $\mu := \E(X) = np$. For any $\varepsilon >0$, we have
%
\[ \Pr\left( \left| X - \mu \right| \geq \varepsilon \mu\right) \leq 2e^{-\varepsilon^2\mu/3}.\]
\end{theorem}

The following decomposition lemma comes from a standard application of the Chernoff bound, similar to multiple applications appearing in \cite{EGJ20}. 


\begin{lemma}
For all $\varepsilon >0$ and all $k \geq 2$, there exists $n_0 \in \mathbb{N}$ such that the following holds for all $n \geq n_0$. For every latin square $L$ of order $n$, there are \gls{equipartition}s $\left\{ R_i \right\}_{i=1}^k \vdash$ \acrshort{RL} and $\left\{ C_i \right\}_{i=1}^k \vdash $\acrshort{CL} such that, for all $(i,j) \in [k]^2$ and all symbols $t \in [n]$, the number of copies of $t$ in the latin subarray $A_{i,j} := L[R_i \times C_j]$ lies in the interval $\left(1 \pm \varepsilon\right)\frac{n}{k^2}$. 
\label{lemma:LSpart}\end{lemma}

\begin{proof}
Let $n_1 := \left\lceil\frac{n}{k}\right\rceil$, $n_2 :=\left\lfloor\frac{n}{k}\right\rfloor$, and $\ell := n \pmod{k}$. We want to find $\left\{ R_i \right\}_{i=1}^k \vdash$ \acrshort{RL} and $\left\{ C_i \right\}_{i=1}^k \vdash$\acrshort{CL} satisfying $|R_i| = |C_i| = n_1$ for $i \in [\ell]$ and $|R_i| = |C_i| = n_2$ for $i \in [k]\setminus [\ell]$. We do so probabilistically, independently assigning each $r\in R(L)$ and each $c \in C(L)$ a uniformly random value from $[k]$. This means that, for all $i \in [k]$, the random variables $|R_i|$ and $|C_i|$ are binomially distributed and, because we may assume $n$ is sufficiently large while $k$ is fixed, the DeMoivre-Laplace approximation (see \cite[Sec. 9.2]{MiUpBook}) gives
%
%
\begin{equation*} \Pr\left(|R_i|=n_j\right), \Pr\left(|C_i| = n_j\right) = \Omega(n^{-1/2})\label{eq:ch1}\end{equation*}
%  
for all $j \in [2]$.

Now, for each symbol $t \in [n]$ and each $i,j \in [k]$, let $S_{i,j}^{(t)}$ be a random variable giving the number of occurrences of $t$ in $A_{i,j}$.  Fixing arbitrary $i$, $j$, and $t$, we can further decompose $S_{i,j}^{(t)}$ into indicator variables $S_{i,j}^{(t)} = \sum_{r \in R(L)} X_r$, where $X_r = 1$ if the unique cell with symbol $t$  in row $r$  of $L$ appears in $A_{i,j}$. Notice that the $X_r$ are independent with mean $\frac{1}{k^2}$. This means $S_{i,j}^{(t)} \sim \Bin\left(n,\frac{1}{k^2}\right)$, and the Chernoff bound gives 
%
\begin{equation*} \Pr\left(\left|S_{i,j}^{(t)} - \frac{n}{k^2}\right| \geq \frac{\varepsilon n}{k^2}\right) \leq 2e^{-\varepsilon^2n/3k^2}.\label{eq:ch2}\end{equation*}
%

Bringing everything together, we see that our random partitions fail to have the desired properties with probability at most
%
\[ 1- \alpha n^{-k^2/2} + 2nk^2e^{-\varepsilon^2n/3k^2},\]
%
for some constant $\alpha$, and this probability is less than 1 for sufficiently large $n$.
\end{proof}



%Because we are only interested in dense balanced bipartite graphs, the special case of Theorem \ref{thm:EGJ} which we will use below does not involve any discussion of quasirandomness. Notice that, if $G$ is a balanced bipartite graph on $m=2n$ vertices with minimum degree $\delta(G) \geq (1-\gamma)n$ for some $\gamma \in (0,1)$, then $G$ is $(1/2,\gamma)$-quasirandom. Moreover, locally 1-bounded colorings are equivalent to proper colorings. We will also make the aesthetic choice of transposing the roles of $\gamma$ and $\varepsilon$ in our statement so that in the ensuing exposition $\varepsilon$ may retain its role as the most commonly used small constant.The following is the case of Theorem 1.3 from \cite{EGJ20} which we will use to prove Theorem \ref{thm:partplex}.





Proving Theorem \ref{thm:partplex}(a) now amounts to combining Lemma \ref{lemma:LSpart} with Corollary \ref{cor:EGJ} to establish the following, more general result. Recall that, for a square array $A$, we use $|A|$ to denote the order of $A$, which is equal to its number of rows. 

\begin{theorem}\label{thm:technicalpart}
For all integers $k \geq 1$ and all $\varepsilon \in (0,1]$, there exists $n_0 \in \mathbb{N}$ such that the following holds for all $n \geq n_0$. Let $L$ be a latin square of order $n$,  write $(R,C)$ for the vertex bipartition of $K_{n,n}(L)$, and let $\left\{H_i\right\}_{i=1}^k$ be a collection of \gls{balanced bipartite} graphs. If
 \renewcommand{\labelenumi}{(\roman{enumi})} 
\begin{enumerate}
\item $\left\{ V(H_i) \cap R \right\}_{i=1}^k$ is an \gls{equipartition} of $R$, 
\item $\Delta(H_i) \leq k$, and
\item $e(H_i) \leq (1-\varepsilon)n$ for all $i \in [k]$, 
\end{enumerate}
then $L$ has a partial $k$-plex isomorphic to $\bigcup_{i=1}^k H_i$.
\end{theorem}

\begin{proof}
Assume $n$ is sufficiently large and let $L$ be a latin square of order $n$. Denote by $\left(A_{i,j}\right)_{i,j \in [k]}$ the partition of $L$ into latin subarrays given by Lemma \ref{lemma:LSpart}, so that each symbol appears at most $\left(1+\varepsilon\right)\frac{n}{k^2}$ times in each $A_{i,j}$. Fixing an arbitrary $i \in [k]$, set $\ell= |A_{i,i}|$. Because $\ell \geq \lfloor n/k \rfloor$ and we may assume $n$ is large enough for $\frac{n^2}{(n-k)^2} \leq \frac{1-\varepsilon^2/2}{1-\varepsilon^2}$ to hold, we have
%
\[\frac{ \left(1-\varepsilon^2/2\right)\ell^2}{e(H_i)} \geq \frac{(1-\varepsilon^2/2)\ell^2}{(1-\varepsilon)n} \geq \frac{(1-\varepsilon^2/2)(n-k)^2}{(1-\varepsilon)nk^2} \geq  \frac{\left(1+\varepsilon\right)n}{k^2}.  \]
%
We may therefore apply Corollary \ref{cor:EGJ} to find a rainbow copy of $H_i$ in $K_{\ell,\ell}(A_{i,i})$. It follows that $\bigcup_{i=1}^kH_i$ is a $k$-bounded subgraph of $K_{n,n}(L)$ with maximum degree at most $k$, and as such its edges correspond to the cells of the desired $k$-plex.
\end{proof}

A partial Hamilton 2-plex is a 2-bounded union of paths in $K_{n,n}(L)$. By letting $k=2$ and both $G_1$ and $G_2$ be the union of a path of order $(1-\varepsilon)n$ and however many isolated vertices are needed to satisfy condition (i) in Theorem \ref{thm:technicalpart}, we obtain the following approximation of Conjecture \ref{conj:main}.

\begin{corollary}
Every latin square has a partial Hamilton 2-plex of size $2n-o(n)$. 
\end{corollary}

We can complete the proof of Theorem \ref{thm:partplex} with an argument very similar to the one used to prove Theorem \ref{thm:technicalpart}. 

\begin{proof}[Proof of Theorem \ref{thm:partplex}(b)]
Let $L$ be a latin square of sufficiently large order $n$, fix $\varepsilon=\frac{1}{2k+2}$, and partition $L$ into the latin subarrays $\left(A_{i,j}\right)_{i,j \in [k+1]}$ via Lemma \ref{lemma:LSpart}, so that each symbol appears at most $\left(1+\varepsilon\right)\frac{n}{(k+1)^2}$ times in each $A_{i,j}$. Fixing $i \in [k+1]$, let $\ell = |A_{i,i}|$ and let $G_i$ be a $k$-regular spanning subgraph of $K_{\ell,\ell}$. Because we may assume $n \geq (k+1)(2k+1)$, we have
%
\begin{align*}
\frac{ \left(1-\varepsilon^2\right)\ell^2}{e(G_i)} = \frac{(1-\varepsilon^2)\ell}{k} &\geq \frac{(1-\varepsilon^2)(n-k-1)}{k(k+1)}\\
& = \frac{(1+\varepsilon)(2k+1)(n-k-1)}{2k(k+1)^2} \geq  \frac{\left(1+\varepsilon\right)n}{(k+1)^2}.  
\end{align*}
%
It then follows from Corollary \ref{cor:EGJ} that there is a \gls{rainbow} copy of $G_i$ in $K_{\ell,\ell}(A_{i,i})$. The subgraph $\bigcup_{i=1}^{k+1} G_i \subseteq K_{n,n}(L)$ is the desired $(k,k+1)$-plex.
 \end{proof}
 
 \section{Further explorations of $(k,\ell)$-plexes}
 
 \label{sec:fe}

For the rest of this chapter we restrict out attention to $(k,\ell)$-plexes, starting with the Hamilton analogue of the $k=2$ case of Theorem \ref{thm:partplex}(b). Unfortunately, this proof is nowhere near as direct as the Hamilton extension of the $k=2$ case of Theorem \ref{thm:partplex}(a). We will utilize a theorem of Alon, Pokrovskiy, and Sudakov which shows that the graph  formed by the edges from a random selection of color classes in a proper edge-coloring of $K_{n,n}$ has strong expansion properties. In order to give a restatement of Theorem 5.1 from \cite{APS17} we must provide two additional definitions: an event occurs ``with high probability'' if the probability of its occurring is $1-o(1)$ and, for functions $f(n)$ and $g(n)$, the symbol $f \gg g$ means $\lim_{n\rightarrow \infty} f/g = \infty$.

\begin{theorem}[Alon, Pokrovskiy, and Sudakov \cite{APS17}]\label{thm:APS}
Given a proper edge-coloring of $K_{n,n}$ with bipartition classes $R$ and $C$, let $G$ be a subgraph obtained by choosing every color class randomly and independently with probability $p$. Then, with high probability, all vertices in $G$ have degree $(1-o(1))np$ and for every two subsets $A \subseteq R, B \subseteq C$ of size $x \gg \left(\log n/p\right)^2$, $e_G(A,B) \geq (1-o(1))px^2$.
\end{theorem}
%
By setting $p=n^{-1/3}$, setting  $x = \left\lceil\frac{n}{10}\right\rceil$, and using the fact that $\frac{(1-\varepsilon)n^{5/3}}{100} \geq n^{3/2}$ for any $\varepsilon \in (0,1)$ and all sufficiently large $n$, we obtain the following corollary tailored to our particular application. Note that, in the case where $|A|$ or $|B|$ is strictly greater than $\left\lceil\frac{n}{10}\right\rceil$, we can apply Theorem \ref{thm:APS} to arbitrary subsets $A' \subseteq A$ and $B' \subseteq B$ satisfying $|A'|=|B'| = \left\lceil\frac{n}{10}\right\rceil$ to get the desired result.

\begin{corollary}\label{cor:APS}
For every latin square $L$ of sufficiently large order $n$, there is a set $T \subseteq $ \acrshort{SL} of size $\lfloor n^{2/3}\rfloor$ such that, for every pair of sets $A\subseteq R(L)$ and $B \subseteq C(L)$ satisfying $|A|,|B| \geq \frac{n}{10}$, we have $e_T(A,B) \geq n^{3/2}$ in $K_{n,n}(L)$.
\end{corollary}

%Corollary \ref{cor:APS} is a much more powerful tool than we will need; it will be clear from the proof of Theorem \ref{thm:23plex} that we only need $e_T(A,B) >0$ to obtain the desired result. However, it is unclear whether there is a proof of this simpler lower bound which is shorter or more elementary than the proof of Corollary \ref{cor:APS}. 

Now, combining Corollary \ref{cor:APS} with the full power of Corollary \ref{cor:EGJ}---rather than just the special case where the host graph is $ K_{n,n}$---we prove this chapter's third main result.

\begin{theorem}
Every sufficiently large latin square has a Hamilton $(2,3)$-plex.
\label{thm:23plex}\end{theorem}

\begin{proof}
Let $L$ be a latin square of sufficiently large order $n$,  let $\varepsilon>0$ be sufficiently small, and use Lemma \ref{lemma:LSpart} to find a partition $\left(A_{i,j}\right)_{i,j \in [3]}$ of $L$ such that each symbol in $S(L)$ appears between $\left(1-\varepsilon\right)\frac{n}{9}$  and $\left(1+\varepsilon\right)\frac{n}{9}$ times in each $A_{i,j}$. Next, pick a set $T \subseteq S(L)$ of size $\lfloor n^{2/3} \rfloor$ using Corollary \ref{cor:APS}, so that the subgraph induced by the edges with colors in $T$ has good expansion properties. Fix $i \in [3]$, let $\ell = |A_{i,i}|$, and consider the subgraph $G_i \subseteq K_{\ell,\ell}(A_{i,i})$ obtained by removing all edges with colors in $T$. Because $\ell \leq \lceil n/3\rceil$ and $n$ is sufficiently large, we have 
%$e(G_i) \geq \left( n-n^{2/3}\right) \left(1-\varepsilon\right) \frac{n}{9} \geq \left(1- 2\varepsilon\right) \ell^2$. Moreover, we have 
$\delta(G_i) \geq \ell-\lfloor n^{2/3}\rfloor \geq \ell-\ell^{3/4}$. 
Moreover, as we may assume $n \geq 3$ and $1-\varepsilon \geq \frac{4}{27}$, we have 
%
\[ \frac{\left(1-\varepsilon^2\right)n^2}{2\ell} \geq\frac{\left(1-\varepsilon^2\right)3n^2}{2(n+3)}\geq \frac{\left(1-\varepsilon^2\right)3n}{4} \geq \frac{(1+\varepsilon)n}{9}. \]
%
We may therefore apply Corollary \ref{cor:EGJ} to find a \gls{rainbow} \gls{Hamilton cycle} $X_i \subseteq G_i$. Then, taking the union of the three cycles just obtained, say $P_0 := \bigcup_{i=1}^3 X_i$, we have a spanning set of 2-regular rainbow subgraphs, i.e.\! a $(2,3)$-plex of $K_{n,n}(L)$. To obtain a Hamilton $(2,3)$-plex we will tie these three cycles together into a single cycle.
%, much like we did in the proof of Theorem \ref{thm:h22xk}.



Our first step in this direction is to claim that $K_{n,n}(L)$ has a 3-bounded Hamilton path. Indeed, let $F$ denote the set of colors used fewer than three times in $P_0$. Because $e(P_0) = 2n$, we have $|F| \geq \lceil n/3 \rceil$. Having defined $\left(A_{i,j}\right)_{i,j \in [3]}$ via the \gls{equipartition}s $\left\{ R_i \right\}_{i=1}^3 \vdash R(L)$ and $\left\{ C_i \right\}_{i=1}^3 \vdash C(L)$ given by Lemma \ref{lemma:LSpart}, we know that at least $\frac{(1-\varepsilon)n}{9}$ copies of each symbol in $F$ appear in $A_{3,1}$. In graph-theoretic terms, this means $e_F(R_3,C_1) \geq \frac{(1-\varepsilon)n|F|}{9}$. But $|R_3|=\lfloor n/3 \rfloor$, so by averaging there must be some $r_3 \in R_3$ such that 
%
$e_F(\{r_3\},C_1) \geq \frac{(1-\varepsilon)n}{9}$.
%
Similarly, there exists  $c_3 \in C_3$ such that $e_F(R_2,\{c_3\}) \geq \frac{(1-\varepsilon)n}{9}$. 

\begin{figure}[t]
\centering
\begin{subfigure}[b]{0.45\textwidth}
\begin{tikzpicture}[scale=1.2,auto=left,every node/.style={circle,draw,thick,fill=black,minimum size = 0.1cm}]
\usetikzlibrary{calc}
\def\centerarc[#1](#2)(#3:#4:#5)% Syntax: [draw options] (center) (initial angle:final angle:radius)
    { \draw[#1] ($(#2)+({#5*cos(#3)},{#5*sin(#3)})$) arc (#3:#4:#5); }

%\draw [black,thick,domain=-60:-30] plot ({cos(\x)}, {sin(\x)});

\draw[blue,thick,densely dashed] ($(0,-1)+(135:1)$)--($(-2.5,1)+(315:1)$);
\draw[blue,thick,densely dotted] ($(0,-1)+(0:1)$)--($(2,1)+(0:1)$);
\draw[violet,thick,densely dashed] ($(0,-1)+(0:1)$)--($(2,1)+(-135:1)$);
\draw[brown,thick,densely dashed] ($(-2.5,1)+(0:1)$)--($(2,1)+(180:01)$);
\draw[red,thick,densely dotted] ($(-2.5,1)+(0:1)$)--($(2,1)+(45:1)$);


\centerarc[black,thick](-2.5,1)(0:315:1);
\centerarc[red, ultra thick](-2.5,1)(-45:0:1);

\node (z) at ($(-2.5,1)+(315:1)$)  {};
\node (z) at ($(-2.5,1)+(310:1.3)$) [fill=none,draw=none]  {$c_1$};
\node(z) at ($(-2.5,1)+(0:1)$)  [fill=white]{};
\node (z) at ($(-2.5,1)+(15:1.3)$) [fill=none,draw=none]  {$r_1$};


\node (z) at (-2.5,1) [fill=none,draw=none] {$X_1$};
\node (z) at (0,-1) [fill=none,draw=none] {$X_3$};
\node (z) at (2,1) [fill=none,draw=none] {$X_2$};


\centerarc[black,thick](0,-1)(-180:0:1);
\centerarc[black,thick](0,-1)(45:135:1);
\centerarc[red, ultra thick](0,-1)(135:180:1);
\centerarc[red, ultra thick](0,-1)(0:45:1);


\node (z) at ($(0,-1)+(135:1)$) [fill=white] {};
\node (z) at ($(0,-1)+(130:1.3)$) [fill=none,draw=none]  {$r_3$};
\node(z) at ($(0,-1)+(180:1)$)  {};
\node (z) at ($(0,-1)+(190:1.3)$) [fill=none,draw=none]  {$c_0$};
\node (z) at ($(0,-1)+(45:1)$) [fill=white] {};
\node (z) at ($(0,-1)+(40:1.3)$) [fill=none,draw=none]  {$r_0$};
\node(z) at ($(0,-1)+(0:1)$)  {};
\node (z) at ($(0,-1)+(0:1.33)$) [fill=none,draw=none]  {$c_3$};




\centerarc[black,thick](2,1)(-180:0:1);
\centerarc[black,thick](2,1)(0:180:1);
\centerarc[red, ultra thick](2,1)(-135:-180:1);



\node (z) at ($(2,1)+(-135:1)$) [fill=white] {};
\node (z) at ($(2,1)+(-150:1.25)$) [fill=none,draw=none]  {$r_2$};
\node(z) at ($(2,1)+(180:1)$)  {};
\node (z) at ($(2,1)+(170:1.3)$) [fill=none,draw=none]  {$c_2$};
\node (z) at ($(2,1)+(45:1)$) {};
\node(z) at ($(2,1)+(0:1)$)  [fill=white] {};


\end{tikzpicture}
\caption{$P_0$ is the graph on black and thick-red edges. Because $r_1$ has (at least) two neighbors in $W$, drawn here as the two black vertices on $X_2$, we can find $c_2$ so that the Hamilton path $P_1$ on black and dashed edges is 3-bounded.}\label{fig:sss}
\end{subfigure}
%
%
%
\hfill
%
%
%
\begin{subfigure}[b]{0.45\textwidth}
\begin{tikzpicture}[scale=1.2,auto=left,every node/.style={circle,draw,thick,fill=black,minimum size=1pt}]
\def\centerarc[#1](#2)(#3:#4:#5)% Syntax: [draw options] (center) (initial angle:final angle:radius)
    { \draw[#1] ($(#2)+({#5*cos(#3)},{#5*sin(#3)})$) arc (#3:#4:#5); }


\draw (-2.5,0)--(2.5,0);

\draw [blue, thick, densely dashed](-2.5,0) to[out=40,in=140] (-0.5,0);
\draw [violet, thick, densely dashed](0.5,0) to[out=40,in=140] (2.5,0);
\draw[brown, thick, densely dashed](-1.25,0) to[out=50,in=130] (1.25,0);

\draw [red,ultra thick] (-0.5,0)--(-1.25,0);
\draw [red,ultra thick] (0.5,0)--(1.25,0);

\node (z) at (-2.5,0) {};
\node (z) at (-2.5,-.35) [fill=none,draw=none]  {$c_0$};
\node(z) at (2.5,0)  [fill=white] {};
\node (z) at (2.5,-.35) [fill=none,draw=none]  {$r_0$};

\node (z) at (-0.5,0)[fill=white] {};
\node (z) at (-0.5,-.32) [fill=none,draw=none]  {$b$};
\node (z) at (-1.25,0) {};
\node (z) at (-1.25,-.35) [fill=none,draw=none]  {$c$};

\node(z) at (0.5,0)   {};
\node (z) at (0.5,-.35) [fill=none,draw=none]  {$a$};
\node (z) at (1.25,0)[fill=white] {};
\node (z) at (1.25,-.35) [fill=none,draw=none]  {$r$};




\draw (-2.5,2)--(2.5,2);

\draw [blue, thick, densely dashed](-2.5,2) to[out=40,in=140] (0.5,2);
\draw [violet, thick, densely dashed](-0.5,2) to[out=40,in=140] (2.5,2);
\draw[brown, thick, densely dashed](-1.25,2) to[out=50,in=130] (1.25,2);

\draw [red,ultra thick] (-0.5,2)--(-1.25,2);
\draw [red,ultra thick] (0.5,2)--(1.25,2);

\node (z) at (-2.5,2) {};
\node (z) at (-2.5,1.65) [fill=none,draw=none]  {$c_0$};
\node(z) at (2.5,2)  [fill=white] {};
\node (z) at (2.5,1.65) [fill=none,draw=none]  {$r_0$};

\node (z) at (-0.5,2) {};
\node (z) at (-0.5,1.65) [fill=none,draw=none]  {$a$};
\node (z) at (-1.25,2)[fill=white] {};
\node (z) at (-1.25,1.65) [fill=none,draw=none]  {$r$};

\node(z) at (0.5,2) [fill=white]   {};
\node (z) at (0.5,1.68) [fill=none,draw=none]  {$b$};
\node (z) at (1.25,2){};
\node (z) at (1.25,1.65) [fill=none,draw=none]  {$c$};






\end{tikzpicture} 
\caption{Both cases of the transformation from $P_1$, the graph on the black and thick-red edges, to $H$, the graph on the black and dashed edges. On bottom is case (1)---$\dist_{P_1}(c_0,b) <m'$ for all $b \in B$---and on top is case (2). }\label{fig:pathtocycle}
\end{subfigure}


\caption[The two sets of edge switches used in the proof of Theorem \ref{thm:23plex}]{An illustration of the two steps of switches used to tie the three cycles in $P_0$ into a single Hamtilon (2,3)-plex.}
\label{fig:32ham}
\end{figure}




Let $U$ denote the set of vertices $r_1 \in R_1$ such that $K_{n,n}(L)$ has a  2-edge path $r_1,c_1,r_3$ satisfying $r_1c_1 \in X_1$ and $\chi_L(r_3c_1) \in F$. Similarly, let $W$ denote the set of vertices $c_2 \in C_2$ such that $K_{n,n}(L)$ has a 2-edge path $c_2,r_2,c_3$ satisfying $r_2c_2 \in X_2$ and $\chi_L(r_2c_3) \in F$. By the definitions of $r_3$ and $c_3$ and the fact that $n$ is sufficiently large, we have $|U|,|W| \in  \left[\frac{n}{10}, \frac{n}{3}+1 \right)$ and can apply Corollary \ref{cor:APS} to see that $e_T(U,W) \geq n^{3/2}$. It follows that there must be some $r_1 \in U$ such that $e_T(\{r_1\},W) >1$. This allows us to find vertices $c_2 \in W$, $c_1 \in C_1$, and $r_2 \in R_2$ such that $r_ic_i \in X_i$ for $i \in [2]$, $\chi_L(r_1c_2) \in T$, $\chi_L(r_3c_1),\chi_L(r_2c_3) \in F$, and $\chi_L(r_3c_1) \neq \chi_L(r_2c_3)$. As illustrated in Figure \ref{fig:32ham}(a), this is enough to prove the claim, as there exist $r_0 \in R_3$ and $c_0 \in C_3$ such that 
%
\[ P_1 := \left(P_0 \setminus\{r_0c_3,r_3c_0,r_1c_1,r_2c_2\}\right) \cup \{r_3c_1,r_2c_3,r_1c_2\}\]
%
is a 3-bounded Hamilton path. Notice that the endpoints of $P_1$ are $r_0$ and $c_0$.

Now, let $F' = F \setminus \{\chi_L(r_3c_1),\chi_L(r_2c_3) \}$ and let $m$ denote the median value in the set 
%
$D:= \{\dist_{P_1}(r_0,c)  \,| \,  c \in N_{F'}(r_0)\}$.
%
Observe that $\dist_{P_1}(c_0,v) = 2n -1 -\dist_{P_1}(r_0,v)$ for all $v \in V(K_{n,n}(L))$, and let $m'  := 2n-1-m$. By the pigeonhole principle and the fact that $|F'| \geq \frac{n}{3}-2$, there is a set  $B \subseteq N_{F'}(c_0)$ of size $\lceil\frac{n}{7}\rceil$ such that either  (1) $\dist_{P_1}(c_0,b) <m'$ for all $b \in B$ or (2) $\dist_{P_1}(c_0,b) >m'$ for all $b \in B$. In case (1), let $A = \{c \in N_{F'}(r_0) \,|\, \dist_{P_1}(r_0,c)<m\}$ and observe that $|A| \geq \frac{n}{7}$. Then, let $C_A$ denote the set of vertices in $C$ which are adjacent on the $r_0$ side to a vertex in $ A$ (i.e. $c \in C_A$ if $ca \in P_1$ for some $a \in A$ and $c$ lies on the subpath of $P_1$ between $r_0$ and $a$) and let $R_B$ denote the set of vertices in $R$ which are adjacent on the $c_0$ side to a vertex in $B$. Because $|C_A|,|R_B| \geq \frac{n}{7}$, we may again apply Corollary \ref{cor:APS} to see that $e_T(C_A,R_B) \geq n^{3/2}$, and therefore there is some $c \in C_A$ with $e_T(\{c\},R_B) >1$. This means there exists $a \in A$, $b \in B$, and $r \in R_B$ such that $ra,bc \in P_1$, $\chi_L(r_0a),\chi_L(bc_0) \in F'$, $\chi_L(r_0a) \neq \chi_L(bc_0)$, and $\chi_L(rc) \in T$. The Hamilton cycle
%
\[ H:= \left(P_1 \setminus \{ra,bc\} \right) \cup \{r_0a,bc_0,rc\}, \]
%
shown in Figure \ref{fig:32ham}(b), uses at most two edges with colors in $T$. As the other two edges added in passing to $H$ from (the 3-bounded graph) $P_1$ were carefully chosen to not introduce more than 3 copies of any color in \acrshort{SL}$\setminus T$, we may conclude that $H$ is the desired (2,3)-plex. 

In case (2), where $\dist_{P_1}(c_0,b) >m'$ for all $b \in B$, we define $A$ to be the set $\{c \in N_{F'}(r_0) \,|\, \dist_{P_1}(r_0,c)>m\}$, let $C_A$ denote the set of vertices in $C$ which are adjacent on the $c_0$ side to a vertex in $A$, and let $R_B$ denote the set of vertices in $R$ which are adjacent on the $r_0$ side to a vertex in $B$. Using a similar argument to case (1), we can find  $c \in C_A$, $a \in A$, $b \in B$, and $r \in R_B$ such that $ra,bc \in P_1$, $\chi_L(r_0a),\chi_L(bc_0) \in F'$, $\chi_L(r_0a) \neq \chi_L(bc_0)$, and $\chi_L(rc) \in T$, then conclude that the Hamilton cycle
%
$ H:= \left(P_1 \setminus \{ra,bc\} \right) \cup \{r_0a,bc_0,rc\} $
%
is the desired Hamilton $(2,3)$-plex.
%
\end{proof}




Because the proof of Theorem \ref{thm:23plex} relies upon the very technical proof of Corollary \ref{cor:EGJ}, it is not clear exactly how large $n$ must be before we can be certain that every latin square of order $n$ has a Hamilton $(2,3)$-plex. Of course, if Conjecture \ref{conj:main} is true, then every latin square would have a Hamilton $(2,3)$-plex. While we do not yet have a proof of this weaker version of Rodney's conjecture, we can show that all latin squares have a Hamilton (2,5)-plex. 

The essential idea behind this proof, as well as the following general existence result for $(k,\ell)$-plexes, is to manipulate $(k,n)$-plexes (i.e. selections of cells in intersecting each row and each column exactly $k$ times) to remove edges with colors appearing too many times. Given a $(k,n)$-plex $P \subseteq L$, let $A_i(P)$ denote the set of colors which appear $i$ times in $P$ and for all $\ell >k$ let the \defn{$\ell$-deficit} of $P$ be the value
%
\[ d_\ell(P) := \sum_{i=\ell+1}^n |A_i(P)|.\]
%
Both this notion of deficit and our use of it is essentially a generalization of the ideas used by Cameron and Wanless in \cite{CW05} to show that every latin square has a $(1,2)$-plex. 


\begin{theorem}
Every latin square has a Hamilton $(2,5)$-plex.
\label{thm:h25}\end{theorem}

\begin{proof}
Let $L$ be a latin square of order $n$ and, supposing for the sake of contradiction that $L$ has no Hamilton (2,5)-plex, let $H_0$ denote the \gls{Hamilton cycle} which minimizes $d_{5}(H)$ among all Hamilton cycles $H \subseteq K_{n,n}(L)$. Let $a_i := |A_i(H_0)|$ for all $i \in [0,n]$, let $B = \bigcup_{i=6}^n A_i(H_0)$, and fix an edge $r_1c_1 \in H_0$ such that $\chi_L(r_1c_1) \in B$. Then, relabel the vertices of $K_{n,n}(L)$ so that $H_0$ is given by the vertex sequence $c_1,r_1,c_2,r_2,\ldots,c_n,r_n,c_1$. Consider the index sets
%
\begin{align*} U&:=\left\{j \in [3,n]  \,\Big\vert\, \chi_L(r_1c_j) \in \bigcup_{i=0}^3 A_i(H_0)\right\} \text{ and }\\
 W&:=\left\{j \in [3,n] \,\Big\vert\, \chi_L(r_{j-1}c_1) \in \bigcup_{i=0}^4 A_i(H_0)\right\}.
 \end{align*}
%
If $U \cap W \neq \emptyset$, then there exists $r_{j-1}c_j \in H_0$ such that---recalling Definition \ref{def:switch} and Figure \ref{fig:switch}---the Hamilton cycle $H_1 := \sigma(P_0;r_1c_1,r_{j-1}c_j)$ satisfies $d_5(H_1) < d_5(H_0)$, contradicting the minimality of $d_5(H_0)$. 

Because we have assumed $\chi_L(r_1c_1)$ appears at least 6 times in $H_0$, we have 
%
\[|U| \geq n-2-\left(-1+\sum_{i=4}^n a_i\right) = n-1-\sum_{i=4}^n a_i\]
%
 and, similarly, $|W| \geq  n-1 -\sum_{i=5}^n a_i$. We can therefore apply the inclusion-exclusion principle to see that
%
\begin{equation} |U \cap W| \geq n-2-a_4-2\sum_{i=5}^na_i.\label{eq:h251}\end{equation}
%
Counting colors in $H_0$, we see that (i) $\sum_{i=1}^n ia_i=2n$ and (ii) $\sum_{i=0}^n a_i =n$. Plugging the first of these sums into \eqref{eq:h251} gives $|U \cap W|\geq \frac{1}{2}a_1+a_2+\frac{3}{2}a_3 +a_4+\sum_{i=5}^n \left(\frac{i-4}{2}\right) a_i -2$. Then, using the sum (ii), we see that it suffices to show 
%
\begin{equation}
\frac{1}{2}(n-a_0) + \frac{1}{2} a_2 +a_3 + \frac{1}{2} a_4 + \sum_{i=6}^n \left(\frac{i-5}{2}\right) a_i> 2.
\label{eq:h252}\end{equation}
%

We may assume $a_i>0$ for some $i \geq 6$, as otherwise $H_0$ is a (2,5)-plex and we are done. This means that \eqref{eq:h252} holds so long as $n-a_0 \geq 4$. Moreover, because each color appears at most $n$ times in $K_{n,n}(L)$, we must have $n-a_0 >1$. This leaves two cases to consider. In the case $a_0=n-3$, we have $\frac{1}{2}(n-a_0) = \frac{3}{2}$ and may assume $a_i =0$ for all $i \geq 7$, as otherwise \eqref{eq:h252} must hold. But we may assume $n \geq 9$ by Proposition \ref{prop:upto8}, so the only way we can cover all $2n$ edges of $H_0$ using 3 colors fewer than 7 times each is if $n=9$ and $a_6=3$, in which case \eqref{eq:h252} holds. The case $a_0=n-2$ is even more straightforward: if we use 2 colors to cover the $2n$ edges in $H_0$, then $a_n=2$ and the assumption that $n \geq 9$ implies $\left(\frac{n-5}{2}\right)a_n \geq 4$.
\end{proof}

We end this section by showing that every latin square has a $(k,4k)$-plex for all $k \leq n$. As was the case with Theorem \ref{thm:h25}, it seems likely that this result is far from best possible, especially in light of Theorem \ref{thm:partplex}(b). Although the argument we use is very similar to the one just presented, we now use the language of latin squares, rather than of edge-colored graphs. In particular, we discuss cells in latin squares as ordered triples, and follow \cite{BPW21} in using $\bullet$ for exactly one of the three indices in a triple, a convention justified by the fact that every cell in a latin square is uniquely defined by any pair of its indices. 



\begin{theorem}\label{thm:hk4k}
Every latin square of order $n$ has a $(k,4k)$-plex for all positive integers $k \leq n$.
\end{theorem}


\begin{proof}
Notice that the result holds trivially if $k \geq \frac{n}{4}$. Let $L$ be a latin square of order $n$ and suppose for the sake of contradiction that there is some $k < \frac{n}{4}$ such that $L$ does not have a $(k,4k)$-plex. Let $P_0$ be the $(k,n)$-plex  which minimizes $d_{4k}(P)$ among all $(k,n)$-plexes $P \subseteq L$, let $a_i := |A_i(P_0)|$ for all $i \in [0,n]$, and for all $s \in S(L)$ let $\nu(s) =j$ whenever $s \in A_j(P_0)$. By permuting rows, columns, and symbols if necessary, we may assume that the \gls{main diagonal} of $L$ is in $P_0$, that $L_{1,1}=1$, and that $\nu(1) >4k$. 

Consider the sets 
%
\begin{align*} U&:=\left\{i \in [n] \,\Big\vert\, (1,i,\bullet) \not\in P_0,\, \nu(L_{1,i} )<4k-1 \right\} \text{ and }\\
 W&:=\left\{i \in [n] \,\Big\vert\, (i,1,\bullet) \not\in P_0,\,  \nu(L_{i,1})<4k \right\}.
 \end{align*}
%
If $U \cap W \neq \emptyset$, then for any $i \in U \cap W$ the $(k,n)$-plex
%
\[ P_1:= \left( P_0 \setminus \{(1,1,1),(i,i,\bullet)\}\right) \cup \{(1,i,\bullet),(i,1,\bullet)\}\]
%
satisfies $d_{4k}(P_1) <d_{4k}(P_0)$, contradicting the minimality assumption in the definition of $P_0$ and thereby establishing the desired result. 

Now, we know $|U| \geq n-k+1 - \sum_{j=4k-1}^n a_j$ and $|W|\geq n-k+1 - \sum_{j=4k}^n a_j$ by definition. Therefore, by the principle of inclusion-exclusion, we have 
%
\begin{equation} |U \cap W| \geq n-2k+2 -2\sum_{j=4k-1}^n a_j.\label{eq:k4k1}\end{equation}
%
Moreover, because $P_0$ is comprised of $kn$ cells, we have $kn = \sum_{j=1}^n ja_j$. From this we see that $(4k-1)\sum_{j=4k-1}^n a_j \leq kn$, and therefore
%
\begin{equation} \sum_{j=4k-1}^n a_j \leq \frac{kn}{4k-1} = n\left(\frac{k-1}{4k-1}+\frac{1}{4k-1}\right) \leq n \left(\frac{1}{4} + \frac{1}{4k-1}\right). \label{eq:k4k2}\end{equation}
%
Plugging \eqref{eq:k4k2} into \eqref{eq:k4k1} and simplifying, we see that $|U \cap W|>0$ so long as we have $n\left(\frac{1}{2} - \frac{2}{4k-1}\right)>2k-2$. To confirm that this is indeed the case, recall that the results holds trivially unless $n \geq 4k+1$. Moreover, we may assume $k \geq 3$ by Theorem \ref{thm:h25} and Cameron and Wanless' proof in \cite{CW05} that every latin square has a (1,2)-plex. Thus, to complete the proof, we simply note that
%
\[ n \geq 4k+1 > 4k+\frac{4}{7} \geq 4k+\frac{4}{4k-5} =\frac{(2k-2)(8k-2)}{4k-5} .\qedhere\]
%
\end{proof}




\chapter{Concluding remarks}\label{ch:conc}

With all three of our motivating conjectures still wide open, the general theme of the future work suggested by this thesis is clear. With respect to 2-plexes, we have in some sense raised more questions than answers. Indeed, while Wanless and Vaughan-Lee showed in \cite{VLW03} that, modulo the now completed proof of Theorem \ref{thm:bigequiv}, every group-based latin square has a 2-plex, our study of H2-harmonious groups in Chapter \ref{ch:h2terrace} has introduced a new open question: are all nonabelian groups of even order H2-harmonious? It is clear from the conjecture with which we began Chapter \ref{ch:h2terrace} that we believe this question has an affirmative answer.

\begin{conjecture}
Every finite group except $\mathbb{Z}_2 \times \mathbb{Z}_2$ is H2-harmonious.
\end{conjecture}

We showed in Chapter \ref{ch:h2terrace} that many families of groups are H2-harmonious, including all abelian groups, all groups of odd order, all groups with a cyclic subgroup of index 2, and all extensions of odd-order groups by H2-harmonious groups. As was mentioned in Section \ref{sec:smallgrps}, we believe that the study of H2-harmonious groups would be best served by answers to the following pair of questions:

\begin{itemize}
\item Are all \gls{solvable group}s besides $\mathbb{Z}_2 \times \mathbb{Z}_2$ H2-harmonious?
\item Are all symmetric and alternating groups H2-harmonious?
\end{itemize}

More generally, there are many interesting questions one could ask about Hamilton $(2,\ell)$-plexes. In Section \ref{sec:fe}, we showed that all sufficiently large latin squares have a $(2,3)$-plex. While we were able to prove that all latin squares have a Hamilton (2,5)-plex, a reasonable step towards a proof that all latin squares have a Hamilton 2-plex would be to:

\begin{itemize}
\item Show that all latin squares have a Hamilton (2,$\ell$)-plex for some $\ell <5$.
\end{itemize}

While it is in some sense preferable to have theorems that hold for every latin square, there is reason to believe that considering large latin squares could be very fruitful. Indeed, several recent papers \cite{APS17, BM19, GKKO20plus, GK21plus} have used probabilistic methods to make substantial progress in the study of rainbow Hamilton cycles in sufficiently large edge-colored complete graphs. Recall from Section \ref{sec:egjstuff} that a partial Hamilton 2-plex is a 2-bounded union of paths in $K_{n,n}(L)$. Could we adapt their methods to prove the following weaker version(s) of Conjecture \ref{conj:main}?

\begin{conjecture}
Every latin square has a partial Hamilton 2-plex of size $2n-O(\log n)$. Moreover, almost every latin square has a Hamilton 2-plex. 
\end{conjecture}

It would also be very interesting to determine if all equi-$n$ squares have Hamilton 2-plexes and, if not, what is the largest value of $c$ such that every $cn$-bounded $n$-square has a Hamilton 2-plex. Theorem \ref{thm:LLLLmain} shows that this value is greater than $ 0.102$. And what about $k$-plexes in equi-$n$ squares for $k>2$? It seems somewhat likely that there exist equi-$n$ squares with no 3-plex.

Most generally, it would be interesting to see the theory of $(k,\ell)$-plexes further developed. An interesting avenue we have not explored is whether all latin squares can be decomposed into $(k,\ell)$-plexes for various values of $k$ and $\ell$. One could also give a definition of indivisible  $(k,\ell)$-plexes and ask related existence questions. However, there  much to explore even with respect to the sort of straightforward existence questions considered above. Theorem \ref{thm:partplex}(b), which shows that all sufficiently large latin squares have a $(k,k+1)$-plex for $k = O(1)$, indicates that,  for some fixed constant $c$, it may be possible to find $(k,k+c)$-plexes in all latin squares, even in the case where $k$ is odd. We end with a question whose answer would indicate the degree to which $(k,\ell)$-plexes behave differently than $k$-plexes.

\begin{question}
Does every latin square of order $4n$ have a $(2n-1,2n)$-plex?
\end{question} 



%   BACK MATTER  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%   References and appendices. Appendices come after the bibliography and
%   should be in the order that they are referred to in the text.
%
%   If you include figures, etc. in an appendix, be sure to use
%
%       \caption[]{...}
%
%   to make sure they are not listed in the List of Figures.
%

\backmatter%
	\addtoToC{Bibliography}
	\bibliographystyle{plain}
	\bibliography{../ThesisReferences}

























\begin{appendices} % optional
\chapter{Code}\label{app:backtrack}


This backtracking algorithm, written for the computer algebra system Sage \cite{sagemath}, was used to prove Propositions \ref{prop:upto8} and \ref{prop:smallgrps}. 

\bigskip

\begin{lstlisting}[language=Python,mathescape=true,escapeinside={(*}{*)}]]
##############################################################
# (*\textbf{The technical part}*)
# (*\textbf{Input:}*) $S$, a list of lists giving a latin square; Path, a 
# list giving a 2-bounded path in $K_{n,n}(S)$; CC, an array 
# documenting how many times each color has been used in Path; 
# aR and aC, sets giving the rows and columns, respectively, 
# not used by Path; $n$, the order of $S$; $k$, the length of Path
# (*\textbf{Output:}*) if Path can be extended by 1, (True,P) where P
# is the extension. Otherwise, (False,Path)
##############################################################

def Ham2PlexUtil(S,Path,CC,aR,aC,n,k):

    ###########################################################
    # (*\textbf{Base case:}*) if Path has length 2n-1, check that the edge
    # connecting its end to S[0][0] has the correct symbol
    ###########################################################

    if k==2*n-1:
        r = Path[k-1][0]
        s = S[r][0]
        if CC[s]==1:
            Path.append((r,0,s))
            return True,Path
        else:
            return False,Path



    ############################################################
    # For paths of even length, randomly select a row candidate
    # for the next step in the path, then attempt to extend
    ############################################################

    if k%2==0:
        c = Path[k-1][1]
        aR2 = Permutations(list(aR)).random_element()
        for r in aR2:
            s = S[r][c]
            if CC[s]<2:
                Path.append((r,c,S[r][c]))
                CC[s]+=1
                aR.remove(r)
                if Ham2PlexUtil(S,Path,CC,aR,aC,n,k+1)[0]:
                    return True,Path
                Path.pop()
                CC[s]-=1
                aR.add(r)
        return False,Path

    ##############################################################
    # For paths of odd length, randomly select a column candidate
    # for the next step in the path, then attempt to extend
    ##############################################################

    else:
        r = Path[k-1][0]
        aC2 = Permutations(list(aC)).random_element()
        for c in aC2:
            s = S[r][c]
            if CC[s]<2:
                Path.append((r,c,S[r][c]))
                CC[s]+=1
                aC.remove(c)
                if Ham2PlexUtil(S,Path,CC,aR,aC,n,k+1)[0]:
                    return True,Path
                Path.pop()
                CC[s]-=1
                aC.add(c)
        return False,Path

###########################################################
# (*\textbf{The top part}*)
# (*\textbf{Input:}*) $S$, a list of lists giving a latin square
# (*\textbf{Output:}*) A Hamilton 2-plex if one exists, otherwise False
###########################################################

def Ham2Plex(S):
    n = len(S)
    CC = [0 for i in range(n)]
    CC[S[0][0]]=1
    aR = set(range(1,n))
    aC = set(range(1,n))
    H = Ham2PlexUtil(S,[(0,0,S[0][0])],CC,aR,aC,n,1)
    if H[0]:
        return H[1]
    else:
        return False

\end{lstlisting} 

\chapter{Proof of Proposition \ref{prop:smallgrps}}
\label{app:smallgrps}

All abelian groups and all groups of odd order were shown to be H2-harmonious by Theorems \ref{thm:h2abel} and \ref{thm:h2odd}, respectively. Moreover, we noted in Corollary \ref{cor:h2dih} that all dihedral, semidihedral, and dicyclic groups are H2-harmonious. Proving Proposition \ref{prop:smallgrps} therefore amounts to showing that all groups not considered by these three results are H2-harmonious. It turns out that most of small groups can be taken care of using Lemma \ref{lemma:h2util} and Theorem \ref{thm:h22xk}. 

As noted in Section \ref{sec:smallgrps}, the sequencings presented below were found by running the algorithm in Appendix \ref{app:backtrack} using Sage \cite{sagemath} and the list of groups we needed to consider comes from The GAP Small Groups Library \cite{GAPSmGrp}. We will identify groups using their GAP ID, before giving the more common name (when applicable). For many of the groups we will also give a presentation so as to identify the letters used in our exposition.

%\subsection*{Groups of order 8}
%\begin{itemize}
%\item $[8,4]$, the Quaternion group, $\langle a,b \,|\, a^2=b^2, a^4 = abab^{-1} =1 \rangle$: 
%%
%\[ 1, 1, a^3b, a^2b, ab, ab, b, a, a^2b, a^2, a^3, a^3, a, a^3b, a^2, b\]
%%
%\end{itemize}


\subsection*{Groups of order 12}
\begin{itemize}
%\item $[12,1]$, the dicyclic group $\Dic_3$, $\langle a,b \,|\, a^3=b^2, a^6 = abab^{-1} =1 \rangle$: 
%%
%\[ 1, 1, a^1, a^5, a^5, a^1b, a^3b, a^5b, a^4b, a^4, a^2b, a^2b, a^3, b, a^2, a^1, b, a^3, a^1b, a^3b, a^4, a^4b, a^5b, a^2\]
%%
%
\item $[12,3]$, the alternating group $A_4$:
%
\begin{align*}
&S:= \,  (), (), (12)(34), (234), (134), (12)(34), (14)(23), (243), (234),  \\
&\hspace{28pt} (14)(23), (124), (124), (132), (142), (123), (143), (143),  \\
&\hspace{28pt} (123),(243), (13)(24), (142), (134), (13)(24), (132)\\
 \\
& \pi(S) = (), (12)(34), (124), (13)(24), (123), (13)(24), (142), (), (124), \\
& \hspace{38pt} (234), (142), (243), (14)(23),(143), (14)(23), (134), (12)(34),  \\
& \hspace{38pt}  (143), (123), (134), (132), (243), (234),(132)
 \end{align*}
 
\end{itemize}

\subsection*{Groups of order 16}

\begin{itemize}

\item $[16,3]$, $\langle a,b,c \,|\, a^4=b^2=c^2=1, ab=ba, bc=cb, cac = ba^{-1}\rangle$: %$\mathbb{Z}_2 \ltimes (\mathbb{Z}_4 \times \mathbb{Z}_2) $
%
\begin{align*}
&S:=\, 1, 1, bc, b, a^2b, a^3b, a^2bc, ac, a^2c, a^2, b, a^3bc, c, a^2bc, a^3c, bc, a^3bc,\\
& \hspace{28pt}  a, a^3b, a^2c, ab, a^3, a, a^3c, abc, ab, ac, a^2b, a^3, c, a^2, abc\\
\\
&\pi(S) =\, 1, bc, c, a^2, a, ac, a^3b, a^3, c, a^2b, a^3c, a^3b, a^2b, a^3, a, ab, bc, b, a^3c, ac,\\
& \hspace{38pt} b, 1, a^2bc, a^2, a^2c, a^2bc, a^3bc, ab, abc, a^2c, a^3bc, abc
 \end{align*}
 %
 %
 \item $[16,4]$,  $\langle a,b \, | \, a^4=b^4=1, bab^{-1}=a^{-1} \rangle$: %$\mathbb{Z}_4 \ltimes \mathbb{Z}_4$,
 %
 \begin{align*}
&S:= \, 1, 1, ab, a^2b, a^2b^2, b^3, a^2, ab^2, b^2, a^3b^3, a, ab^3, a^2b, b, ab^2, a^3b^2, a^2b^3,\\
&\hspace{28pt} ab, b, a^2, a^3b^3, a^2b^3, a^3, a^3, a^3b^2, a^2b^2, ab^3, a^3b, a^3b, a, b^3, b^2\\
\\
&\pi(S) =\, 1, ab, ab^2, b^3, a^2b, a^2b^3, a^3b^2, a, a^3b, a^2b^3, b^3, a^3, a^2b^2, a^3b^3, 1, ab, a^3,\\
&\hspace{38pt} ab^2, a^2b, ab^3, a^3b^2, a^3b^3, a^2, a^2b^2, a, a^3b, a^2, b^2, b, ab^3, b, b^2
 \end{align*}
 %
 %
 \item $[16,6]$, $\langle a,b \,|\, a^8=b^2=1, bab=a^5 \rangle$:
 %
 \[ \text{H2-harmonious by Theorem \ref{thm:h22xk} as } \langle a \rangle \text{ is a cyclic subgroup of index 2}\]
 %
 %
 \item $[16,11]$, $D_8 \times \mathbb{Z}_2$, $\langle a,b,c \,|\, a^4=b^2=c^2 = 1, bab=a^{-1}, ca=ac, bc=cb\rangle$:
 %
 \begin{align*}
& S:= 1, 1, a^2b, ab, a, abc, a^3bc, a^2bc, a^3b, a^3b, bc, ac, abc, a^2b, b, c, a^2,\\
& \hspace{28pt} bc, a^3, a^3c, a^2bc, a^3, ac, b, a^2c, a^2, ab, a^2c, a^3c, a^3bc, c, a\\
 \\
& \pi(S) = 1, a^2b, a^3, b, bc, a^2, a^3, a^3c, 1, a^3c, ab, a^2b, ac, a^2, bc, a^2c, a^2bc,\\
& \hspace{38pt} abc, a^2c, ab, abc, c, a^3bc, a^2bc, c, a^3b, a^3bc, a, b, a^3b, ac, a
  \end{align*}
 %
 %
 \item $[16,12]$, $Q \times \mathbb{Z}_2$, $\langle a,b,c \,|\, a^4 = c^2 = 1, a^2=b^2, bab^{-1} = a^{-1}, ac=ca,bc=ca\rangle$:
 %
  \begin{align*}
& S:= 1, 1, ab, bc, a^2, a^2bc, a^2c, a^2c, a, ac, b, a^3bc, ac, a^3b, a^2bc, c, abc,  \\
& \hspace{28pt} a^3c, a^3c, a^2b, a^3, a^3, bc, abc, a^3b, b, c, a^2, a^3bc, ab, a^2b, a\\
 \\
& \pi(S) = 1, ab, ac, a^2bc, bc, b, 1, a^3c, a^2c, abc, ac, a^2b, a^2bc, a^3c, a^2b, ab, \\
& \hspace{38pt}  b, a^2, a^3bc, a^3b, a^2, a^3bc, a^3, c, a^3, bc, a^2c, abc, c, a, a^3b, a
  \end{align*}
 %
 %
  \item $[16,13]$, $\langle a,b,c \,|\, a^4 =b^2= c^2 = 1, ab=ba, ac = ca, cbc=a^2b\rangle$:
  %
    \begin{align*}
& S:= 1, 1, b, a^3c, a^2c, a, a^2, a^2, a, bc, a^3b, a^3b, bc, b, a^3c, a^3bc, a^3, a^3, \\
& \hspace{28pt} a^2b, c, ab, ac, abc, ab, ac, a^2bc, c, abc, a^2bc, a^2b, a^3bc, a^2c\\
 \\
& \pi(S) = 1, b, abc, a, a^3c, a^3, 1, a^3, abc, ac, a^2, a^3c, c, a^3bc, a^2b, a^2bc,  a^2,  \\
& \hspace{38pt} ab,  bc, a^3bc, bc, b, a^2c, a^2bc, a^3b, a^2b, ab, a, c, ac, a^3b, a^2c
  \end{align*}
\end{itemize}

\subsection*{Groups of order 18}
\begin{itemize}
 \item $[18,3]$, $S_3 \times \mathbb{Z}_3$:
 %
 \[ \text{H2-harmonious by Corollary \ref{cor:h2dih} and Lemma \ref{lemma:h2util}}\]
 %
 %
 \item $[18,4]$, $\langle a,b,c \,|\, a^3=b^3=c^2=1, ab=ba, ac = ca^{-1}, bc=cb^{-1} \rangle$:
  %
 \begin{center} 
 \text{H2-harmonious by Proposition \ref{prop:h2cyc} and Lemma \ref{lemma:h2util} }\\
  \text{as $\langle a,b\rangle  \triangleleft G$, $|\langle a,b\rangle|=9$, and $G/\langle a,b \rangle \cong \mathbb{Z}_2$}
  \end{center}
 %
 %
\end{itemize}



\subsection*{Groups of order 20}

\begin{itemize}
 \item $[20,3]$, $\langle a,b \,|\, a^5=b^4 = 1, bab^{-1} = a^2\rangle$:
 %
 \begin{center} 
 \text{H2-harmonious by Proposition \ref{prop:h2cyc} and Lemma \ref{lemma:h2util} }\\
  \text{as $\langle a\rangle  \triangleleft G$, $|\langle a\rangle|=5$, and $G/\langle a \rangle \cong \mathbb{Z}_4$}
  \end{center}
 %
 %
\end{itemize}
 
\subsection*{Groups of order 24}

\begin{itemize}
 \item $[24,1]$, $\langle a,b \,|\, a^8=b^3 = 1, aba^{-1} = b^{-1}\rangle$:
 %
 \begin{center} 
 \text{H2-harmonious by Proposition \ref{prop:h2cyc} and Lemma \ref{lemma:h2util} }\\
  \text{as $\langle b\rangle  \triangleleft G$, $|\langle b\rangle|=3$, and $G/\langle b \rangle \cong \mathbb{Z}_8$}
  \end{center}
 %
 %
 
\item $[24,3]$, the special linear group $SL_2(3)$:
%
\begin{align*}& S:= \,  \left(\begin{smallmatrix}
0 & 1 \\
2 & 0
\end{smallmatrix}\right), \left(\begin{smallmatrix}
0 & 1 \\
2 & 0
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 1 \\
0 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 2 \\
2 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 2 \\
0 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 1 \\
2 & 0
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 0 \\
1 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
0 & 1 \\
2 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 2 \\
2 & 1
\end{smallmatrix}\right),\left(\begin{smallmatrix}
1 & 2 \\
0 & 1
\end{smallmatrix}\right),  \left(\begin{smallmatrix}
2 & 2 \\
0 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 1 \\
1 & 2
\end{smallmatrix}\right), \\ 
&\hspace{28pt} \left(\begin{smallmatrix}
1 & 1 \\
0 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 0 \\
2 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 2 \\
1 & 0
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 2 \\
2 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 1 \\
2 & 0
\end{smallmatrix}\right), \left(\begin{smallmatrix}
0 & 2 \\
1 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 1 \\
1 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 2 \\
1 & 0
\end{smallmatrix}\right),  \left(\begin{smallmatrix}
2 & 0 \\
2 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 0 \\
2 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
0 & 1 \\
2 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 0 \\
1 & 2
\end{smallmatrix}\right),\\ 
&\hspace{28pt}  \left(\begin{smallmatrix}
2 & 0 \\
1 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
0 & 1 \\
2 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 1 \\
1 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 1 \\
2 & 0
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 1 \\
2 & 0
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 1 \\
1 & 1
\end{smallmatrix}\right),   \left(\begin{smallmatrix}
1 & 0 \\
0 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 1 \\
0 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 2 \\
2 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 0 \\
0 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 0 \\
0 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 2 \\
0 & 2
\end{smallmatrix}\right),\\
&\hspace{28pt} \left(\begin{smallmatrix}
0 & 2 \\
1 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 0 \\
0 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
0 & 2 \\
1 & 0
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 2 \\
1 & 0
\end{smallmatrix}\right),  \left(\begin{smallmatrix}
1 & 2 \\
1 & 0
\end{smallmatrix}\right), \left(\begin{smallmatrix}
0 & 2 \\
1 & 0
\end{smallmatrix}\right),  \left(\begin{smallmatrix}
0 & 2 \\
1 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 0 \\
1 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 0 \\
2 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
0 & 2 \\
1 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
0 & 1 \\
2 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 1 \\
0 & 2
\end{smallmatrix}\right)\\
\\
&\pi(S) = \left(\begin{smallmatrix}
2 & 0 \\
0 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
0 & 2 \\
1 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 2 \\
1 & 0
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 1 \\
2 & 0
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 2 \\
2 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
0 & 1 \\
2 & 0
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 1 \\
1 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 1 \\
2 & 0
\end{smallmatrix}\right), \left(\begin{smallmatrix}
0 & 1 \\
2 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 0 \\
0 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 1 \\
2 & 0
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 2 \\
1 & 0
\end{smallmatrix}\right),\\
& \hspace{38pt}  \left(\begin{smallmatrix}
1 & 1 \\
2 & 0
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 2 \\
2 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
0 & 1 \\
2 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 2 \\
0 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 0 \\
1 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 2 \\
0 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 0 \\
2 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
0 & 1 \\
2 & 0
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 0 \\
2 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
0 & 2 \\
1 & 0
\end{smallmatrix}\right), \left(\begin{smallmatrix}
0 & 2 \\
1 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 0 \\
1 & 1
\end{smallmatrix}\right), \\
& \hspace{38pt}\left(\begin{smallmatrix}
1 & 2 \\
2 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 2 \\
0 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 0 \\
2 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
0 & 1 \\
2 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 2 \\
0 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 1 \\
1 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 1 \\
0 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
0 & 1 \\
2 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 1 \\
1 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 0 \\
0 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 1 \\
0 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 0 \\
2 & 2
\end{smallmatrix}\right), \\
& \hspace{38pt}\left(\begin{smallmatrix}
0 & 2 \\
1 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
0 & 2 \\
1 & 0
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 1 \\
0 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 1 \\
1 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 0 \\
1 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 1 \\
0 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
0 & 2 \\
1 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 0 \\
0 & 1
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 2 \\
2 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
1 & 2 \\
1 & 0
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 0 \\
1 & 2
\end{smallmatrix}\right), \left(\begin{smallmatrix}
2 & 2 \\
1 & 0
\end{smallmatrix}\right)
\end{align*}
%
%
\item $[24,5]$, $S_3 \times \mathbb{Z}_4 = S_3 \times \langle a \, |\, a^4=1\rangle$:
 \[ \text{H2-harmonious by Theorem \ref{thm:h22xk} as } \langle \left( (123), a\right) \rangle \text{ is a cyclic subgroup of index 2}\]
 %
 %
 \item $[24,7]$, $\langle a,b,c \,| \, a^6=c^2=1, a^3=b^2, b^{-1}ab = a^{-1}, ac=ca, bc=cb\rangle$:
 %
  \begin{center} 
  \text{H2-harmonious by Theorem \ref{thm:h2abel} and Lemma \ref{lemma:h2util} }\\
  \text{as $\langle a^2\rangle  \triangleleft G$, $|\langle a\rangle|=3$, and $G/\langle a \rangle \cong \mathbb{Z}_4 \times \mathbb{Z}_2$}
  \end{center}
% \begin{align*}
% & S:= \, 1, 1, abc, ab^2, a^2b, a^2, ab^2, abc, a^2b^3, ab^3c, a^2bc, b^3, a^2, a^2b^2, bc, ab, ab,  ac,\\
% & \hspace{28pt}  ab^2c, a^2b^3c, ac, a^2b^3, b^3c, b^2, a^2b^3c, ab^2c, ab^3c, a^2bc, a^2b^2, a^2c, a, c,   \\
%& \hspace{28pt} a^2c, a, ab^3, b^3c, b, b, a^2b^2c, a^2b^2c, b^2c, bc, c, ab^3, b^3, b^2c, b^2, a^2b\\
%\\
%&\pi(S) = \, 1, abc, a^2b^3c, b, ab^3, 1, b^3c, a^2b^2c, a^2c, a^2b^2, ab^2c, ab, a, a^2b^3c, ab^2c, b^2,  \\
%&\hspace{38pt} a^2bc, a^2b^2, ab, ab^3, ab^3c, a^2b^2c, bc, a^2bc, b^3, a^2b, a, b^3c, ac, b^2c, ac, a^2,  \\
%&\hspace{38pt} b^2c, a^2b^3, a^2c, c, b^2, abc, ab^2, a^2, b^3, b, ab^3c, ab^2, bc, c, a^2b^3, a^2b
%\end{align*}
%
%
\item $[24,8]$, $\langle a,b,c \,| \, a^3 = b^4 = c^2= 1, ac=ca, a^{-1}ba=ab, cbc = b^{-1}\rangle$:
 \begin{center} 
 \text{H2-harmonious by Corollary \ref{cor:h2dih} and Lemma \ref{lemma:h2util} }\\
  \text{as $\langle a\rangle  \triangleleft G$, $|\langle a\rangle|=3$, and $G/\langle a \rangle \cong D_4$}
  \end{center}
  %
  %
  \item $[24,10]$, $D_4 \times C_3 = D_4 \times \langle a \, | \, a^3=1 \rangle$:
   \begin{center} 
 \text{H2-harmonious by Corollary \ref{cor:h2dih} and Lemma \ref{lemma:h2util} }\\
  \text{as $\langle a\rangle  \triangleleft G$, $|\langle a\rangle|=3$, and $G/\langle a \rangle = D_4$}
  \end{center}
  %
  %
  \item $[24,11]$, $Q \times C_3 = \Dic_2 \times \langle a \, | \, a^3=1 \rangle$:
  \begin{center} 
 \text{H2-harmonious by Corollary \ref{cor:h2dih} and Lemma \ref{lemma:h2util} }\\
  \text{as $\langle a\rangle  \triangleleft G$, $|\langle a\rangle|=3$, and $G/\langle a \rangle \cong \Dic_2$ }
  \end{center}
  %
  %
  \item $[24,12]$, the symmetric group $S_4$:
  %
  \begin{align*}
  & S:= \, (), (), (1243), (243), (13), (132), (1342), (24), (134), (1342), (14)(23), (124), (24), \\
  & \hspace{28pt} (12)(34),  (134), (1423), (13), (13)(24), (14)(23), (243), (23), (123), (234), (234),\\
  & \hspace{28pt}   (1234), (143),(1423), (12), (1324), (1234), (34), (1432), (1432), (12)(34), \\
  & \hspace{28pt}  (13)(24), (132), (14), (1324), (123), (142), (1243), (34), (143)\\
  \\
  &\pi(S) = \, (), (1243), (1234), (1324), (23), (1423), (134), (1342), (1423), (1243), (132), (14), \\
  & \hspace{38pt} (1432), (143), (), (24), (124), (132), (1234), (23), (234), (24), (12)(34), (134), (34),\\
  & \hspace{38pt}  (12), (12)(34), (243), (1324), (12), (1342), (14)(23), (13)(24), (142), (123), (142),\\
  & \hspace{38pt} (13)(24), (13), (14)(23), (124), (1432), (243), (14), (234), (34), (123), (13), (143)
  \end{align*}
  %
  %
  \item $[24,13]$, $A_4 \times \mathbb{Z}_2$, $\langle a,b,c \,|\, a^3=b^2=(ab)^3 =c^2=1, ac=ca, bc=cb \rangle$:
  %
    \begin{align*}
  & S:= \, 1, 1, ac, abc, b, bc, a^2c, aba, bc, a^2b, aba^2, aba^2c, a^2bc, ac, a, abac, aba^2c,  ba^2c,  \\
  &\hspace{28pt} bab,a^2bc, a^2ba, ba^2, bac, a^2bac, abc, a^2, abac, a^2c, aba, c, c, bab, a^2b, \\
  & \hspace{28pt}   a^2ba, ba^2c, bac,   ba, aba^2, ab, b, babc, ab, a^2bac, babc, a^2, ba, ba^2, a\\
  \\
  &\pi(S) = \, 1, ac, aba, ac, c, ba^2, abc, ba^2c, a^2c, aba, c, ba^2, b, a^2c, aba^2c, a^2b, a^2, a^2bac, \\
  & \hspace{38pt} bc, ba^2c, a^2b, aba^2c, ab, ba, bc, bac, ba, bac, abac, 1, babc, aba^2, a^2, abac, \\
  & \hspace{38pt} a^2ba, a^2bc, bab, a, bab, abc, a^2bc, babc, ab, a^2bac, b, a^2ba, aba^2, a
  \end{align*}

  %
  %
  \item $[24,14]$, $S_3 \times \mathbb{Z}_2 \times \mathbb{Z}_2$, $\langle a,b \,|\, a^3 = b^2 =1, bab=a^{-1} \rangle \times \langle c,d \,|\, c^2=d^2=1, cd=dc \rangle$:
    \begin{center} 
  \text{H2-harmonious by Theorem \ref{thm:h2abel} and Lemma \ref{lemma:h2util} }\\
  \text{as $\langle a\rangle  \triangleleft G$, $|\langle a\rangle|=3$, and $G/\langle a \rangle \cong \mathbb{Z}_2^3$}
  \end{center}
%      \begin{align*}
%  & S:= \, 1, 1, acd, a^2bd, a^2c, a^2c, abcd, abcd, ab, cd, a^2b, c, a^2bc, b, a^2, a^2, c, abc,  \\
%  &\hspace{28pt} ad, ad, a^2bcd, a^2b, a^2d, bc, b, ac, ac, d, a^2bd, a^2bcd, a^2cd, ab, bd, \\
%  & \hspace{28pt}   a^2cd, d, a, abd, a^2d, a, acd, bc, bcd, abc, bd, cd, a^2bc, bcd, abd\\
%  \\
%  &\pi(S) = \,   1, acd, abc, bcd, a, bd, 1, cd, abcd, a^2bcd, a^2bc, a^2b, ac, ab, a, a^2c, ab,   \\
%  & \hspace{38pt} bcd, a^2, bc, cd, bd, abcd, c, abc, a^2, acd, a^2b, c, b, a^2bcd, ad, a^2bc,  \\
%  & \hspace{38pt}  a^2c, ad, a^2bd, b, d, a^2cd, abd, d, a^2d, a^2cd, bc, a^2bd, a^2d, ac, abd
%  \end{align*}
 \end{itemize}
 
 \subsection*{Groups of order 30}
 
 \begin{itemize}
 \item $[30,1]$, $D_5 \times C_3 = D_5 \times \langle a \,|\, a^3=1\rangle$:
 %
   \begin{center} 
 \text{H2-harmonious by Corollary \ref{cor:h2dih} and Lemma \ref{lemma:h2util} }\\
  \text{as $\langle a\rangle  \triangleleft G$, $|\langle a\rangle|=3$, and $G/\langle a \rangle = D_5$ }
  \end{center}
 %
 %
 \item $[30,2]$, $D_3 \times C_5 = D_3 \times \langle a \,|\, a^5=1 \rangle$:
 %
    \begin{center} 
 \text{H2-harmonious by Corollary \ref{cor:h2dih} and Lemma \ref{lemma:h2util} }\\
  \text{as $\langle a\rangle  \triangleleft G$, $|\langle a\rangle|=5$, and $G/\langle a \rangle = D_3$ }
  \end{center}
 %
 \end{itemize}
 
 \subsection*{The alternating group $A_5$}
 
 Rather than list out the corresponding permutations, which would occupy a significant amount of space, we provide a more concise description: the list of triples, corresponding to cells in $L_{A_5}$, obtained from running the commands:
 
 \begin{lstlisting}[language=Python,mathescape=true,escapeinside={(*}{*)}]]
 G = AlternatingGroup(5) 
 L = G.cayley_table().table() 
 Ham2Plex(L)
 \end{lstlisting}
 
 \vspace{-24pt}

{\footnotesize
 \begin{equation*}\begin{split}
& [(0, 0, 0), (0, 11, 11), (33, 11, 39), (33, 29, 49), (22, 29, 14), (22, 9, 55), (54, 9, 27), (54, 52, 44), \\
& (18, 52, 14), (18, 34, 49), (24, 34, 17), (24, 57, 11), (26, 57, 9), (26, 10, 25), (19, 10, 52), \\
& (19, 40, 22), (14, 40, 18), (14, 54, 35), (8, 54, 53), (8, 21, 16), (57, 21, 43), (57, 19, 48), \\
& (48, 19, 53), (48, 1, 24), (1, 1, 2), (1, 55, 56), (20, 55, 30), (20, 46, 54), (55, 46, 2), (55, 56, 19), \\
& (32, 56, 36), (32, 2, 56), (53, 2, 40), (53, 7, 20), (34, 7, 28), (34, 42, 0), (42, 42, 50), (42, 47, 4),\\
& (51, 47, 23), (51, 23, 34), (15, 23, 58),  (15, 31, 40), (13, 31, 44), (13, 28, 15), (2, 28, 29), \\
& (2, 26, 25), (37, 26, 17), (37, 6, 24), (7, 6, 3), (7, 30, 27),  (9, 30, 35), (9, 32, 28), (41, 32, 6),\\
& (41, 13, 26), (52, 13, 50), (52, 3, 43), (31, 3, 22), (31, 48, 15), (17, 48, 1), (17, 12, 4), (21, 12, 6),\\
& (21, 41, 16), (29, 41, 52), (29, 50, 37), (44, 50, 19), (44, 39, 26), (59, 39, 54), (59, 27, 45),\\
& (47, 27, 57), (47, 58, 3), (4, 58, 51), (4, 59, 55), (39, 59, 20), (39, 14, 36), (3, 14, 21), (3, 38, 45),\\
& (36, 38, 30), (36, 22, 41), (38, 22, 39), (38, 43, 8), (50, 43, 57), (50, 18, 29), (16, 18, 38),  \\
& (16, 45, 48), (10, 45, 42), (10, 8, 5), (12, 8, 38), (12, 37, 7), (25, 37, 31), (25, 44, 58),  \\
& (45, 44, 13), (45, 4, 21), (23, 4, 34),(23, 53, 12), (56, 53, 7), (56, 20, 10), (40, 20, 32), (40, 49, 37),\\
& (43, 49, 42), (43, 16, 59), (30, 16, 46), (30, 51, 8), (49, 51, 33), (49, 36, 31), (58, 36, 33), \\
& (58, 15, 59), (46, 15, 47), (46, 25, 51), (35, 25, 41), (35, 24, 23), (28, 24, 13), (28, 35, 46), \\
& (27, 35, 47), (27, 33, 10), (6, 33, 32), (6, 17, 12), (11, 17, 18), (11, 5, 1), (5, 5, 9), (5, 0, 5)]
 \end{split}\end{equation*}}
 
 This data is also available at 
 %
 \[\text{\url{https://sites.google.com/view/kevinhalasz/combinatorial-data}}\]
 
 
 
	
\end{appendices}
\end{document}


%Let $L$ be a latin square of sufficiently large order $n$. Fixing $\varepsilon_0 = 10^{-5}$, write $\left(A_{i,j}\right)_{i,j \in [3]}$ for the partition of $L$ into latin subarrays given by plugging $\varepsilon_0$ into Lemma \ref{lemma:LSpart}, so that each symbol appears at most $\left(1+\varepsilon_0\right)\frac{n}{9}$ in each $A_{i,j}$. For $\ell \in \left\{ \left\lfloor \frac{n}{3} \right\rfloor, \left\lceil \frac{n}{3} \right\rceil \right\}$, let $J_\ell$ be a subcubic graph with $\ell$ vertices and $(1-\varepsilon_0)n$ edges such that every edge is part of a Hamilton cycle. Fixing $i \in [k]$, let $\ell = |A_{i,i}|$ and $\delta = \varepsilon_0^2/2$. Because 
%%
%\[\frac{\left(1-\varepsilon_0^2/2\right)\ell^2}{(1+\varepsilon_0)n} \geq (1+\varepsilon_0) \frac{n}{9},\]
%%
%the graph $K_{\ell,\ell}(A_{i,i})$ is $\frac{(1-\delta)\ell^2}{e(J_\ell)}$-bounded and we apply Corollary \ref{cor:EGJ} to find a rainbow copy of $J_\ell$. As we did several times in Chapter \ref{ch:h2terrace}, we will ``tie'' these cycles together to form a Hamilton $(2,3)$-pseudoplex.

Let $P = \bigcup_{i=1}^3 Q_i$ be as imagined. For each $i \in [3]$, let $H_i \subseteq Q_i$ be a Hamilton cycle and consider $e_i,e_i'\in H_i$ with $e_i=r_ic_i$ and $e_i'=r_i'c_i' $ MAKE SURE THESE ARE FAR APART. Notice that
 %
\begin{equation} H_0:= \left(\left(\bigcup_{i=1}^3 H_i\right) \setminus \{e_1,e_2,e_2',e_3\}\right) \cup \{r_1c_2,r_2c_1,r_2'c_3,r_3c_2'\}\label{eq:23switch}\end{equation}
%
is a Hamilton cycle in $K_{n,n}(L)$. However, $H_0$ may not be a $(2,3)$-pseudoplex as, even though each color appears at most 3 times in $\bigcup_{i=1}^3 H_i$, we may lose the 3-boundedness property in adding the four new edges. Because every edge in each $Q_i$ appears in some Hamilton cycle, we will find a $(2,3)$-pseudoplex by choosing the edges $r_1c_2, r_2c_1, r_2'c_3,$ and $r_3c_2'$ described in \eqref{eq:23switch} in a good way.
%%
%\begin{enumerate} \renewcommand{\labelenumi}{(\alph{enumi})}
%\item edges $r_1c_2,r_2c_1 \in E(Q_1,Q_2)$ such that $\chi(r_1c_2) \neq \chi(r_2c_1)$ and $Q_1$ contains a Hamilton cycle avoiding the colors $\chi(r_1c_2)$ and $\chi(r_2c_1)$
%\item edges $r_2'c_3,r_3c_2' \in E(Q_2,Q_3)$ such that $\chi(r_2'c_3) \neq \chi(r_3c_2')$ and $Q_3$ contains a Hamilton cycle avoiding the colors $\chi(r_2'c_3)$ and $\chi(r_3c_2')$.
%\end{enumerate}
%%

Maybe say two \gls{rainbow} paths and one rainbow cycle together is 3--bounded.

Given $r_i,c_i \in Q_i$ and $r_i,c_j \in Q_j$, we refer to a 4-cycle $r_i,c_i,r_j,c_j,r_i$ as an \defn{link}. Moreover, we refer to this link as \defn{good} if (a) $\chi(r_ic_j) \neq \chi(r_jc_i)$ and (b) there is a Hamilton cycle of $Q_i$ which contains $r_ic_i$ but avoids the colors $\chi(r_ic_j)$ and $\chi(r_jc_i)$. Any link which is not good we will refer to as \defn{bad}. We want to find two disjoint good links, one connecting $Q_1$ to $Q_2$ and the other connecting $Q_2$ to $Q_3$. Fixing $i \in \{1,3\}$, there are $\left((1-\varepsilon)n\right)^2=(1-\varepsilon_1)n^2$ links in total between $Q_i$ and $Q_2$. 

To determine how many of these links may be bad, notice that the number of edges in $Q_i$ must appear in every Hamilton cycle (of $Q_i$) is at most $\left(\frac{1}{3}+\varepsilon\right)n$. Each such edge has some color in $K_{n,n}(L)$, so there are at most $\left(\frac{1}{3}+\varepsilon\right)n$ colors which cannot appear in a good link; we call these \defn{bad colors}. Now, for any fixed color $s$, because $E(Q_i,Q_2)$ corresponds to $A_{i,2} \cup A_{2,i}$, 
%
\begin{equation}
E_s(Q_i,Q_2) \leq \left(\frac{2}{9}+2\varepsilon\right)n.
\label{eq:23bnd}\end{equation}
%
%there are at most $\left(\frac{2}{9}+2\varepsilon\right)n$ edges with color $s$ in $E(Q_i,Q_2)$.
 This gives at most $\left(\frac{2}{27} + \varepsilon_2\right)n^2$ edges in $E(Q_i,Q_2)$ which cannot be part of any good link. Moreover, for each edge $e \in Q_i$ which is not part of every Hamtilon cycle, there are five, or possibly 7, edges in $Q_i$ which must appear in every Hamilton cycle of $Q_i$ containing $e$. Thus, there are in total at most $\left(\frac{2}{27} + \varepsilon_2\right)n^2 + O(n)$ edges in $E(Q_i,Q_2)$ which cannot appear in any good link. 

Because each $Q_j$ is subcubic, every edge of $E(Q_i,Q_2)$ appears in at most 9 links. Thus, the number of links violate condition (b) in the definition of a good link is at most $\left(\frac{2}{3} + \varepsilon_3\right)n^2 + O(n)$. To bound the total number of bad links, we must also consider those links which violate condition (a) and have not already been counted. This means we need to count the number of links in which the color $s := \chi(r_ic_j) = \chi(r_jc_i)$ was not already considered above. There are at most $\frac{2}{3}n$ such colors and, by \eqref{eq:23bnd}, there are a total of at most $\left(\frac{4}{27}+\varepsilon_4\right)n^2$ edges in $E(Q_i,Q_2)$ with one of these colors. Because the edge-coloring of $K_{n,n}(L)$ is proper, each of these edges can be involved in at most 3 links satisfying $\chi(r_ic_j) = \chi(r_jc_i)$. Moreover, if we multiply $E_B(Q_i,Q_2)$ by 3 we will be double counting each bad link. Therefore, there are at most $\left(\frac{2}{9} + \varepsilon_5\right)n^2$ link which are bad because they violate condition (a) of the definition good links. 

Thus, there are at least $\left(\frac{1}{9} - \varepsilon_6\right)n^2$ good links between $Q_2$ and $Q_i$ for each $i \in \{1,3\}$. Because we are allowing $n$ to be sufficiently large, we may choose a good link between $Q_1$ and $Q_2$ and a good link between $Q_2$ and $Q_3$ in such a way that the $Q_2$-edges in each link have distance at least $4$ from each other, thereby ensuring that the links to do not interfere with one another. 

